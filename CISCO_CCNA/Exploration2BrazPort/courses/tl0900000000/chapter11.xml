<chapter type="" id="tl0911000000">
<title><content-text>OSPF</content-text></title>
<section type="ChapterIntroduction" id="tl0911000000">
<title><content-text>Introdução do capítulo</content-text></title>
<topic type="" id="tl0911000100">
<title><content-text>Introdução do capítulo</content-text></title>
<page type="OneColumn" id="tl0911000101">
<content-media type="StaticGraphic" id="cm3978973762"><title><content-text></content-text></title><media ref="tl0911000000/tl0911000000/tl0911000100/tl0911000101/cm3978973762.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911000000/tl0911000100/tl0911000101/cm3978973762text.xml"/></content-media>
<content-text><p>O protocolo OSPF é um protocolo de roteamento link-state que foi desenvolvido como uma substituição para o protocolo de roteamento do vetor de distância RIP. O RIP foi um protocolo de roteamento aceitável no início da Internet, mas sua confiabilidade em contagem de saltos como a única medida para escolher a melhor rota rapidamente tornou-se inaceitável em redes maiores que necessitavam de uma solução de roteamento mais robusta. O OSPF é um protocolo de roteamento classless que usa o conceito de <i>áreas </i>para escalabilidade. O RFC 2328 define a métrica de OSPF como um valor arbitrário chamado <i>custo</i>. O IOS Cisco utiliza a largura de banda como métrica de custo do OSPF. </p> <p>As principais vantagens do OSPF sobre o RIP são sua rápida convergência e escalabilidade para implementações de rede muito maiores. Neste capítulo final do curso de <i>Protocolos e conceitos de roteamento</i>, você aprenderá implementações e configurações OSPF básicas e de área única. As configurações e os conceitos OSPF mais complexos estão reservados para os cursos de nível CCNP.</p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0911010000">
<title><content-text>Introdução ao OSPF</content-text></title>
<topic type="" id="tl0911010100">
<title><content-text>Histórico do OSPF</content-text></title>
<page type="OneColumn" id="tl0911010101">
<content-media type="InteractiveGraphicRollovers" id="cm2888565200"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010100/tl0911010101/cm2888565200.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010100/tl0911010101/cm2888565200text.xml"/></content-media>
<content-text><p>O desenvolvimento inicial do OSPF começou em 1987 pelo Grupo de Trabalho do OSPF da Internet Engineering Task Force (IETF). Naquele tempo, a Internet era predominantemente uma rede acadêmica e de pesquisa fundada pelo governo norte-americano. </p> <p><b>Passe o mouse sobre as etiquetas da figura Cronologia do Desenvolvimento do OSPF para ver os eventos relacionados. </b></p> <p>Em 1989, a especificação para o OSPFv1 foi publicada na RFC 1131. Havia duas implementações escritas: uma para executar em roteadores e outra para executar em estações de trabalho UNIX. A última implementação tornou-se mais tarde um processo UNIX difundido conhecido como GATED. O OSPFv1 foi um protocolo de roteamento experimental e nunca foi implantado.</p> <p>Em 1991, o OSPFv2 foi introduzido na RFC 1247 por John Moy. O OSPFv2 ofereceu melhorias técnicas significativas sobre o OSPFv1. Ao mesmo tempo, a ISO trabalhava em um protocolo de roteamento link-state próprio chamado Intermediate System-to-Intermediate System (IS-IS). Conforme o esperado, a IETF escolheu o OSPF como seu IGP recomendado (Protocolo IGP). </p> <p>Em 1998, a especificação de OSPFv2 foi atualizada na RFC 2328 e é a RFC atual para OSPF. </p> <p><b>Nota: </b>Em 1999, OSPFv3 para IPv6 foi publicado na RFC 2740. O RFC 2740 foi escrito por John Moy, Rob Coltun e Dennis Ferguson. OSPFv3 é discutido no CCNP.</p> <p><b>Links</b></p> <p>"OSPF Versão 2", <content-link target="http://www.ietf.org/rfc/rfc2328.txt" type="external">http://www.ietf.org/rfc/rfc2328.txt</content-link></p></content-text>
</page>
</topic>
<topic type="" id="tl0911010200">
<title><content-text>Encapsulamento de mensagens OSPF</content-text></title>
<page type="OneColumn" id="tl0911010201">
<content-media type="InteractiveGraphicRollovers" id="cm3255376418"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010200/tl0911010201/cm3255376418.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010200/tl0911010201/cm3255376418text.xml"/></content-media>
<content-text><p>Os dados de uma mensagem OSPF são encapsulados em um pacote. Este campo de dados pode incluir um dos cinco tipos de pacote OSPF. No próximo tópico, cada tipo de pacote é discutido brevemente.</p> <p><b>Passe o mouse sobre os campos na figura Mensagem OSPF encapsulada para ver o processo de encapsulamento. </b></p> <p>O cabeçalho do pacote OSPF é incluído com todos os pacotes OSPF, independentemente de seu tipo. Os dados específicos do cabeçalho e do tipo do pacote OSPF são então encapsulados em um pacote IP. No cabeçalho de pacote IP, o campo de protocolo é definido como 89 para indicar OSPF e o endereço de destino é definido como um dos dois endereços multicast: 224.0.0.5 ou 224.0.0.6. Se o pacote OSPF for encapsulado em um quadro ethernet, o endereço MAC de destino também será um endereço multicast: 01-00-5E-00-00-05 ou 01-00-5E-00-00-06.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911010300">
<title><content-text>Tipos de pacote OSPF</content-text></title>
<page type="OneColumn" id="tl0911010301">
<content-media type="StaticGraphic" id="cm2901875363"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010300/tl0911010301/cm2901875363.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010300/tl0911010301/cm2901875363text.xml"/></content-media>
<content-text><p>No capítulo anterior, nós apresentamos os Pacotes Link-State (LSPs). A figura mostra os cinco diferentes tipos de pacotes link-state OSPF. Cada pacote serve a um propósito específico no processo de roteamento OSPF:</p> <p>1. <b>Hello</b> - Os pacotes Hello são utilizados para estabelecer e manter a adjacência com outros roteadores OSPF. O protocolo hello é discutido detalhadamente no próximo tópico. </p> <p>2. <b>DBD</b> - O pacote de <content-link target="cg9049355325" type="glossary">Descrição de Bancos de Dados (DBD)</content-link> contém uma lista abreviada do banco de dados link-state do roteador que o está enviando, os roteadores que o recebem comparam com o banco de dados link-state local. </p> <p>3. <b>LSR</b> - Os roteadores que recebem podem solicitar mais informações sobre qualquer entrada no DBD enviando uma <content-link target="cg7438722925" type="glossary">Requisição Link-State</content-link> (LSR). </p> <p>4. <b>LSU</b> - Os pacotes de <content-link target="cg1133628043" type="glossary">Atualização Link-State (LSU)</content-link> são utilizados para responder às LSRs, bem como anunciar novas informações. Os LSUs contêm sete tipos diferentes de Anúncios Link-State (LSAs). Os LSUs e os LSAs são brevemente discutidos em um tópico posterior.</p> <p>5. <b>LSAck</b> - Quando um LSU é recebido, o roteador envia um <content-link target="cg8742800150" type="glossary">Link-State Acknowledgement (LSAck)</content-link> para confirmar o recebimento do LSU.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911010400">
<title><content-text>Protocolo Hello</content-text></title>
<page type="OneColumn" id="tl0911010401">
<content-media type="AnimationPartialScreen" id="cm9806564439"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010400/tl0911010401/cm9806564439.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010400/tl0911010401/cm9806564439text.xml"/></content-media>
<content-text><p>A figura mostra o cabeçalho do pacote OSPF e o pacote Hello. Os campos em azul serão discutidos em mais detalhes posteriormente no capítulo. Por enquanto, vamos nos concentrar nos usos do pacote Hello. </p> <p>O pacote OSPF Tipo 1 é o pacote Hello de OSPF. Os pacotes Hello são utilizados para:</p> <p><ul><li> Detectar os vizinhos de OSPF e estabelecer as adjacências do vizinho.</li><li> Anunciar parâmetros nos quais dois roteadores devem concordar em se tornar vizinhos.</li><li> Eleger o <content-link target="cg9839475267" type="glossary">Roteador designado (DR)</content-link> e o <content-link target="cg4534692650" type="glossary">Roteador designado de backup (BDR)</content-link> em redes multiacesso como a Ethernet e Frame Relay.</li></ul></p> <p>Os campos importantes mostrados na figura incluem:</p> <p><ul><li><b>Tipo: </b>Tipo de pacote OSPF: Hello (1), DD (2), LS Request (3), LS Update (4), LS ACK (5)</li><li><b>ID do roteador:</b> ID do roteador de origem</li><li><b>ID da área: </b>área a partir da qual o pacote foi originado </li><li><b>Máscara de rede: </b>Máscara de sub-rede associada com a interface de envio</li><li><b>Intervalo de Hello:</b> número de segundos entre os hellos do roteador de envio</li><li><b>Prioridade do roteador: </b>Utilizado na eleição DR/BDR (discutida posteriormente)</li><li><b>Roteador Designado (DR):</b> ID do roteador do DR, se houver</li><li><b>Roteador designado de dackup (BDR) </b>ID do roteador do BDR, se houver</li><li><b>Lista de vizinhos:</b> lista o OSPF ID do(s) roteador(es) vizinho(s)</li></ul></p></content-text>
</page>
<page type="OneColumn" id="tl0911010402">
<content-media type="StaticGraphic" id="cm2206684110"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010400/tl0911010402/cm2206684110.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010400/tl0911010402/cm2206684110text.xml"/></content-media>
<content-text><p><b>Estabelecimento da vizinhança</b></p> <p>Antes de um roteador OSPF poder enviar seus link-states a outros roteadores, ele deverá determinar se existem outros vizinhos OSPF em algum de seus links. Na figura, os roteadores OSPF estão enviando pacotes Hello em todas as interfaces habilitadas por OSPF para determinar se existem vizinhos nesses links. As informações no OSPF Hello incluem a ID do roteador OSPF que envia o pacote Hello (a ID do roteador é discutida posteriormente no capítulo). Receber um pacote Hello de OSPF em uma interface confirma para um roteador que há outro roteador OSPF neste link. O OSPF estabelece então uma adjacência com o vizinho. Por exemplo, na figura, R1 estabelecerá adjacências com R2 e R3.</p> <p><b>Intervalos de Hello e de Dead de OSPF</b></p> <p>Antes de dois roteadores poderem formar uma adjacência de vizinho OSPF, eles deverão concordar em três valores: Intervalo de hello, intervalo de dead e tipo de rede. O intervalo de Hello de OSPF indica com que freqüência o roteador OSPF transmite seus pacotes Hello. Por padrão, os pacotes Hello de OSPF são enviados a cada 10 segundos em segmentos multiacesso e ponto-a-ponto e a cada 30 segundos em segmentos de <content-link target="cg9847456962" type="glossary">rede ponto-a-multiponto (NBMA)</content-link> (Frame Relay, X.25, ATM) (NBMA). </p> <p>Na maioria dos casos, os pacotes Hello de OSPF são enviados como multicast para um endereço reservado para <i><content-link target="cg4679715108" type="glossary">ALLSPFRouters</content-link></i> em 224.0.0.5. Utilizar um endereço multicast permite que um dispositivo ignore o pacote se sua interface não estiver habilitada para aceitar pacotes OSPF. Isto economiza o tempo de processamento da CPU em dispositivos não-OSPF.</p> <p>O intervalo de dead é o período, expresso em segundos, que o roteador esperará para receber um pacote Hello antes de declarar o vizinho "inativo." A Cisco utiliza um padrão de quatro vezes o intervalo de Hello. Para segmentos multiacesso e ponto-a-ponto, este período é de 40 segundos. Para redes NBMA, o intervalo de Dead é de 120 segundos. </p> <p>Se o intervalo de Dead expirar antes de os roteadores receberem um pacote Hello, o OSPF removerá aquele vizinho de seu banco de dados link-state. O roteador envia as informações link-state sobre o vizinho "inativo" para todas as interfaces OSPF habilitadas. </p> <p>Os tipos de rede são discutidos posteriormente no capítulo.</p> <p><b>Elegendo um DR e BDR</b></p> <p>Para reduzir a quantidade de tráfego OSPF nas redes multiacesso, o OSPF elege um Roteador Designado (DR) e um Roteador Designado de Backup (BDR). O DR é responsável por atualizar todos os outros roteadores OSPF (chamados de <content-link target="cg7298380285" type="glossary">DROthers</content-link>) quando uma alteração ocorrer na rede multiacesso. O BDR monitora o DR e assume como DR se o DR atual falhar. </p> <p>Na figura, R1, R2 e R3 são conectados através de links ponto-a-ponto. Portanto, não ocorre nenhuma eleição de DR/BDR. A eleição e os processos de DR/BDR serão discutidos em um tópico posterior e a topologia será alterada para uma rede multiacesso.</p> <p><b>Nota:</b> O pacote Hello é discutido em mais detalhes no CCNP juntamente com os outros tipos de pacotes OSPF. </p></content-text>
</page>
</topic>
<topic type="" id="tl0911010500">
<title><content-text>Atualizações de OSPF link-state</content-text></title>
<page type="OneColumn" id="tl0911010501">
<content-media type="StaticGraphic" id="cm3817145446"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010500/tl0911010501/cm3817145446.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010500/tl0911010501/cm3817145446text.xml"/></content-media>
<content-text><p>As atualizações do link-state (LSUs) são os pacotes utilizados para atualizações de roteamento OSPF. Um pacote LSU pode conter 11 tipos diferentes de Anúncios Link-State (LSAs), como mostrado na figura. A diferença entre os termos Atualização Link-State (LSU) e <content-link target="cg7038442778" type="glossary">Anúncio Link-State (LSA)</content-link> pode, às vezes, ser confusa. De vez em quando, estes termos são utilizados um no lugar do outro. Um LSU contém um ou mais LSAs e ambos os termos podem ser utilizados para referir-se a informações de link-state propagadas por roteadores OSPF.</p> <p><b>Nota: </b>Os diferentes tipos de LSAs são discutidos no CCNP.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911010600">
<title><content-text>Algoritmo OSPF</content-text></title>
<page type="OneColumn" id="tl0911010601">
<content-media type="StaticGraphic" id="cm1474132476"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010600/tl0911010601/cm1474132476.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010600/tl0911010601/cm1474132476text.xml"/></content-media>
<content-text><p>Cada roteador de OSPF mantém um banco de dados link-state contendo os LSAs recebidos de todos os outros roteadores. Quando um roteador recebe todos os LSAs e constrói seu banco de dados link-state local, o OSPF utiliza o algoritmo open shortest path first (SPF) de Dijkstra para criar uma árvore SPF. A árvore SPF é então utilizada para preencher a tabela de roteamento IP com os melhores caminhos para cada rede.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911010700">
<title><content-text>Distância administrativa</content-text></title>
<page type="OneColumn" id="tl0911010701">
<content-media type="StaticGraphic" id="cm3147192772"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010700/tl0911010701/cm3147192772.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010700/tl0911010701/cm3147192772text.xml"/></content-media>
<content-text><p>Como você aprendeu no Capítulo 3, "Introdução aos protocolos de roteamento dinâmico", a distância administrativa (AD) é a confiança (ou preferência) da origem da rota. O OSPF tem uma distância administrativa padrão de 110. Como você pode ver na figura, quando comparado a outros protocolos IGP, o OSPF é preferido em relação ao IS-IS e RIP. </p></content-text>
</page>
</topic>
<topic type="" id="tl0911010800">
<title><content-text>Autenticação</content-text></title>
<page type="OneColumn" id="tl0911010801">
<content-media type="StaticGraphic" id="cm2326913933"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010800/tl0911010801/cm2326913933.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010800/tl0911010801/cm2326913933text.xml"/></content-media>
<content-text><p>Como foi dito em capítulos anteriores, a configuração de protocolos de roteamento para utilizar autenticação será discutida em um curso posterior. Como outros protocolos de roteamento, o OSPF pode ser configurado para autenticação. </p> <p>É uma prática boa autenticar informações de roteamento transmitidas. RIPv2, EIGRP, OSPF, IS-IS e BGP podem ser configurados para criptografar e autenticar suas informações de roteamento. Esta prática assegura que os roteadores somente aceitem informações de roteamento de outros roteadores que foram configurados com as mesmas informações de senha ou autenticação. </p> <p><b>Nota:</b> a autenticação não criptografa a tabela de roteamento do roteador. </p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0911020000">
<title><content-text>Configuração OSPF básica</content-text></title>
<topic type="" id="tl0911020100">
<title><content-text>Topologia de laboratório</content-text></title>
<page type="OneColumn" id="tl0911020101">
<content-media type="InteractiveGraphicHotspots" id="cm6146016532"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020100/tl0911020101/cm6146016532.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020100/tl0911020101/cm6146016532text.xml"/></content-media>
<content-text><p>A figura mostra a topologia para este capítulo. Observe que o esquema de endereçamento não é contíguo. O OSPF é um protocolo de roteamento classless. Portanto, nós configuraremos a máscara como parte de nossa configuração OSPF. Como você sabe, fazer isto supera o problema do endereçamento não contíguo. Também observe nesta topologia que há três links seriais de várias larguras de banda e que cada roteador possui vários caminhos para cada rede remota.</p>  <p><b>Clique em Endereçamento para rever os endereços IP.</b></p> <p> </p> <p><b>Clique em R1, R2 e R3 para rever a configuração inicial de cada roteador.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl0911020200">
<title><content-text>O comando router ospf</content-text></title>
<page type="OneColumn" id="tl0911020201">
<content-media type="InteractiveGraphicHotspots" id="cm8087429524"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020200/tl0911020201/cm8087429524.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020200/tl0911020201/cm8087429524text.xml"/></content-media>
<content-text><p>O OSPF é habilitado com o comando de configuração global <span class="cmd"><b>router ospf</b><i> process-id</i></span>. O <span class="cmd"><i>process-id</i></span> é um número entre 1 e 65535 escolhido pelo administrador de rede. O <span class="cmd"><i>process-id</i></span> tem significado local, o que significa que ele não tem que corresponder a outros roteadores OSPF para estabelecer adjacências com esses vizinhos. Isto difere do EIGRP. A ID do processo EIGRP ou o número do sistema autônomo <i>precisa</i> ser correspondente para que dois vizinhos EIGRP tornem-se adjacentes.</p> <p>Em nossa topologia, nós habilitaremos OSPF em todos os três roteadores que utilizam a mesma ID do processo cujo valor será 1. Nós estamos utilizando a mesma ID do processo simplesmente para fins de consistência.</p> <span class="cmd"><p>R1(config)#<b>router ospf 1</b></p></span> <span class="cmd"><p>R1(config-router)#</p></span></content-text>
</page>
</topic>
<topic type="" id="tl0911020300">
<title><content-text>O comando network</content-text></title>
<page type="OneColumn" id="tl0911020301">
<content-media type="InteractiveGraphicHotspots" id="cm9291193915"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020300/tl0911020301/cm9291193915.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020300/tl0911020301/cm9291193915text.xml"/></content-media>
<content-text><p>O comando <span class="cmd"><b>network</b></span> utilizado com o OSPF tem a mesma função de quando utilizado com outros protocolos de roteamento IGP: </p> <p><ul><li> As interfaces em um roteador que corresponderem ao endereço de rede no comando <span class="cmd"><b>network</b></span> serão habilitadas para enviar e receber pacotes OSPF.</li><li> Esta rede (ou sub-rede) será incluída nas atualizações de roteamento OSPF.</li></ul></p> <p>O comando <span class="cmd"><b>network</b></span> é utilizado no modo de configuração de roteamento.</p> <p><span class="cmd">Router(config-router)<b>#network </b><i>network-address wildcard-mask</i><b> area </b><i>area-id</i></span></p> <p>O comando <span class="cmd"><b>network</b></span> de OSPF utiliza uma combinação de <i>endereço-de-rede</i> e <i>máscara-curinga </i>semelhante àquele que pode ser utilizado por EIGRP. Porém, ao contrário do EIGRP, o OSPF exige a máscara curinga. O endereço de rede, juntamente com a máscara curinga, é utilizado para especificar a interface ou intervalo de interfaces que serão habilitadas para OSPF utilizando este comando <span class="cmd"><b>network</b></span>. </p> <p>Como com o EIGRP, a máscara curinga pode ser configurada como o inverso de uma máscara de sub-rede. Por exemplo, a interface FastEthernet 0/0 de R1 está na rede 172.16.1.16/28. A máscara de sub-rede para esta interface é /28 ou 255.255.255.240. O inverso da máscara de sub-rede resulta na máscara curinga.</p> <p><b>Nota:</b> assim como o EIGRP, algumas versões do IOS permitem que você simplesmente informe a máscara de sub-rede em vez da máscara curinga. O IOS converte então a máscara de sub-rede para o formato de máscara curinga.</p> <p><span class="cmd"> 255.255.255.255</span> </p> <p><span class="cmd">- 255.255.255.240 Subtraia a máscara de sub-rede</span></p> <p><span class="cmd"> --------------------</span></p> <p><span class="cmd"> 0. 0. 0. 15 Wildcard mask</span></p> <p>A <span class="cmd"><b>área </b><i>area-id</i></span> refere-se à <content-link target="cg9789079661" type="glossary">área OSPF</content-link>. Uma área OSPF é um grupo de roteadores que compartilham informações link-state. Todos os roteadores OSPF na mesma área devem ter as mesmas informações link-state em seus bancos de dados link-state. Isto é realizado por roteadores que enviam seus link-states individuais a todos os outros roteadores na área. Neste capítulo, nós configuraremos todos os roteadores OSPF dentro de uma única área. Isto é conhecido como OSPF de única área. </p> <p>Uma rede OSPF também pode ser configurada como áreas múltiplas. Há várias vantagens de se configurar grandes redes OSPF como áreas múltiplas, inclusive bancos de dados link-state menores e a capacidade de isolar problemas de rede instáveis dentro de uma área. O OSPF multiárea abordado no CCNP.</p> <p>Quando todos os roteadores estiverem dentro da mesma área OSPF, os comandos de rede devem ser configurados com o mesmo <span class="cmd"><i>area-id</i></span> em todos os roteadores. Embora qualquer <span class="cmd"><i>area-id </i></span>possa ser utilizada, é recomendado utilizar um <span class="cmd"><i>area-id</i></span> de 0 com o OSPF de única área. Esta convenção facilitará o processo no caso de a rede ser posteriormente configurada como OSPF com múltiplas áreas, onde a área 0 torna-se a área de backbone.</p> <p>A figura mostra os comandos <span class="cmd"><b>network</b></span> para todos os três roteadores, habilitando o OSPF em todas as interfaces. Neste ponto, todos os roteadores devem poder executar ping em todas as redes.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911020400">
<title><content-text>ID do roteador OSPF</content-text></title>
<page type="OneColumn" id="tl0911020401">
<content-media type="InteractiveGraphicHotspots" id="cm6009600019"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020400/tl0911020401/cm6009600019.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020400/tl0911020401/cm6009600019text.xml"/></content-media>
<content-text><p><b>Determinando a ID do roteador</b></p> <p>A ID do roteador OSPF é utilizada para identificar unicamente cada roteador no domínio de roteamento OSPF. Uma ID de roteador é simplesmente um endereço IP. Os roteadores Cisco produzem a ID do roteador com base em três critérios e com a seguinte precedência:</p> <p>1. Utilize o endereço IP configurado com o comando <span class="cmd"><b>router-id</b></span> de OSPF.</p> <p>2. Se o <span class="cmd"><b>router-id</b></span> não estiver configurado, o roteador escolherá o endereço IP mais alto de qualquer uma de suas interfaces de loopback.</p> <p>3. Se nenhuma interface de loopback estiver configurada, o roteador escolherá o endereço IP ativo mais alto de suas interfaces físicas.</p> <p><b>Endereço IP Ativo mais alto</b></p> <p>Se um roteador OSPF não estiver configurado com um comando <span class="cmd"><b>router-id</b></span> de OSPF e não houver interfaces de loopback configuradas, a ID do roteador OSPF será o endereço IP ativo mais alto em qualquer uma de suas interfaces. A interface não precisa estar habilitada para OSPF, o que significa que ela não precisa ser incluída em um dos comandos <span class="cmd"><b>network</b></span> de OSPF. Porém, a interface deve estar ativa – ela deve estar no estado <b>up</b>.</p> <p><b>Clique no botão Topologia na figura. </b></p> <p>Utilizando os critérios descritos acima, você pode determinar as IDs do roteador para R1, R2 e R3? A resposta está na próxima página.</p></content-text>
</page>
<page type="OneColumn" id="tl0911020402">
<content-media type="InteractiveGraphicHotspots" id="cm3033580061"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020400/tl0911020402/cm3033580061.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020400/tl0911020402/cm3033580061text.xml"/></content-media>
<content-text><p><b>Verificando a ID do roteador</b></p> <p>Por não termos configurado as IDs do roteador ou interfaces de loopback em nossos três roteadores, a ID de roteador para cada roteador é determinada pelo critério número três na lista: o endereço IP ativo mais alto em quaisquer das interfaces físicas do roteador. Como mostrado na figura, a ID de roteador para cada roteador é:</p> <p><b>R1:</b> 192.168.10.5, que é mais alto que 172.16.1.17 ou 192.168.10.1</p> <p><b>R2:</b> 192.168.10.9, que é mais alto que 10.10.10.1 ou 192.168.10.2</p> <p><b>R3:</b> 192.168.10.10, que é mais alto que 172.16.1.33 ou 192.168.10.6</p> <p>Você pode utilizar o comando <span class="cmd"><b>show ip protocols</b></span> para verificar a ID de roteador atual. Algumas versões do IOS não exibem a ID do roteador como mostrado na figura. Nesses casos, utilize os comandos <span class="cmd"><b>show ip ospf</b></span> ou <span class="cmd"><b>show ip ospf interface</b></span> para verificar a ID do roteador.</p></content-text>
</page>
<page type="OneColumn" id="tl0911020403">
<content-media type="InteractiveGraphicHotspots" id="cm3731522329"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020400/tl0911020403/cm3731522329.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020400/tl0911020403/cm3731522329text.xml"/></content-media>
<content-text><p><b>Endereço de loopback</b></p> <p>Se o comando <span class="cmd"><b>router-id</b></span> de OSPF não for utilizado e as interfaces de loopback estiverem configuradas, o OSPF escolherá o endereço IP mais alto de qualquer uma de suas interfaces de loopback. Um endereço de loopback é uma interface virtual e está automaticamente no estado <b>up</b> quando configurado. Você já sabe os comandos para configurar uma interface de loopback:</p> <span class="cmd"><p>Router(config)#<b>interface </b><i>loopback number</i></p></span> <span class="cmd"><p>Router(config-if)#<b>ip address </b><i>ip-address subnet-mask</i></p></span> <p><b>Clique no botão Topologia na figura.</b></p> <p>Nesta topologia, todos os três roteadores foram configurados com endereços de loopback para representar as IDs do roteador OSPF. A vantagem de utilizar uma interface de loopback é que – diferente das interfaces físicas – ela não pode falhar. Não há nenhum cabo ou dispositivo adjacente real dos quais a interface de loopback dependa para estar no estado <b>up</b>. Portanto, utilizar um endereço de loopback para a ID do roteador fornece estabilidade ao processo OSPF. Como o comando <span class="cmd"><b>router-id</b></span> de OSPF, que será discutido a seguir, é um acréscimo relativamente recente ao IOS, é mais comum encontrar endereços de loopback utilizados para configurar IDs de roteador OSPF.</p> <p><b>O comando </b><span class="cmd"><b>router-id</b></span><b>de OSPF</b></p> <p>O comando <span class="cmd"><b>router-id</b></span> de OSPF foi introduzido no IOS 12.0 (T) e tem prioridade sobre os endereços IP de interface de loopback e física para determinar a ID do roteador. A sintaxe do comando é:</p> <span class="cmd"><p>Router(config)#<b>router ospf </b><i>process-id</i></p></span> <span class="cmd"><p>Router(config-router)#<b>router-id </b><i>ip-address</i></p></span>  <p><b>Modificando a ID do roteador</b></p> <p>A ID do roteador é selecionada quando o OSPF é configurado com seu primeiro comando <span class="cmd"><b>network</b></span> de OSPF. Se o comando <span class="cmd"><b>router-id</b></span> de OSPF ou o endereço de loopback for configurado <i>depois</i> do comando <span class="cmd"><b>network</b></span> do OSPF, a ID do roteador será derivada da interface com o endereço IP ativo mais alto.</p> <p>A ID do roteador pode ser modificada com o endereço IP de um comando <span class="cmd"><b>router-id</b></span> de OSPF subseqüente carregando o roteador ou utilizando o seguinte comando:</p> <p><span class="cmd">Router#<b>clear ip ospf process</b></span></p> <p><b>Nota:</b> modificar uma ID de roteador com um novo endereço IP de interface de loopback ou física pode exigir o recarregamento do roteador.</p> <p><b>IDs de roteador duplicadas</b></p> <p>Quando dois roteadores tiverem a mesma ID de roteador em um domínio OSPF, o roteamento poderá não funcionar corretamente. Se a ID do roteador for a mesma em dois roteadores vizinhos, o estabelecimento da vizinhança pode não ocorrer. Quando ocorrerem IDs de roteador OSPF duplicadas, o IOS exibirá uma mensagem semelhante a:</p> <p><span class="cmd">%OSPF-4-DUP_RTRID1: Detected router with duplicate router ID</span></p> <p>Para corrigir este problema, configure todos os roteadores de forma que eles tenham IDs de roteador OSPF exclusivas.</p> <p><b>Clique em Novas IDs de roteador na figura.</b></p> <p>Como algumas versões do IOS não suportam o comando <span class="cmd"><b>router-id</b></span>, nós utilizaremos o método de endereço de loopback para atribuir IDs de roteador. Um endereço IP de uma interface de loopback normalmente substituirá uma ID de roteador OSPF atual somente recarregando o roteador. Na figura, os roteadores foram recarregados. O comando <span class="cmd"><b>show ip protocols</b></span> é utilizado para verificar que cada roteador está utilizando agora o endereço de loopback para a ID do roteador.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911020500">
<title><content-text>Verificando o OSPF</content-text></title>
<page type="OneColumn" id="tl0911020501">
<content-media type="InteractiveGraphicHotspots" id="cm3794948834"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020500/tl0911020501/cm3794948834.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020500/tl0911020501/cm3794948834text.xml"/></content-media>
<content-text><p>O comando <span class="cmd"><b>show ip ospf neighbor</b></span> pode ser utilizado para verificar, identificar e solucionar problemas de relações de vizinhos OSPF. Para cada vizinho, este comando exibe a seguinte saída de comando:</p> <p><ul><li> <span class="cmd"><b>Neighbor ID</b></span> - A ID do roteador vizinho.</li><li> <span class="cmd"><b>Pri</b></span> - A prioridade OSPF da interface. Isto é discutido em uma seção posterior.</li><li> <span class="cmd"><b>State</b></span> - O estado OSPF da interface. O estado <span class="cmd"><b>FULL</b></span> significa que o roteador e seu vizinho têm bancos de dados link-state OSPF idênticos. Os estados OSPF são discutidos no CCNP.</li><li> <span class="cmd"><b>Dead Time</b></span> - A quantidade de tempo restante que o roteador esperará para receber um pacote Hello de OSPF do vizinho antes de declarar o vizinho inativo. Este valor é redefinido quando a interface recebe um pacote Hello.</li><li> <span class="cmd"><b>Address</b></span> - O endereço IP da interface do vizinho ao qual este roteador está diretamente conectado.</li><li> <span class="cmd"><b>Interface</b></span> - A interface na qual este roteador formou adjacência com o vizinho.</li></ul></p> <p>Ao identificar e solucionar problemas de redes OSPF, o comando do vizinho <span class="cmd"><b>show ip ospf</b></span> pode ser utilizado para verificar que o roteador formou uma adjacência com seus roteadores vizinhos. Se a ID de roteador do roteador vizinho não for exibida, ou se não se mostrar como um estado de <b>FULL</b>, isso significará que os dois roteadores não formaram uma adjacência de OSPF. Se dois roteadores não estabelecerem adjacência, as informações link-state não serão trocadas. Bancos de dados link-state incompletos podem causar árvores SPF e tabelas de roteamento inexatas. As rotas para as redes de destino podem não existir ou podem não ser o melhor caminho.</p> <p><b>Nota:</b> Em redes multiacesso como Ethernet, dois roteadores adjacentes podem ter seus estados exibidos como 2WAY. Isto será discutido em uma seção posterior.</p> <p>Dois roteadores podem não formar uma adjacência de OSPF se:</p> <p><ul><li> As máscaras de sub-rede não corresponderem, fazendo os roteadores estarem em redes separadas.</li><li> Os Temporizadores de Hello ou de Dead do OSPF não correspondem.</li><li> Os tipos de rede OSPF não correspondem.</li><li> Há um comando <span class="cmd"><b>network</b></span> de OSPF faltando ou incorreto.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="tl0911020502">
<content-media type="InteractiveGraphicHotspots" id="cm8892863889"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020500/tl0911020502/cm8892863889.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020500/tl0911020502/cm8892863889text.xml"/></content-media>
<content-text><p>Outros comandos eficientes de identificação e solução de problemas OSPF incluem:</p> <span class="cmd"><p><b>show ip protocols</b></p></span> <span class="cmd"><p><b>show ip ospf</b></p></span> <span class="cmd"><p><b>show ip ospf interface</b></p></span> <p>Como mostrado na figura, o comando <span class="cmd"><b>show ip protocols</b></span> é um modo rápido de verificar as informações vitais de configuração OSPF, inclusive a ID do processo OSPF, a ID do roteador, as redes que o roteador está anunciando, os vizinhos dos quais o roteador está recebendo atualizações e a distância administrativa padrão, que é 110 para OSPF.</p> <p><b>Clique em </b><span class="cmd"> <b>show ip ospf</b></span><b> na figura.</b></p> <p>O comando <span class="cmd"><b>show ip ospf</b></span> também pode ser utilizado para examinar a ID do processo OSPF e a ID do roteador. Além disso, este comando exibe as informações de área do OSPF, bem como a última vez que o algoritmo SPF foi calculado. Como você pode ver no exemplo, o OSPF é um protocolo de roteamento muito estável. O único evento relacionado ao OSPF no qual o R1 participou durante as últimas 11 horas e meia foi enviar pequenos pacotes Hello aos seus vizinhos. </p> <p><b>Nota: </b>informações adicionais exibidas pelo comando <span class="cmd"><b>show ip ospf</b></span> são discutidas em cursos de CCNP.</p> <p>A saída de comando inclui informações importantes do algoritmo SPF que incluem o <content-link target="cg1735291339" type="glossary">atraso de programação SPF</content-link>: </p> <span class="cmd"><p>Initial SPF schedule delay 5000 msecs</p></span> <span class="cmd"><p>Minimum hold time between two consecutive SPFs 10000 msecs</p></span> <span class="cmd"><p>Maximum wait time between two consecutive SPFs 10000 msecs</p></span> <p>Sempre que um roteador recebe novas informações sobre a topologia (adição, exclusão ou modificação de um link), o roteador deve executar novamente o algoritmo SPF, criar uma nova árvore SPF e atualizar a tabela de roteamento. O algoritmo SPF utiliza muito a CPU e o tempo necessário para o cálculo depende do tamanho da área. O tamanho de uma área é medido pelo número de roteadores e pelo tamanho do banco de dados link-state. </p> <p>Uma rede que fica entre um estado <b>up</b> e um estado <b>down</b> é chamada de <content-link target="cg4689628855" type="glossary">link flapping</content-link>. Um link flapping pode fazer com que roteadores OSPF em uma área recalculem constantemente o algoritmo SPF, impedindo a convergência adequada. Para minimizar este problema, o roteador espera 5 segundos (5000 milissegundos) depois de receber um LSU antes de executar o algoritmo SPF. Isto é conhecido como atraso de programação SPF. Para impedir que um roteador execute constantemente o algoritmo SPF, há um tempo de espera (Hold Time) adicional de 10 segundos (10000 milissegundos). O roteador espera 10 segundos depois de executar o algoritmo SPF antes de executar novamente o algoritmo. </p> <p><b>Clique em </b><span class="cmd"><b>show ip ospf interface </b></span><b>na figura.</b></p> <p>O modo mais rápido de verificar os intervalos de Hello e de Dead é utilizar o comando <span class="cmd"><b>show ip ospf interface</b></span>. Como mostrado na figura, adicionar o nome e número da interface ao comando exibe uma saída de comando para uma interface específica. Estes intervalos são incluídos nos pacotes Hello de OSPF enviados entre os vizinhos. O OSPF pode ter intervalos de Hello e de Dead diferentes em várias interfaces, mas para que os roteadores OSPF se tornem vizinhos, seus intervalos de Hello e de Dead do OSPF devem ser idênticos. Por exemplo, na figura, R1 está utilizando um intervalo de Hello de 10 e um intervalo de Dead de 40 na interface Serial 0/0/0. R2 também deverá utilizar os mesmos intervalos em sua interface Serial 0/0/0 ou os dois roteadores não formarão uma adjacência. </p></content-text>
</page>
</topic>
<topic type="" id="tl0911020600">
<title><content-text>Examinando a tabela de roteamento</content-text></title>
<page type="OneColumn" id="tl0911020601">
<content-media type="InteractiveGraphicHotspots" id="cm5981616568"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020600/tl0911020601/cm5981616568.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020600/tl0911020601/cm5981616568text.xml"/></content-media>
<content-text><p>Como você sabe, o modo mais rápido de verificar a convergência de OSPF é observar a tabela de roteamento para cada roteador na topologia. </p> <p><b>Clique em R1, R2 e R3 na figura para ver a saída de comando de </b><span class="cmd"><b>show ip route</b></span><b>.</b></p> <p>O comando <span class="cmd"><b>show ip route</b></span> pode ser utilizado para verificar que o OSPF está enviando e recebendo rotas via OSPF. O <b>O</b> no começo de cada rota indica que a origem da rota é o OSPF. A tabela de roteamento e o OSPF serão examinados mais atentamente na seção seguinte. Porém, você deve notar imediatamente duas diferenças distintas na tabela de roteamento OSPF comparada às tabelas de roteamento que você viu em capítulos anteriores. Primeiro, observe que cada roteador possui quatro redes diretamente conectadas porque a interface de loopback conta como a quarta rede. Estas interfaces de loopback não são anunciadas no OSPF. Portanto, cada roteador lista sete redes conhecidas. Em segundo lugar, ao contrário do RIPv2 e EIGRP, o OSPF não resume automaticamente as redes aos limites das rede principais. O OSPF é inerentemente classless.</p></content-text>
</page>
<page type="OneColumn" id="tl0911020602">
<content-media type="ActivityPKA" id="cm6077246877"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020600/tl0911020602/cm6077246877/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911020000/tl0911020600/tl0911020602/cm6077246877/icontext.xml"/></content-media>
<content-text><p>Utilize a Atividade do Packet Tracer para configurar e verificar o roteamento OSPF básico.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0911030000">
<title><content-text>A métrica do OSPF</content-text></title>
<topic type="" id="tl0911030100">
<title><content-text>Métrica do OSPF</content-text></title>
<page type="OneColumn" id="tl0911030101">
<content-media type="StaticGraphic" id="cm5361713613"><title><content-text></content-text></title><media ref="tl0911000000/tl0911030000/tl0911030100/tl0911030101/cm5361713613.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911030000/tl0911030100/tl0911030101/cm5361713613text.xml"/></content-media>
<content-text><p>A métrica do OSPF é chamada de custo. Da RFC 2328: <i>"Um custo está associado com o lado de saída de cada interface do roteador. Este custo é configurável pelo administrador do sistema. Quanto menor o custo, mais provável será o uso da interface para encaminhar o tráfego de dados."</i> </p> <p>Note que o RFC 2328 não especifica quais valores devem ser utilizados para determinar o custo.</p> <p><b>O Cisco IOS utiliza as larguras de banda cumulativas das interfaces de saída do roteador para a rede de destino como o valor de custo.</b> Em cada roteador, o custo para uma interface é calculado como 10 à 8a potência dividido pela largura de banda em bps. Isto é conhecido como <i>largura de banda de referência</i>. Divide-se 10 à 8a potência pela largura de banda da interface de modo que as interfaces com os valores de largura de banda mais altos tenham um menor custo calculado. Lembre-se de que, nas métricas de roteamento, a rota de custo mais baixo é a rota preferida (por exemplo, com RIP, 3 saltos é melhor que 10). A figura mostra os custos de OSPF padrão para vários tipos de interfaces. </p> <p><b>Largura de Banda de Referência</b></p> <p>A largura de banda de referência é padronizada em 10 à 8a potência, 100.000.000 bps ou 100 Mbps. Isto resulta em interfaces com uma largura de banda de 100 Mbps ou maiores tendo o mesmo custo de OSPF de 1. A largura de banda de referência pode ser modificada para acomodar redes com links mais rápidos que 100.000.000 bps (100 Mbps), usando o comando OSPF <span class="cmd"><b>auto-cost reference-bandwidth</b></span>. Quando este comando for necessário, recomenda-se que ele seja utilizado em todos os roteadores de modo que a métrica de roteamento OSPF permaneça consistente.</p></content-text>
</page>
<page type="OneColumn" id="tl0911030102">
<content-media type="StaticGraphic" id="cm9928226376"><title><content-text></content-text></title><media ref="tl0911000000/tl0911030000/tl0911030100/tl0911030102/cm9928226376.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911030000/tl0911030100/tl0911030102/cm9928226376text.xml"/></content-media>
<content-text><p><b>O OSPF acumula custos</b></p> <p>O custo de uma rota OSPF é o valor acumulado de um roteador para a rede de destino. Por exemplo, na figura, a tabela de roteamento em R1 mostra um custo de 65 para alcançar a rede 10.10.10.0/24 em R2. Uma vez que o 10.10.10.0/24 está conectado a uma interface FastEthernet, R2 atribui o valor 1 como o custo para 10.10.10.0/24. R1 adiciona então o valor de custo adicional de 64 para enviar dados pelo link T1 padrão entre R1 e R2.</p></content-text>
</page>
<page type="OneColumn" id="tl0911030103">
<content-media type="InteractiveGraphicHotspots" id="cm7063397266"><title><content-text></content-text></title><media ref="tl0911000000/tl0911030000/tl0911030100/tl0911030103/cm7063397266.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911030000/tl0911030100/tl0911030103/cm7063397266text.xml"/></content-media>
<content-text><p><b>Largura de banda padrão em Interfaces Seriais</b></p> <p>Você viu no Capítulo 9, "EIGRP", que você pode utilizar o comando <span class="cmd"><b>show interface</b></span> para exibir o valor de largura de banda utilizado por uma interface. Nos roteadores Cisco, o valor de largura de banda em muitas interfaces seriais padroniza-se em T1 (1.544 Mbps). Porém, algumas interfaces seriais podem padronizar-se a 128 kbps. Portanto, nunca suponha que o OSPF está utilizando um valor de largura de banda específico. Sempre verifique o valor padrão com o comando <span class="cmd"><b>show interface</b></span>.</p> <p>Lembre-se de que este valor de largura de banda não afeta realmente a velocidade do link; ele é utilizado por alguns protocolos de roteamento para computar a métrica do roteamento. Mais provavelmente, em interfaces seriais, a velocidade real do link é diferente da largura de banda padrão. É importante que o valor de largura de banda reflita a velocidade real do link de forma que a tabela de roteamento tenha informações precisas sobre o melhor caminho. Por exemplo, você pode estar pagando somente por uma conexão T1 fracionária de seu provedor de serviços, um quarto de uma conexão T1 inteira (384 kbps). Porém, para propósitos de protocolo de roteamento, o IOS assume um valor de largura de banda T1 muito embora a interface esteja enviando e recebendo de fato somente um quarto de uma conexão T1 inteira (384 kbps).</p> <p>A figura mostra a saída de comando para a interface Serial 0/0/0 em R1. A topologia também reflete agora a largura de banda real do link entre os roteadores. Observe que o valor de largura de banda padrão na saída de comando para R1 é de 1544 kbps. Entretanto, a largura de banda real deste link é de 64 kbps. Isto significa que o roteador possui informações de roteamento que não refletem precisamente a topologia de rede. </p> <p><b>Clique em </b><span class="cmd"><b>show ip route</b> </span> <b>na figura.</b></p> <p>A figura mostra a tabela de roteamento para R1. R1 acredita que ambas as suas interfaces seriais estão conectadas a links de T1, embora um dos links seja um link de 64 kbps e o outro seja um link de 256 kbps. Isto resulta na tabela de roteamento de R1 tendo dois caminhos de custos iguais à rede 192.168.8.0/30, quando o Serial 0/0/1 é, de fato, o melhor caminho. </p> <span class="cmd"><p>O 192.168.10.8 [110/<span class="blue">128</span>] por 192.168.10.6, 00:03:41, Serial0/0/1</p></span> <span class="cmd"><p> [110/<span class="blue">128</span>] por 192.168.10.2, 00:03:41, Serial0/0/0</p></span> <p><b>Clique em </b><span class="cmd"><b>show ip ospf interface </b></span><b>na figura.</b></p> <p>O custo de OSPF calculado de uma interface pode ser verificado com o comando <span class="cmd"><b>show ip ospf interface</b></span>. Na figura, nós podemos verificar que R1 está de fato atribuindo um custo de 64 à interface Serial 0/0/0. Embora você possa pensar que este é o custo correto porque esta interface está conectada a um link de 64 kbps, lembre-se de que este custo é derivado da fórmula de custo. O custo de um link de 64 kbps é de 1562 (100.000.000/64.000). O valor de 64 exibido corresponde ao custo de um link T1. No próximo tópico, você aprenderá a modificar o custo de todos os links na topologia. </p></content-text>
</page>
</topic>
<topic type="" id="tl0911030200">
<title><content-text>Modificando o custo do link</content-text></title>
<page type="OneColumn" id="tl0911030201">
<content-media type="InteractiveGraphicHotspots" id="cm8589941861"><title><content-text></content-text></title><media ref="tl0911000000/tl0911030000/tl0911030200/tl0911030201/cm8589941861.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911030000/tl0911030200/tl0911030201/cm8589941861text.xml"/></content-media>
<content-text><p>Quando a interface serial não estiver realmente operando à velocidade de T1 padrão, a interface exigirá uma modificação manual. Ambos os lados do link devem ser configurados para ter o mesmo valor. Ambos os comandos de interface <span class="cmd"><b>bandwidth</b></span> ou <span class="cmd"><b>ip ospf cost</b></span> alcançam este objetivo - um valor preciso para uso pelo OSPF na determinação da melhor rota.</p> <p><b>O</b> <b>comando</b> <span class="cmd"><b>bandwidth</b></span></p> <p>O comando <span class="cmd"><b>bandwidth</b></span> é utilizado para modificar o valor de largura de banda utilizado pelo IOS para calcular a métrica de custo do OSPF. A sintaxe de comando de interface é a mesma sintaxe que você aprendeu no Capítulo 9, "EIGRP":</p> <p><span class="cmd">Router(config-if)#<b>bandwidth </b><i>bandwidth-kbps</i></span></p> <p>A figura mostra os comandos <span class="cmd"><b>bandwidth</b></span> utilizados para modificar os custos de todas as interfaces seriais na topologia. Para R1, o comando <span class="cmd"><b>show ip ospf interface</b></span> mostra que o custo do link 0/0/0 Serial agora é de 1562, o resultado do cálculo do custo da implementação OSPF da Cisco 100.000.000/64.000. </p></content-text>
</page>
<page type="OneColumn" id="tl0911030202">
<content-media type="InteractiveGraphicHotspots" id="cm3580546285"><title><content-text></content-text></title><media ref="tl0911000000/tl0911030000/tl0911030200/tl0911030202/cm3580546285.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911030000/tl0911030200/tl0911030202/cm3580546285text.xml"/></content-media>
<content-text><p><b>O</b> <b>comando</b> <span class="cmd"><b>ip ospf cost</b></span></p> <p>Um método alternativo para utilizar o comando <span class="cmd"><b>bandwidth</b></span> é utilizar o comando <span class="cmd"><b>ip ospf cost</b></span>, que permite especificar diretamente o custo de uma interface. Por exemplo, em R1, nós podemos configurar a Serial 0/0/0 com o seguinte comando:</p> <span class="cmd"><p>R1(config)#<b>interface serial 0/0/0</b></p></span> <span class="cmd"><p>R1(config-if)#<b>ip ospf cost 1562</b></p></span> <p>Obviamente, isto não alteraria a saída de comando <span class="cmd"><b>show ip ospf interface</b></span>, que ainda mostra o custo como 1562. Este será o mesmo custo calculado pelo IOS quando nós configurarmos a largura de banda como 64.</p></content-text>
</page>
<page type="OneColumn" id="tl0911030203">
<content-media type="StaticGraphic" id="cm7313756366"><title><content-text></content-text></title><media ref="tl0911000000/tl0911030000/tl0911030200/tl0911030203/cm7313756366.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911030000/tl0911030200/tl0911030203/cm7313756366text.xml"/></content-media>
<content-text><p><b>O</b> <b>comando</b> <span class="cmd"> <b>bandwidth</b></span><b> vs o comando </b><span class="cmd"><b>ip ospf cost</b></span></p> <p>O comando <span class="cmd"><b>ip ospf cost</b></span> é útil em ambientes com vários fornecedores em que os roteadores que não são da Cisco utilizam uma métrica diferente da largura de banda para calcular os custos de OSPF. A principal diferença entre os dois comandos é que o comando <span class="cmd"><b>bandwidth</b></span> utiliza o resultado do cálculo de custo para determinar o custo do link. O comando <span class="cmd"><b>ip ospf cost</b></span> ignora este cálculo definindo diretamente o custo do link para um valor específico.</p> <p>A figura mostra as duas alternativas que podem ser utilizadas para modificar os custos dos links seriais na topologia. O lado direito da figura mostra o comando <span class="cmd"><b>ip ospf cost</b></span> equivalente aos comandos <span class="cmd"><b>bandwidth </b></span>à esquerda.</p></content-text>
</page>
<page type="OneColumn" id="tl0911030204">
<content-media type="ActivityPKA" id="cm9333594841"><title><content-text></content-text></title><media ref="tl0911000000/tl0911030000/tl0911030200/tl0911030204/cm9333594841/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911030000/tl0911030200/tl0911030204/cm9333594841/icontext.xml"/></content-media>
<content-text><p>Utilize a Atividade do Packet Tracer para modificar os valores de custo para o OSPF.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0911040000">
<title><content-text>OSPF e redes multiacesso</content-text></title>
<topic type="" id="tl0911040100">
<title><content-text>Desafios em redes multiacesso</content-text></title>
<page type="OneColumn" id="tl0911040101">
<content-media type="StaticGraphic" id="cm2892312364"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040100/tl0911040101/cm2892312364.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040100/tl0911040101/cm2892312364text.xml"/></content-media>
<content-text><p>Uma <content-link target="cg1420035058" type="glossary">rede multiacesso</content-link> é uma rede com mais de dois dispositivos compartilhando o mesmo meio. Na parte superior da figura, a rede local Ethernet anexada a R1 é estendida para mostrar possíveis dispositivos que podem ser anexados à rede 172.16.1.16/28. As redes locais Ethernet são um exemplo de uma rede multiacesso com broadcast. Elas são redes com broadcast porque todos os dispositivos na rede observam todos os quadros de broadcast. Elas são redes multiacesso porque pode haver nelas numerosos hosts, impressoras, roteadores e outros dispositivos que são todos membros da mesma rede. </p> <p>Por outro lado, em uma rede ponto-a-ponto existem somente dois dispositivos na rede, um em cada ponta. O link de WAN entre R1 e R3 é um exemplo de um link ponto-a-ponto. A parte inferior na figura mostra o link ponto-a-ponto entre R1 e R3.</p></content-text>
</page>
<page type="OneColumn" id="tl0911040102">
<content-media type="AnimationPartialScreen" id="cm1180392974"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040100/tl0911040102/cm1180392974.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040100/tl0911040102/cm1180392974text.xml"/></content-media>
<content-text><p>O OSPF define cinco tipos de rede:</p> <p><ul><li> Ponto-a-ponto </li><li> Multiacesso com broadcast </li><li> Rede sem broadcast multiacesso (NBMA) </li><li> Ponto-a-multiponto </li><li> Links virtuais</li></ul></p> <p>NBMA e redes ponto-a-multiponto incluem as redes Frame Relay, ATM  e X.25. As redes NBMA são discutidas em outro curso CCNA. As redes ponto-a-multiponto são discutidas no CCNP. Os links virtuais são um tipo especial de link que podem ser utilizados em OSPF multiárea. Os links virtuais OSPF são discutidos no CCNP.</p> <p><b>Clique em Reproduzir para exibir a animação.</b></p> <p>A animação mostra que a topologia utiliza as redes ponto-a-ponto e de broadcast.</p></content-text>
</page>
<page type="OneColumn" id="tl0911040103">
<content-media type="StaticGraphic" id="cm7281665597"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040100/tl0911040103/cm7281665597.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040100/tl0911040103/cm7281665597text.xml"/></content-media>
<content-text><p>Redes multiacesso podem criar dois desafios para o OSPF com relação ao envio de LSAs:</p> <p>1. Criação de múltiplas adjacências, uma adjacência para cada par de roteadores.</p> <p>2. Grande envio de LSAs (Link-State Advertisements, Anúncios Link-State).</p> <p><b>Adjacências múltiplas</b></p> <p>A criação de uma adjacência entre cada par de roteadores em uma rede pode criar um número desnecessário de adjacências. Isto conduziria a um número excessivo de LSAs transmitidos entre roteadores na mesma rede. </p> <p>Para entender o problema com adjacências múltiplas, precisamos estudar uma fórmula. Para qualquer número de roteadores (designado como <b>n</b>) em uma rede multiacesso, haverá <b>n (n - 1) / 2</b> adjacências. A figura mostra uma topologia simples de cinco roteadores, dos quais todos estão anexados à mesma rede Ethernet multiacesso. Sem algum tipo de mecanismo para reduzir o número de adjacências, estes roteadores formariam coletivamente 10 adjacências: <b>5 ( 5 - 1 ) / 2 = 10.</b> Pode não parecer muito, mas, conforme os roteadores são acrescentados à rede, o número de adjacências aumenta drasticamente. Embora os 5 roteadores na figura precisem somente de 10 adjacências, você pode observar que 10 roteadores exigiriam 45 adjacências. Vinte roteadores exigiriam 190 adjacências!</p></content-text>
</page>
<page type="OneColumn" id="tl0911040104">
<content-media type="AnimationPartialScreen" id="cm9356542215"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040100/tl0911040104/cm9356542215.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040100/tl0911040104/cm9356542215text.xml"/></content-media>
<content-text><p><b>Enviando LSAs</b></p> <p>Lembre-se, do Capítulo 10, "Protocolos de Roteamento Link-State", que os roteadores link-state enviam seus pacotes link-state quando o OSPF é inicializado ou quando há uma mudança na topologia.</p> <p><b>Clique em Reproduzir para ver a animação de um cenário de envio de LSA.</b></p> <p>Em uma rede multiacesso, este envio pode tornar-se excessivo. Na animação, R2 envia um LSA. Este evento faz que todos os outros roteadores também enviarem um LSA. Na animação não são mostradas as confirmações exigidas enviadas para cada LSA recebido. Se todo roteador em uma rede multiacesso tivesse que enviar e confirmar todos os LSAs recebidos a todos os outros roteadores nesta mesma rede multiacesso, o tráfego da rede ficaria bastante caótico.</p> <p>Para ilustrar este ponto, imagine que você está em uma sala com grande número de pessoas. E se todo o mundo tivesse que se apresentar individualmente aos outros? Cada pessoa não teria somente que dizer a todos o seu nome, mas sempre que uma pessoa soubesse o nome de outra pessoa, esta pessoa teria que dizê-lo também a todos os outros na sala, um de cada vez. Como você pode ver, este processo leva ao caos!</p></content-text>
</page>
<page type="OneColumn" id="tl0911040105">
<content-media type="AnimationPartialScreen" id="cm5069815851"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040100/tl0911040105/cm5069815851.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040100/tl0911040105/cm5069815851text.xml"/></content-media>
<content-text><p><b>Solução: Roteador designado</b></p> <p>A solução para gerenciar o número de adjacências e o envio de LSAs em uma rede multiacesso é o Roteador Designado (DR). Continuando nosso exemplo anterior, esta solução é análoga a eleger alguém na sala para passar e saber o nome de todo mundo e então anunciar estes nomes a todos na sala de uma só vez.</p> <p>Em redes multiacesso, o OSPF elege um Roteador Designado (DR) para ser o ponto de coleta e distribuição para os LSAs enviados e recebidos. Um Roteador Designado de Backup (BDR) também é eleito no caso de o Roteador Designado falhar. Todos os outros roteadores se tornam DROthers (isto indica um roteador que não é o DR nem o BDR).</p> <p><b>Clique em Reproduzir para ver a animação da função do DR.</b></p> <p>Os roteadores em uma rede multiacesso elegem um DR e um BDR. Os DROthers só formam adjacências inteiras com o DR e o BDR na rede. Isto significa que, em vez de enviar LSAs para todos os roteadores na rede, os DROthers somente enviam os LSAs para o DR e BDR utilizando o endereço multicast 224.0.0.6 (ALLDRouters – Todos os roteadores DR). Na animação, R1 envia LSAs para o DR. O BDR também escuta. O DR é responsável por encaminhar os LSAs de R1 para todos os outros roteadores. O DR utiliza o endereço multicast 224.0.0.5 (AllSPFRouters - Todos os roteadores OSPF). O resultado final é que há somente um roteador fazendo todo o envio de todos os LSAs na rede multiacesso. </p></content-text>
</page>
</topic>
<topic type="" id="tl0911040200">
<title><content-text>Processo de eleição DR/BDR</content-text></title>
<page type="OneColumn" id="tl0911040201">
<content-media type="InteractiveGraphicHotspots" id="cm1650231404"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040200/tl0911040201/cm1650231404.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040200/tl0911040201/cm1650231404text.xml"/></content-media>
<content-text><p><b>Alteração de topologia</b></p> <p>As eleições de DR/BDR não ocorrem em redes ponto-a-ponto. Portanto, em uma topologia de três roteadores padrão, R1, R2 e R3 não precisam eleger um DR e BDR, porque os links entre estes roteadores não são redes multiacesso. </p> <p><b>Clique em Topologia Multiacesso na figura.</b></p> <p>Para o resto da discussão sobre DR e BDR, nós utilizaremos a topologia multiacesso mostrada na figura. Os nomes dos roteadores são diferentes, somente para enfatizar que esta topologia não é a mesma topologia de três roteadores que nós temos utilizado até este ponto. Nós voltaremos a nossa topologia do capítulo depois da discussão do processo de eleição DR/BDR. Nesta nova topologia, nós temos três roteadores que compartilham uma rede multiacesso Ethernet comum, 192.168.1.0/24. Cada roteador é configurado com um endereço IP na interface Fast Ethernet e um endereço de loopback para a ID do roteador.</p></content-text>
</page>
<page type="OneColumn" id="tl0911040202">
<content-media type="InteractiveGraphicHotspots" id="cm8301589015"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040200/tl0911040202/cm8301589015.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040200/tl0911040202/cm8301589015text.xml"/></content-media>
<content-text><p><b>Eleição DR/BDR</b></p> <p>Como o DR e o BDR são eleitos? Os seguintes critérios são aplicados:</p> <p>1. DR: Roteador com a mais alta prioridade de interface OSPF.</p> <p>2. BDR: Roteador com a segunda mais alta prioridade de interface OSPF. </p> <p>3. Se as prioridades de interface OSPF são iguais, a ID de roteador mais alta é utilizada para desempatar.</p> <p>Neste exemplo, a prioridade de interface OSPF padrão é 1. Como resultado, baseado nos critérios de seleção listados acima, a ID do roteador OSPF é utilizada para eleger o DR e BDR. Como você pode ver, o Roteador C torna-se o DR e o Roteador B, com a segunda maior ID de roteador, torna-se o BDR. Como o Roteador A não é eleito nem como DR nem BDR, ele se torna o DROther.</p> <p>OS DROthers só formam adjacências <b>FULL</b> com o DR e BDR, mas ainda formarão uma adjacência de vizinho com qualquer DROther que se unir à rede. Isto significa que todos os roteadores DROther na rede multiacesso ainda recebem pacotes Hello de todos os outros roteadores DROther. Deste modo, eles estão cientes de todos os roteadores na rede. Quando dois roteadores DROther formarem uma adjacência de vizinho, o estado de vizinho é exibido como <b>2WAY</b>. Os diferentes estados de vizinho são discutidos no CCNP.</p> <p><b>Clique em </b><span class="cmd"><b>show ip ospf neighbor</b></span><b> na figura.</b></p> <p>A saída de comando na figura exibe a adjacência de vizinho de cada roteador na rede multiacesso. Note que, para o Roteador A, ela mostra que o DR é o Roteador C com a ID de roteador 192.168.31.33 e que o BDR é o Roteador B com a ID de roteador 192.168.31.22.</p> <p><b>Clique em </b><span class="cmd"><b>show ip ospf interface</b></span><b> na figura.</b></p> <p>Como o Roteador A mostra seus dois vizinhos como o DR e BDR, o Roteador A é um DROther. Isto pode ser verificado com o uso do comando <span class="cmd"><b>show ip ospf interface fastethernet 0/0</b></span> no Roteador A, como mostrado na figura. Este comando mostrará o estado DR, BDR ou DROTHER deste roteador, junto com a ID de roteador do DR e BDR nesta rede multiacesso.</p></content-text>
</page>
<page type="OneColumn" id="tl0911040203">
<content-media type="InteractiveGraphicHotspots" id="cm8996082338"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040200/tl0911040203/cm8996082338.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040200/tl0911040203/cm8996082338text.xml"/></content-media>
<content-text><p><b>Momento da eleição DR/BDR</b></p> <p>O processo de eleição DR e BDR acontece assim que o primeiro roteador com uma interface habilitada de OSPF está ativo na rede multiacesso. Isto pode acontecer quando os roteadores forem ligados ou quando o comando <span class="cmd"><b>network</b></span> do OSPF para aquela interface for configurado. O processo de eleição só leva alguns segundos. Se todos os roteadores na rede multiacesso não terminarem de inicializar, é possível que um roteador com uma ID de roteador inferior torne-se o DR. Este poderia ser um roteador lower-end que levou menos tempo para inicializar. </p> <p>Quando o DR é eleito, ele permanece como DR até que uma das condições seguintes ocorra:</p> <p><ul><li> O DR falha.</li><li> O processo OSPF no DR falha.</li><li> A interface multiacesso no DR falha.</li></ul></p> <p>Na figura, um <b>X</b> vermelho indica uma ou mais destas falhas.</p> <p><b>Clique em DR falha na figura.</b></p> <p>Se o DR falhar, o BDR assume a função de DR e uma eleição é realizada para escolher um novo BDR. Na figura, o Roteador C falha e o BDR antigo, o Roteador B, torna-se o DR. O único outro roteador disponível para ser o BDR é o Roteador A.</p> <p><b>Clique em Novo roteador na figura.</b></p> <p>O Roteador D junta-se à rede. Se um novo roteador entrar na rede depois de o DR e BDR terem sido eleitos, ele não se tornará o DR ou o BDR mesmo se tiver uma prioridade de interface OSPF ou ID de roteador mais altas do que o DR e BDR atuais. O novo roteador pode ser eleito como BDR se o DR ou BDR atuais falharem. Se o DR atual falhar, o BDR se tornará o DR e o novo roteador poderá ser eleito o novo BDR. Depois de o novo roteador tornar-se o BDR, se o DR falhar, o novo roteador se tornará o DR. O DR e BDR atuais deverão falhar antes de o novo roteador poder ser eleito DR ou BDR. </p> <p><b>Clique em DR antigo retorna na figura.</b></p> <p>Um DR anterior não recupera o status de DR se voltar à rede. Na figura, o Roteador C concluiu uma reinicialização e tornou-se um DROther embora sua ID de roteador, 192.168.31.33, seja mais alta que o DR e BDR atuais.</p> <p><b>Clique em BDR falha na figura.</b></p> <p>Se o BDR falhar, uma eleição é realizada entre os DRothers para ver qual roteador será o novo BDR. Na figura, o roteador BDR falha. Uma eleição é realizada entre o Roteador C e o Roteador D. O Roteador D ganha a eleição com a ID de roteador mais alta.</p> <p><b>Clique em Novo DR falha na figura.</b></p> <p>Na figura, o Roteador B falha. Como o Roteador D é o BDR atual, ele é promovido a DR. O Roteador C torna-se o BDR.</p> <p>Sendo assim, como você tem certeza de que os roteadores que você deseja que sejam o DR e BDR ganham a eleição? Sem configurações adicionais, a solução é: </p> <p><ul><li> Em primeiro lugar, inicialize o DR, seguido pelo BDR e, em seguida, inicialize todos os outros roteadores, ou</li><li> Desligue a interface em todos os roteadores, seguido por um <span class="cmd"><b>no shutdown</b></span> no DR, depois no BDR e então todos os outros roteadores.</li></ul></p> <p>Porém, como você já pode ter adivinhado, nós podemos alterar a prioridade de interface OSPF para controlar melhor nossas eleições de DR/BDR.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911040300">
<title><content-text>Prioridade de interface OSPF</content-text></title>
<page type="OneColumn" id="tl0911040301">
<content-media type="InteractiveGraphicHotspots" id="cm9121787259"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040300/tl0911040301/cm9121787259.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040300/tl0911040301/cm9121787259text.xml"/></content-media>
<content-text><p>Como o DR se torna o foco para coleta e distribuição de LSAs, é importante que este roteador tenha CPU suficiente e capacidade de memória para arcar com a responsabilidade. Em vez de confiar na ID do roteador para decidir quais roteadores são eleitos DR e BDR, é melhor controlar a eleição destes roteadores com o comando de interface <span class="cmd"><b>ip ospf priority</b></span>.</p> <p><span class="cmd">Router(config-if)#<b>ip ospf priority</b> {<b>0 </b>- <b>255</b>}</span></p> <p>Em nossa discussão anterior, a prioridade de OSPF era igual. Isto se deve ao fato de que o valor de prioridade padrão é 1 para todas as interfaces do roteador. Portanto, a ID de roteador determinou o DR e o BDR. No entanto, se você alterar o valor padrão de 1 para um valor mais alto, o roteador com a prioridade mais alta se tornará o DR e o roteador com a próxima prioridade mais alta se tornará o BDR. Um valor de 0 faz o roteador não qualificado se tornar um DR ou BDR. </p> <p>Como as prioridades são um valor específico de interface, elas fornecem um melhor controle das redes multiacesso OSPF. Elas também permitem que um roteador seja o DR em uma rede e um DROther em outra.</p> <p><b>Clique em </b><span class="cmd"><b>show ip ospf interface</b></span><b> na figura.</b></p> <p>Para simplificar nossa discussão, nós removemos o Roteador D da topologia. A prioridade de interface OSPF pode ser exibida utilizando o comando <span class="cmd"><b>show ip ospf interface</b></span>. Na figura, nós podemos verificar que a prioridade no Roteador A possui o valor padrão de 1. </p> <p><b>Clique em Modificar prioridade na figura.</b></p> <p>A figura mostra as prioridades da interface OSPF do Roteador A e do Roteador B modificadas de forma que o Roteador A com a prioridade mais alta torne-se o DR e o Roteador B torne-se o BDR. A prioridade de interface OSPF do Roteador C permanece com o valor padrão de 1.</p> <p><b>Clique em Forçar eleição na figura.</b></p> <p>Depois de fazer um <span class="cmd"><b>shutdown</b></span> e um <span class="cmd"><b>no shutdown</b></span> nas interfaces FastEthernet 0/0 de todos os três roteadores, observamos o resultado da alteração das prioridades do OSPF nas interface. O comando <span class="cmd"><b>show ip ospf neighbor</b></span> no Roteador C mostra agora que o Roteador A (ID de roteador 192.168.31.11) é o DR com a mais alta prioridade de interface OSPF de 200 e que o Roteador B (ID de roteador 192.168.31.22) ainda é o BDR com a próxima mais alta prioridade de interface OSPF de 100. A partir da saí's do Roteador A de <span class="cmd"><b>show ip ospf neighbor</b></span>, observe que ela não mostra um DR, porque o Roteador A é o real DR nesta rede. </p></content-text>
</page>
<page type="OneColumn" id="tl0911040302">
<content-media type="ActivityPKA" id="cm9468065065"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040300/tl0911040302/cm9468065065/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911040000/tl0911040300/tl0911040302/cm9468065065/icontext.xml"/></content-media>
<content-text><p>Utilize esta Atividade do Packet Tracer para examinar as funções atuais do DR e do BDR, observe a alteração das funções e, em seguida, force novas funções alterando a prioridade.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0911050000">
<title><content-text>Mais configurações do OSPF</content-text></title>
<topic type="" id="tl0911050100">
<title><content-text>Redistribuindo uma rota padrão com OSPF</content-text></title>
<page type="OneColumn" id="tl0911050101">
<content-media type="InteractiveGraphicHotspots" id="cm6772299099"><title><content-text></content-text></title><media ref="tl0911000000/tl0911050000/tl0911050100/tl0911050101/cm6772299099.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911050000/tl0911050100/tl0911050101/cm6772299099text.xml"/></content-media>
<content-text><p><b>Topologia</b></p> <p>Voltemos à topologia anterior, que agora inclui um novo link para ISP. Assim como com RIP e EIGRP, o roteador conectado à Internet é utilizado para propagar uma rota padrão a outros roteadores no domínio de roteamento OSPF. Este roteador é chamado algumas vezes de borda, entrada ou roteador gateway. Porém, na terminologia de OSPF, o roteador localizado entre um domínio de roteamento OSPF e uma rede não-OSPF é chamado de <content-link target="cg8572378873" type="glossary">Roteador de Borda de Sistema Autônomo (ASBR)</content-link>. Nesta topologia, o Loopback1 (Lo1) representa um link para uma rede não-OSPF. Nós não configuraremos a rede 172.30.1.1/30 como parte do processo de roteamento OSPF.</p> <p><b>Clique em Configuração padrão estática de R1 na figura.</b></p> <p>A figura mostra o ASBR (R1) configurado com o endereço IP de Loopback1 e a rota padrão estática encaminhando o tráfego para o roteador ISP:</p> <p><span class="cmd">R1(config)#<b>ip route 0.0.0.0 0.0.0.0 loopback 1</b></span></p> <p><b>Nota:</b> a rota padrão estática está utilizando o loopback como uma interface de saída porque o roteador ISP nesta topologia não existe fisicamente. Utilizando uma interface de loopback, podemos simular a conexão com outro roteador.</p> <p>Como o RIP, o OSPF requer o uso do comando <span class="cmd"><b>default-information originate</b></span> para anunciar a rota padrão estática 0.0.0.0/0 aos outros roteadores na área. Se o comando <span class="cmd"><b>default-information originate</b></span> não for utilizado, a rota "quad-zero" padrão não será propagada a outros roteadores na área OSPF. </p> <p>A sintaxe do comando é:</p> <p><span class="cmd">R1(config-router)#<b>default-information originate</b> </span></p> <p><b>Clique em R1, R2 e R3 na figura.</b></p> <p>R1, R2 e R3 possuem agora um "gateway de último recurso" definido na tabela de roteamento. Observe a rota padrão em R2 e R3 assinalada como tendo sido aprendida através do OSPF, mas com o código adicional <span class="cmd"><b>E2</b></span>. Para R2, a rota é:</p> <p><span class="cmd">O*<span class="blue">E2</span> 0.0.0.0/0 [110/1] via 192.168.10.10, 00:05:34, Serial0/0/1</span></p> <p><b>E2</b> denota que esta rota é uma rota OSPF Externa Tipo 2. </p> <p>As rotas externas OSPF caem em uma de duas categorias: Externa Tipo 1 (E1) ou Externa Tipo 2 (E2). A diferença entre os dois está no modo como o custo de OSPF da rota é calculado em cada roteador. O OSPF acumula o custo para uma rota E1 conforme a rota está sendo propagada ao longo da área OSPF. Este processo é idêntico para cálculos de custo para rotas internas OSPF normais. Porém, o custo de uma rota E2 sempre é o custo externo, seja qual for o custo interior para alcançar aquela rota. Nesta topologia, uma vez que a rota padrão possui um custo externo de 1 no roteador R1, R2 e R3 também exibem um custo de 1 para a rota <b>E2</b> padrão. As rotas E2 a um custo de 1 são a configuração OSPF padrão. A alteração destes padrões, bem como mais informações de rotas externas, é discutida no CCNP.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911050200">
<title><content-text>Ajustando o OSPF</content-text></title>
<page type="OneColumn" id="tl0911050201">
<content-media type="InteractiveGraphicHotspots" id="cm1011211104"><title><content-text></content-text></title><media ref="tl0911000000/tl0911050000/tl0911050200/tl0911050201/cm1011211104.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911050000/tl0911050200/tl0911050201/cm1011211104text.xml"/></content-media>
<content-text><p><b>Largura de banda de referência</b></p> <p>Como você se lembra, o custo do Cisco OSPF utiliza largura de banda acumulada. O valor de largura de banda de cada interface é calculado utilizando 100.000.000/largura de banda; 100.000.000 ou 10 à 8a potência é conhecido como a largura de banda de referência.</p> <p>Portanto, 100.000.000 é a largura de banda padrão indicada quando a largura de banda real é convertida em uma métrica de custo. De acordo com o que foi aprendido em estudos anteriores, agora temos velocidades de link que são muito mais rápidas do que as velocidades da Fast Ethernet, inclusive o Gigabit Ethernet e 10GigE. Utilizar uma largura de banda de referência de 100.000.000 resulta em interfaces com valores de largura de banda de 100 Mbps e mais altos, tendo o mesmo custo de OSPF de 1. </p> <p>Para obter cálculos de custo mais precisos, pode ser necessário ajustar o valor de largura de banda de referência. A largura de banda de referência pode ser modificada para acomodar estes links mais rápidos utilizando o comando <span class="cmd"><b>auto-cost reference-bandwidth</b></span> de OSPF. Quando este comando for necessário, utilize-o em todos os roteadores de modo que a métrica de roteamento OSPF permaneça consistente.</p> <span class="cmd"><p>R1(config-router)#<b>auto-cost reference-bandwidth ?</b></p></span> <span class="cmd"><p> 1-4294967 The reference bandwidth in terms of Mbits per second</p></span> <p>Observe que o valor é expressado em Mbps. Portanto, o valor padrão é equivalente a 100. Para aumentá-lo a velocidades de 10GigE, você precisa alterar a largura de banda de referência para 10000.</p> <p><span class="cmd">R1(config-router)#<b>auto-cost reference-bandwidth 10000</b></span></p> <p>Novamente, certifique-se de ter configurado este comando em todos os roteadores no domínio de roteamento OSPF. O IOS também pode lembrá-lo, como mostrado na figura.</p> <p><b>Clique em R1 antes e R1 depois na figura.</b></p> <p>A tabela de roteamento para R1 mostra a alteração na métrica de custo OSPF. Observe que os valores de custo muito mais altos para rotas OSPF. Por exemplo, em <b>R1 Antes</b>, o custo para 10.10.10.0/24 é <b>1172</b>. Depois de configurar uma nova largura de banda de referência, o custo para a mesma rota é agora <b>117287</b>.</p></content-text>
</page>
<page type="OneColumn" id="tl0911050202">
<content-media type="InteractiveGraphicHotspots" id="cm3932849466"><title><content-text></content-text></title><media ref="tl0911000000/tl0911050000/tl0911050200/tl0911050202/cm3932849466.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911050000/tl0911050200/tl0911050202/cm3932849466text.xml"/></content-media>
<content-text><p><b>Modificando os intervalos de OSPF</b></p> <p><b>Clique em Vizinhos de R1 1 na figura.</b></p> <p>O comando <span class="cmd"><b>show ip ospf neighbor</b></span> em R1 verifica que R1 é adjacente a R2 e R3. Observe na saída de comando que o Dead Time está fazendo uma contagem regressiva de 40 segundos. Por padrão, este valor é atualizado a cada 10 segundos quando o R1 recebe Hello do vizinho.</p> <p>Você pode desejar alterar os temporizadores de OSPF de forma que os roteadores detectem falhas de rede em menos tempo. Fazer isto aumentará o tráfego, mas muitas vezes há uma necessidade de uma convergência rápida mesmo que isto implique em um tráfego adicional.</p> <p>Os intervalos de Hello e de Dead de OSPF podem ser modificados manualmente utilizando os seguintes comandos de interface:</p> <span class="cmd"><p>Router(config-if)#<b>ip ospf hello-interval </b><i>seconds</i></p></span> <span class="cmd"><p>Router(config-if)#<b>ip ospf dead-interval </b><i>seconds</i></p></span> <p><b>Clique em Modificar temporizadores de R1 na figura.</b></p> <p>A figura mostra os intervalos de Hello e de Dead modificados para 5 segundos e 20 segundos, respectivamente, na interface Serial 0/0/0 para R1. Imediatamente depois de alterar o intervalo de Hello, o Cisco IOS modifica o intervalo de Dead automaticamente para quatro vezes o intervalo de Hello. Porém, é sempre recomendável modificar o temporizador explicitamente em vez de confiar em um recurso do IOS de modo que as modificações sejam documentadas na configuração. </p> <p>Após 20 segundos, o Temporizador Dead em R1 expira. R1 e R2 perdem adjacência. Nós somente modificamos os valores em um lado do link serial entre R1 e R2.</p> <p><span class="cmd">%OSPF-5-ADJCHG: Process 1, Nbr 10.2.2.2 on Serial0/0/0 from FULL to DOWN, Neighbor Down: Dead timer expired</span></p> <p><b>Clique em Vizinhos de R1 2 na figura.</b></p> <p>Lembre-se, os intervalos de Hello e de Dead de OSPF devem ser equivalentes entre os vizinhos. Você pode verificar a perda de adjacência com o comando <span class="cmd"><b>show ip ospf neighbor</b></span> em R1. Observe que o vizinho 10.2.2.2 não está mais presente. Porém, 10.3.3.3 ou R3 ainda é um vizinho. Os temporizadores definidos na Serial 0/0/0 não afetam a adjacência de vizinho com R3.</p> <p><b>Clique em Temporizadores de R2 na figura.</b></p> <p>Os intervalos de Hello e de Dead não correspondentes podem ser verificados em R2 utilizando o comando <span class="cmd"><b>show ip ospf interface serial 0/0/0</b></span>. Os valores do intervalo em R2, ID de roteador 10.2.2.2, ainda estão definidos com um intervalo de Hello de 10 segundos e intervalo de Dead de 40 segundos. </p> <p><b>Clique em Modificar temporizadores de R2 na figura.</b></p> <p>Para restaurar a adjacência entre R1 e R2, modifique os intervalos de Hello e de Dead na interface Serial  0/0/0 em R2 para corresponder aos intervalos na interface Serial 0/0/0 em R1. O IOS exibe uma mensagem informando que a adjacência foi estabelecida com um estado de <span class="cmd"><b>FULL</b></span>.</p> <p><span class="cmd">14:22:27: %OSPF-5-ADJCHG: Process 1, Nbr 10.1.1.1 on Serial0/0 from LOADING to FULL, Loading Done</span></p> <p><b>Clique em Vizinhos de R1 3 na figura.</b></p> <p>Verifique que a adjacência de vizinho é restaurada com o comando show ip ospf neighbor em R1. Observe que o Dead Time da Serial 0/0/0 é agora muito inferior porque está fazendo contagem regressiva de 20 segundos em vez dos 40 segundos padrão. Serial 0/0/1 ainda está em funcionamento com temporizadores padrão.</p> <p><b>Nota:</b> o OSPF exige que os intervalos de Hello e de Dead façam a correspondência entre dois roteadores para que eles se tornem adjacentes. Isto difere do EIGRP, onde os temporizadores Hello e Holddown não precisam corresponder para que dois roteadores formem uma adjacência de EIGRP. </p> <p> </p></content-text>
</page>
<page type="OneColumn" id="tl0911050203">
<content-media type="ActivityPKA" id="cm2090191812"><title><content-text></content-text></title><media ref="tl0911000000/tl0911050000/tl0911050200/tl0911050203/cm2090191812/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911050000/tl0911050200/tl0911050203/cm2090191812/icontext.xml"/></content-media>
<content-text><p>Utilize a Atividade do Packet Tracer para configurar uma rota padrão e propagá-la dentro do processo de roteamento OSPF. Além disso, altere a largura de banda de referência bem como os intervalos de Hello e de Dead.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0911060000">
<title><content-text>Laboratórios de configuração OSPF</content-text></title>
<topic type="" id="tl0911060100">
<title><content-text>Laboratório de configuração OSPF básico</content-text></title>
<page type="OneColumn" id="tl0911060101">
<content-media type="ActivityLab" id="cm1737336076"><title><content-text></content-text></title><media ref="tl0911000000/tl0911060000/tl0911060100/tl0911060101/cm1737336076/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911060000/tl0911060100/tl0911060101/cm1737336076/icontext.xml"/></content-media>
<content-text><p>Nesta atividade de laboratório, existem dois cenários separados. No primeiro cenário, você aprenderá a configurar o protocolo de roteamento OSPF utilizando a rede mostrada no Diagrama da Topologia no Cenário A. Os segmentos da rede foram colocados em sub-rede utilizando VLSM (Variable Length Subnet Mask, máscara de sub-rede de tamanho variável). O OSPF é um protocolo de roteamento classless que pode ser utilizado para fornecer informações de máscara de sub-rede nas atualizações de roteamento. Isto permitirá que as informações da sub-rede VLSM sejam propagadas por toda a rede. </p> <p>No segundo cenário, você aprenderá a configurar o OSPF em uma rede multiacesso. Você também aprenderá a utilizar o processo de eleição OSPF para determinar os estados de roteador designado (DR), roteador designado de backup (BDR) e DRother.</p></content-text>
</page>
<page type="OneColumn" id="tl0911060102">
<content-media type="ActivityPKA" id="cm1867715526"><title><content-text></content-text></title><media ref="tl0911000000/tl0911060000/tl0911060100/tl0911060102/cm1867715526/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911060000/tl0911060100/tl0911060102/cm1867715526/icontext.xml"/></content-media>
<content-text><p>Utilize esta Atividade do Packet Tracer para repetir uma simulação do Laboratório 11.6.1. Lembre-se, entretanto, de que o Packet Tracer não substitui um exercício prático em laboratório com equipamentos reais. </p> <p>Um resumo das instruções é fornecido na atividade. Use o PDF do laboratório para obter mais detalhes.</p> <p><b>Clique no ícone do Packet Tracer para iniciar o Cenário A. Todos os cenários para esta simulação do laboratório prático podem ser iniciados a partir dos links abaixo.</b></p> <p><content-link target="E2_PTAct_11_6_1a.pka" type="internalfile">Cenário A</content-link></p> <p><content-link target="E2_PTAct_11_6_1b.pka" type="internalfile">Cenário B</content-link></p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl0911060200">
<title><content-text>Laboratório de configuração OSPF avançado</content-text></title>
<page type="OneColumn" id="tl0911060201">
<content-media type="ActivityLab" id="cm3141260913"><title><content-text></content-text></title><media ref="tl0911000000/tl0911060000/tl0911060200/tl0911060201/cm3141260913/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911060000/tl0911060200/tl0911060201/cm3141260913/icontext.xml"/></content-media>
<content-text><p>Nesta atividade de laboratório, você receberá um endereço de rede que deve ser colocado em sub-rede utilizando o VLSM para concluir o endereçamento da rede mostrado no Diagrama de Topologia. Uma combinação entre roteamentos OSPF e estático será exigida para que os hosts em redes que não estejam diretamente conectadas possam se comunicar. ID de área OSPF igual a 0 e ID de processo igual a 1 serão utilizados em todas as configurações OSPF.</p></content-text>
</page>
<page type="OneColumn" id="tl0911060202">
<content-media type="ActivityPKA" id="cm9785155336"><title><content-text></content-text></title><media ref="tl0911000000/tl0911060000/tl0911060200/tl0911060202/cm9785155336/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911060000/tl0911060200/tl0911060202/cm9785155336/icontext.xml"/></content-media>
<content-text><p>Utilize esta Atividade do Packet Tracer para repetir uma simulação do Laboratório 11.6.2. Lembre-se, entretanto, de que o Packet Tracer não substitui um exercício prático em laboratório com equipamentos reais. </p> <p>Um resumo das instruções é fornecido na atividade. Use o PDF do laboratório para obter mais detalhes.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl0911060300">
<title><content-text>Laboratório de configuração de identificação e solução de problemas de OSPF</content-text></title>
<page type="OneColumn" id="tl0911060301">
<content-media type="ActivityLab" id="cm7917924119"><title><content-text></content-text></title><media ref="tl0911000000/tl0911060000/tl0911060300/tl0911060301/cm7917924119/" mime="application/pdf" scale="icontext.xml" type="directory" width="0" height="0" external="tl0911000000/tl0911060000/tl0911060300/tl0911060301/cm7917924119/icontext.xml"/></content-media>
<content-text><p>Neste laboratório, você começará carregando scripts de configuração em todos os roteadores. Esses scripts contêm erros que impedirão a comunicação fim-a-fim através da rede. </p> <p>Você precisará identificar e solucionar os problemas de cada roteador para determinar os erros de configuração e então utilizar os comandos apropriados para corrigir as configurações. </p> <p>Quando todos os erros de configuração forem corrigidos, todos os hosts na rede devem poder se comunicar. </p></content-text>
</page>
<page type="OneColumn" id="tl0911060302">
<content-media type="ActivityPKA" id="cm5792827552"><title><content-text></content-text></title><media ref="tl0911000000/tl0911060000/tl0911060300/tl0911060302/cm5792827552/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911060000/tl0911060300/tl0911060302/cm5792827552/icontext.xml"/></content-media>
<content-text><p>Utilize esta Atividade do Packet Tracer para repetir uma simulação do Laboratório 11.6.3. Lembre-se, entretanto, de que o Packet Tracer não substitui um exercício prático em laboratório com equipamentos reais. </p> <p>Um resumo das instruções é fornecido na atividade. Use o PDF do laboratório para obter mais detalhes.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
</section>
<section type="ChapterSummary" id="tl0911070000">
<title><content-text>Resumo do capítulo</content-text></title>
<topic type="" id="tl0911070100">
<title><content-text>Resumo e revisão</content-text></title>
<page type="OneColumn" id="tl0911070101">
<content-media type="StaticGraphic" id="cm6481762101"><title><content-text></content-text></title><media ref="tl0911000000/tl0911070000/tl0911070100/tl0911070101/cm6481762101.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911070000/tl0911070100/tl0911070101/cm6481762101text.xml"/></content-media>
<content-text><p><b>Resumo</b></p> <p>OSPF (Open Shortest Path First) é um protocolo de roteamento link-state classless. A versão atual do OSPF para IPv4 é o OSPFv2 introduzido na RFC 1247 e atualizado na RFC 2328 por John Moy. Em 1999, o OSPFv3 para IPv6 foi publicado na RFC 2740.</p> <p>O OSPF tem uma distância administrativa padrão de 110 e é denotado na tabela de roteamento com um código de fonte de rota de <b>O</b>. O OSPF é habilitado com o comando de configuração global <span class="cmd"><b>router ospf</b><i> process-id</i></span>. O <span class="cmd"><i> process-id</i></span> é localmente significativo, o que significa que ele não tem que corresponder a outros roteadores OSPF para estabelecer adjacências com esses vizinhos.</p> <p>O comando network utilizado com o OSPF tem a mesma função de quando utilizado com outros protocolos de roteamento IGP, mas com sintaxe ligeiramente diferente. </p> <p><span class="cmd">Router (config-router)<b>#network </b><i>network-address wildcard-mask</i><b> area </b><i>area-id</i></span></p> <p>O <span class="cmd"><i>wildcard-mask</i></span> é o inverso da máscara de sub-rede e o <span class="cmd"><i>area-id</i></span> deve ser definido como 0.</p> <p>O OSPF não utiliza um protocolo da camada de transporte, já que os pacotes OSPF são enviados diretamente utilizando-se a camada IP. O pacote Hello do OSPF é utilizado por OSPF para estabelecer adjacências de vizinho. Por padrão, os pacotes Hello de OSPF são enviados a cada 10 segundos em segmentos multiacesso e ponto-a-ponto e a cada 30 segundos em segmentos de rede ponto-a-multiponto (NBMA) (Frame Relay, X.25, ATM) (NBMA). O intervalo de Dead é o período de tempo que um roteador OSPF esperará antes de finalizar a adjacência com um vizinho. Por padrão, o intervalo de Dead é quatro vezes o intervalo de Hello. Para segmentos multiacesso e ponto-a-ponto, este período é de 40 segundos. Para redes NBMA, o intervalo de Dead é de 120 segundos.</p> <p>Para que os roteadores se tornem adjacentes, o intervalo de Hello, o intervalo de Dead, os tipos de rede e as máscaras de sub-rede devem corresponder. O comando <span class="cmd"><b>show ip ospf neighbors</b></span> pode ser utilizado para verificar as adjacências de OSPF.</p> <p>A ID do roteador OSPF é utilizada para identificar unicamente cada roteador no domínio de roteamento OSPF. Os roteadores Cisco produzem a ID do roteador com base em três critérios e com a seguinte precedência:</p> <p>1. Utilize o endereço IP configurado com comando <span class="cmd"><b>router-id</b></span> de OSPF.</p> <p>2. Se o <span class="cmd"><b>router-id</b></span> não estiver configurado, o roteador escolherá o endereço IP mais alto de qualquer uma de suas interfaces de loopback.</p> <p>3. Se nenhuma interface de loopback estiver configurada, o roteador escolherá o endereço IP ativo mais alto de suas interfaces físicas.</p> <p>A RFC 2328 não especifica quais valores devem ser utilizados para determinar o custo. O Cisco IOS utiliza as larguras de banda cumulativas das interfaces de saída do roteador para a rede de destino como o valor de custo.</p> <p>Redes multiacesso podem criar dois desafios para o OSPF relativos ao envio de LSAs, inclusive a criação de múltiplas adjacências - uma adjacência para cada par de roteadores e envio excessivo de LSAs (Anúncios Link-State). O OSPF elege um Roteador Designado (DR) para agir como ponto de coleta e distribuição para os LSAs enviados e recebidos na rede multiacesso. Um BDR (Roteador Designado de Backup) é eleito para assumir a função do DR no caso de o DR falhar. Todos os outros roteadores são conhecidos como DROthers. Todos os roteadores enviam seus LSAs para o DR, que, por sua vez, envia o LSA para todos os outros roteadores na rede multiacesso. </p> <p>O roteador com a ID de roteador mais alta é o DR e o roteador com a segunda ID de roteador mais alta é o BDR. Isto pode ser substituído pelo comando <span class="cmd"><b>ip ospf priority</b></span> naquela interface. Por padrão, o <span class="cmd"><b>ip ospf priority</b></span> é "1" em todas as interfaces multiacesso. Se um roteador for configurado com um novo valor de prioridade, o roteador com o valor de prioridade mais alto será o DR e o próximo mais alto será o BDR. Um valor de prioridade de “0” significa que o roteador não é qualificado para se tornar um DR ou BDR.</p> <p>Uma rota padrão é propagada em OSPF semelhante àquela de RIP. O comando do modo do roteamento OSPF <span class="cmd"><b>default-information originate</b></span> é utilizado para propagar uma rota padrão estática.</p> <p>O comando <span class="cmd"><b>show ip protocols</b></span> é utilizado para verificar informações de configuração OSPF importantes, inclusive a ID do processo OSPF, ID de roteador e as redes que o roteador está anunciando.</p></content-text>
</page>
<page type="FullScreen" id="tl0911070102">
<content-media type="ChapterSummary" id="cm4988293699"><title><content-text></content-text></title><media ref="tl0911000000/tl0911070000/tl0911070100/tl0911070102/cm4988293699.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911070000/tl0911070100/tl0911070102/cm4988293699text.xml"/></content-media>
<content-text></content-text>
</page>
<page type="OneColumn" id="tl0911070103">
<content-media type="ActivityPKA" id="cm4174693481"><title><content-text></content-text></title><media ref="tl0911000000/tl0911070000/tl0911070100/tl0911070103/cm4174693481/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911070000/tl0911070100/tl0911070103/cm4174693481/icontext.xml"/></content-media>
<content-text><p>A Atividade avançada de integração das habilidades no Packet Tracer integra todo o conhecimento e habilidades que você adquiriu nos capítulos anteriores deste curso e cursos anteriores. As habilidades relacionadas à discussão sobre OSPF deste capítulo também estão incluídas. </p> <p>Nesta atividade, você cria uma rede do zero. Começando com um espaço de endereçamento e requisitos de rede, você deve implementar um projeto de rede que atenda às especificações. Em seguida, você implementa uma configuração de roteamento OSPF efetiva com roteamento padrão integrado. Instruções detalhadas são fornecidas na atividade. </p> <p><content-link target="E2_PTAct_11_7_1_Directions.pdf" type="internalfile">Instruções de integração das habilidades no Packet Tracer (PDF)</content-link></p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
<page type="OneColumn" id="tl0911070104">
<content-media type="StaticGraphic" id="cm9917528955"><title><content-text></content-text></title><media ref="tl0911000000/tl0911070000/tl0911070100/tl0911070104/cm9917528955.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911070000/tl0911070100/tl0911070104/cm9917528955text.xml"/></content-media>
<content-text><p><b>Para saber mais</b></p> <p> </p> <p><b>OSPF RFC 2328 versão 2</b></p> <p>RFCs Request for Comments são uma série de documentos enviados para a IETF Internet Engineering Task Force para propor um padrão de Internet ou atribuir novos conceitos informações ou até mesmo humor. A RFC 2328 é a RFC atual para OSPFv2. </p> <p>As RFCs podem ser acessadas em vários sites, inclusive <content-link target="http://www.ietf.org" type="external">www.ietf.org</content-link>. Leia tudo ou partes da RFC OSPF para obter mais informações sobre este protocolo de roteamento link-state classless. </p> <p><b>OSPF Multiárea</b></p> <p>Algumas das vantagens reais do OSPF, especialmente em grandes redes, podem ser observadas com OSPF multiárea. O OSPF Multiárea é discutido no CCNP, mas você pode estar interessado em observar agora alguns destes novos conceitos. </p> <p>Aqui estão alguns recursos sugeridos:</p> <p><ul><li> <i>Routing TCP/IP, Volume I</i>, por Jeff Doyle e Jennifer Carroll</li><li> <i>OSPF, Anatomy of an Internet Routing Protocol</i>, por John Moy</li></ul></p></content-text>
</page>
</topic>
</section>
<section type="ChapterQuiz" id="tl0911080000">
<title><content-text>Teste do capítulo</content-text></title>
<topic type="" id="tl0911080100">
<title><content-text>Teste do capítulo</content-text></title>
<page type="FullScreen" id="tl0911080101">
<content-media type="ChapterQuiz" id="cm6500755456"><title><content-text></content-text></title><media ref="tl0911000000/tl0911080000/tl0911080100/tl0911080101/cm6500755456/" mime="" scale="true" type="directory" width="100%" height="100%" external="tl0911000000/tl0911080000/tl0911080100/tl0911080101/cm6500755456/icontext.xml"/></content-media>
<content-text></content-text>
</page>
</topic>
</section>
</chapter>
