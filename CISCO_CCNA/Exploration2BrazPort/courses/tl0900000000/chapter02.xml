<chapter type="" id="tl0902000000">
<title><content-text>Roteamento estático</content-text></title>
<section type="ChapterIntroduction" id="tl0902000000">
<title><content-text>Introdução do capítulo</content-text></title>
<topic type="" id="tl0902000100">
<title><content-text>Introdução do capítulo</content-text></title>
<page type="OneColumn" id="tl0902000101">
<content-media type="StaticGraphic" id="cm1838215924"><title><content-text></content-text></title><media ref="tl0902000000/tl0902000000/tl0902000100/tl0902000101/cm1838215924.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902000000/tl0902000100/tl0902000101/cm1838215924text.xml"/></content-media>
<content-text><p><b>Introdução do capítulo</b></p> <p>O roteamento está no centro de todas as redes de dados, movendo informações em redes interconectadas da origem para o destino. Os roteadores são os dispositivos responsáveis pela transferência de pacotes de uma rede para a próxima.</p> <p>Como nós vimos no capítulo anterior, os roteadores aprendem as redes remotas dinamicamente, usando protocolos de roteamento, ou manualmente, usando rotas estáticas. Em muitos casos, os roteadores usam uma combinação de protocolos de roteamento dinâmico e rotas estáticas. Este capítulo se concentra no roteamento estático.</p> <p>As rotas estáticas são muito comuns e não exigem a mesma quantidade de processamento e sobrecarga, como veremos com os protocolos de roteamento dinâmico.</p> <p>Neste capítulo, acompanharemos um exemplo de topologia ao configurarmos rotas estáticas e aprenderemos técnicas para identificação e solução de problemas. No processo, examinaremos vários comandos essenciais do IOS e os resultados que eles exibem. Também apresentaremos a tabela de roteamento que usa redes diretamente conectadas e rotas estáticas.</p> <p>Enquanto você trabalha em meio às atividades do Packet Tracer associadas a esses comandos, reserve um momento para testar os comandos e examinar os resultados. Logo, ler as tabelas de roteamento se tornará algo automático.</p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0902010000">
<title><content-text>Roteadores e rede</content-text></title>
<topic type="" id="tl0902010100">
<title><content-text>Função do roteador</content-text></title>
<page type="OneColumn" id="tl0902010101">
<content-media type="StaticGraphic" id="cm5752858752"><title><content-text></content-text></title><media ref="tl0902000000/tl0902010000/tl0902010100/tl0902010101/cm5752858752.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902010000/tl0902010100/tl0902010101/cm5752858752text.xml"/></content-media>
<content-text><p><b>Função do roteador</b></p> <p>O roteador é um computador com uma finalidade especial que desempenha um papel fundamental no funcionamento de qualquer rede de dados. Os roteadores são os principais responsáveis por interconectar redes:</p> <ul><li> Determinando o melhor caminho para enviar pacotes </li> <li> Encaminhando pacotes para o destino</li></ul> <p>Os roteadores executam o encaminhamento de pacotes, aprendendo as redes remotas e mantendo informações de roteamento. O roteador é a junção ou a interseção que conecta várias redes IP. A decisão primária de encaminhamento dos roteadores se baseia nas informações de Camada 3, o endereço IP de destino. </p> <p>A tabela de roteamento do roteador é usada para localizar a melhor correspondência entre o IP de destino de um pacote e um endereço de rede na tabela de roteamento. A tabela de roteamento acabará determinando a interface de saída que deve encaminhar o pacote, e o roteador encapsulará esse pacote no quadro de enlace de dados apropriado a essa interface de saída.</p></content-text>
</page>
</topic>
<topic type="" id="tl0902010200">
<title><content-text>Apresentando a topologia</content-text></title>
<page type="OneColumn" id="tl0902010201">
<content-media type="StaticGraphic" id="cm8855462765"><title><content-text></content-text></title><media ref="tl0902000000/tl0902010000/tl0902010200/tl0902010201/cm8855462765.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902010000/tl0902010200/tl0902010201/cm8855462765text.xml"/></content-media>
<content-text><p><b>Apresentando a Topologia</b></p> <p>A figura mostra a topologia usada neste capítulo. A topologia consiste em três roteadores, rotulados R1, R2 e R3. Os roteadores R1 e R2 são conectados por um link WAN e os roteadores R2 e R3, por outro link WAN. Cada roteador é conectado a uma rede local Ethernet diferente, representada por um switch e um PC.</p> <p>Todos os roteadores desse exemplo são Cisco 1841. Um roteador Cisco 1841 tem as seguintes interfaces:</p> <ul><li>Duas interfaces FastEthernet: FastEthernet 0/0 e FastEthernet 0/1</li> <li> Duas interfaces seriais: Serial 0/0/0 e Serial0/0/1</li></ul> <p>As interfaces em seus roteadores podem variar em relação às do 1841, mas você deve ser capaz de acompanhar os comandos neste capítulo – com algumas modificações mínimas – e de concluir os laboratórios práticos. Além disso, como as atividades do Packet Tracer estão disponíveis ao longo da discussão do roteamento estático, você pode testar suas habilidades na medida em que elas forem apresentadas. O Laboratório 2.8.1, "Configuração básica de rota estática", reflete a topologia, as configurações e os comandos abordados neste capítulo.</p></content-text>
</page>
</topic>
<topic type="" id="tl0902010300">
<title><content-text>Examinando as conexões do roteador</content-text></title>
<page type="OneColumn" id="tl0902010301">
<content-media type="InteractiveGraphicHotspots" id="cm1194388007"><title><content-text></content-text></title><media ref="tl0902000000/tl0902010000/tl0902010300/tl0902010301/cm1194388007.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902010000/tl0902010300/tl0902010301/cm1194388007text.xml"/></content-media>
<content-text><p><b>Conexões do roteador</b></p> <p>Conectar um roteador a uma rede exige o acoplamento de um conector de interface do roteador a um conector de cabo. Como você pode ver na figura, os roteadores Cisco oferecem suporte a muitos tipos de conector diferentes.</p> <p><b>Conectores seriais</b></p> <p><b>Clique em 1 na figura.</b></p> <p>Em conexões WAN, os roteadores Cisco oferecem suporte aos padrões EIA/TIA-232, EIA/TIA-449, V.35, X.21 e EIA/TIA-530 para conexões seriais, como mostrado. Não é importante memorizar esses tipos de conexão. Apenas saiba que um roteador com uma porta DB-60 pode oferecer suporte a cinco padrões de cabeamento diferentes. Como há cinco tipos de cabo diferentes compatíveis com essa porta, às vezes ela é chamada de porta serial cinco em um. A outra extremidade do cabo serial é equipada com um conector apropriado a um dos cinco padrões possíveis. </p> <p><b>Nota</b>: A documentação do dispositivo ao qual você deseja se conectar deve indicar o padrão do dispositivo. </p> <p><b>Clique em 2 e 3 na figura.</b></p> <p>Os roteadores mais novos oferecem suporte à interface smart serial que permite o encaminhamento de mais dados em menos pinos de cabo. A extremidade serial do cabo smart serial é um conector de 26 pinos. Ele é muito menor que o conector DB-60 usado na conexão com uma porta serial cinco em um. Esses cabos de transição oferecem suporte aos mesmos cinco padrões seriais, estando disponíveis em configurações DTE ou DCE.</p> <p><b>Nota:</b> Para uma explicação completa de DTE e DCE, consulte o Laboratório 1.5.1, "Cabeamento de rede e configuração básica do roteador". </p> <p>Essas designações de cabo só são importantes para você ao configurar seu equipamento de laboratório para simular um ambiente "real". Em uma configuração de produção, o tipo de cabo é determinado para você pelo serviço WAN que você está usando.</p> <p><b>Conectores Ethernet</b></p> <p><b>Clique em 4 na figura.</b></p> <p>Um conector diferente é usado em um ambiente de rede local baseado em Ethernet. Um conector RJ-45 para o cabo de Par Trançado Não-Blindado(UTP, Unshielded Twisted-Pair) é o conector mais comumente usado na conexão de interfaces de rede local. Em cada extremidade de um cabo RJ-45, você deve conseguir ver oito faixas coloridas, ou pinos. Um cabo Ethernet usa pinos 1, 2, 3 e 6 na transmissão e no recebimento de dados. </p> <p>Dois tipos de cabos podem ser usados com interfaces de rede local Ethernet:</p> <ul><li> Um cabo straight-through (ou cabo direto), ou patch cable, com a mesma ordem dos pinos coloridos em cada extremidade do cabo</li> <li> Um cabo crossover (ou cabo cruzado), com o pino 1 conectado ao pino 3 e o pino 2 conectado ao pino 6</li></ul> <p>Os cabos straight-through são usados para:</p> <ul><li> Switch a roteador</li> <li> Switch a PC</li> <li> Hub a PC</li> <li> Hub a servidor</li></ul> <p>Os cabos crossover são usados para:</p> <ul><li> Switch a switch </li> <li> PC a PC </li> <li> Switch a hub</li> <li> Hub a hub</li> <li> Roteador a roteador</li> <li> Roteador a servidor</li></ul> <p><b>Nota:</b> A conectividade sem fio é abordada em outro curso.</p></content-text>
</page>
<page type="OneColumn" id="tl0902010302">
<content-media type="ActivityPKA" id="cm8107970031"><title><content-text></content-text></title><media ref="tl0902000000/tl0902010000/tl0902010300/tl0902010302/cm8107970031/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902010000/tl0902010300/tl0902010302/cm8107970031/icontext.xml"/></content-media>
<content-text><p>Use a atividade do Packet Tracer para criar a topologia que você usará durante o restante deste capítulo. Você adicionará todos os dispositivos necessários e os conectará usando o cabeamento correto.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0902020000">
<title><content-text>Revisão da configuração do roteador</content-text></title>
<topic type="" id="tl0902020100">
<title><content-text>Examinando interfaces de roteador</content-text></title>
<page type="OneColumn" id="tl0902020101">
<content-media type="InteractiveGraphicHotspots" id="cm5023387160"><title><content-text></content-text></title><media ref="tl0902000000/tl0902020000/tl0902020100/tl0902020101/cm5023387160.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902020000/tl0902020100/tl0902020101/cm5023387160text.xml"/></content-media>
<content-text><p><b>Examinando interfaces de roteador</b></p> <p>Como aprendemos no Capítulo 1, o comando <span class="cmd">show ip route</span> é usado para exibir a tabela de roteamento. Inicialmente, a tabela de roteamento permanecerá vazia se não houver nenhuma interface configurada. </p> <p>Como você pode ver na tabela de roteamento de R1, nenhuma interface foi configurada com um endereço IP e uma máscara de sub-rede. </p> <p><b>Nota:</b> As rotas estáticas e dinâmicas não serão adicionadas à tabela de roteamento até que as interfaces locais apropriadas, também conhecidas como as interfaces de saída, sejam configuradas no roteador. Esse procedimento será examinado mais atentamente nos próximos capítulos.</p>  <p><b>Interfaces e seus Status</b></p> <p>O status de cada interface pode ser examinado usando vários comandos. </p> <p><b>Clique em </b><span class="cmd"><b>show interfaces</b></span><b> na figura.</b></p>  <p>O comando <span class="cmd"><b>show interfaces</b></span> mostra o status e dá uma descrição detalhada de todas as interfaces no roteador. Como você pode ver, a saída do comando pode ser bem longa. Para exibir as mesmas informações, mas para uma interface específica, como FastEthernet 0/0, use o comando <span class="cmd"> <b>show interfaces</b></span> com um parâmetro que especifique a interface. Por exemplo: </p> <span class="cmd"><p>R1#<b>show interfaces fastethernet 0/0</b></p></span> <span class="cmd"><p>FastEthernet0/0 is <span class="blue">administratively down, line protocol is down</span></p></span> <p>Observe que a interface está <b>administratively down</b> e o <b>line protocol is down</b>. “Administratively down” (desativada administrativamente) significa que a interface está no modo desligado, ou desligada. “Line protocol is down” (Protocolo de linha está inativo) significa, nesse caso, que a interface não está recebendo um sinal de operadora de um switch ou do hub. Essa condição também pode existir devido ao fato de a interface estar no modo desligado (shutdown).</p>  <p>Você observará que o comando <span class="cmd"><b>show interfaces</b></span> não mostra nenhum endereço IP nas interfaces de R1. A razão disso é porque nós ainda não configuramos endereços IP em nenhuma das interfaces.</p>  <p><b>Comandos adicionais para examinar o status da interface</b></p>  <p><b>Clique em </b><span class="cmd"><b>show ip interface brief </b></span> <b>na figura.</b></p> <p></p> <p>O comando <span class="cmd"><b>show ip interface brief</b></span> pode ser usado para ver uma porção das informações de interface em um formato resumido. </p> <p><b>Clique em </b><span class="cmd"><b>show running-config</b></span><b> na figura.</b></p> <p>O comando <span class="cmd"><b>show running-config</b></span> exibe o arquivo de configuração atual usado pelo roteador. Os comandos de configuração são armazenados temporariamente no arquivo de configuração em execução e implementados imediatamente pelo roteador. Usar esse comando é outra forma de verificar o status de uma interface, como FastEthernet 0/0.</p> <span class="cmd"><p>R1#<b>show running-config</b></p></span> <span class="cmd"><p>&lt;parte da saída do comando omitida&gt;</p></span> <span class="cmd"><p>interface FastEthernet0/0</p></span> <span class="cmd"><p><span class="blue">no ip address</span></p></span> <span class="cmd"><p><span class="blue">shutdown</span></p></span> <span class="cmd"><p>&lt;parte da saída do comando omitida&gt;</p></span> <p>No entanto, usar <span class="cmd"><b>show running-config</b></span> não é necessariamente a melhor forma de verificar as configurações de interface. Use o comando <span class="cmd"><b>show ip interface brief</b></span> para verificar rapidamente se as interfaces estão <b>up </b>(ativas) e <b>up </b>(administrativamente <b>up </b>e o protocolo de linha está <b>up</b>).</p></content-text>
</page>
</topic>
<topic type="" id="tl0902020200">
<title><content-text>Configurando uma Interface Ethernet</content-text></title>
<page type="OneColumn" id="tl0902020201">
<content-media type="InteractiveGraphicHotspots" id="cm1048398155"><title><content-text></content-text></title><media ref="tl0902000000/tl0902020000/tl0902020200/tl0902020201/cm1048398155.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902020000/tl0902020200/tl0902020201/cm1048398155text.xml"/></content-media>
<content-text><p><b>Configurando uma interface Ethernet</b></p> <p>Como mostrado, R1 ainda não tem nenhuma rota. Adicionemos uma rota, configurando uma interface e exploremos o que acontece exatamente quando essa interface é ativada. Por padrão, todas as interfaces do roteador são <b>desligadas</b> (shutdown) ou desativadas. Para habilitar essa interface, use o comando <span class="cmd"><b>no shutdown</b> </span>, que altera a interface de <b>”administratively down”</b> para <b>”up”</b>.</p> <span class="cmd"><p>R1(config)#<b>interface fastethernet 0/0</b></p></span> <span class="cmd"><p>R1(config-if)#<b>ip address 172.16.3.1 255.255.255.0</b></p></span> <span class="cmd"><p>R1(config-if)#<b>no shutdown</b></p></span> <p>A seguinte mensagem retorna do IOS:</p> <span class="cmd"><p>*Mar 1 01:16:08.212: %LINK-3-UPDOWN: Interface FastEthernet0/0, <span class="blue">changed state to up</span></p></span> <span class="cmd"><p>*Mar 1 01:16:09.214: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet0/0, <span class="blue">changed state to up</span></p></span> <p>Ambas as mensagens são importantes. A primeira mensagem <b>changed state to up</b> indica que, fisicamente, a conexão está boa. Se você não obtiver essa primeira mensagem, certifique-se de que a interface esteja adequadamente conectada a um switch ou um hub.</p> <p><b>Nota: </b>Embora habilitada com <span class="cmd"><b>no shutdown</b></span>, uma interface Ethernet não permanecerá em funcionamento, ou <b>ativa</b>, a menos que esteja recebendo um sinal de operadora de outro dispositivo (switch, hub, PC ou outro roteador). </p> <p>A segunda mensagem “changed state to <b>up</b>” indica que a camada de enlace de dados está em funcionamento. Em interfaces de rede local, normalmente não alteramos os parâmetros da camada de enlace de dados. No entanto, as interfaces WAN em um ambiente de laboratório exigem a sincronização em um lado do link, como abordado no Laboratório 1.5.1, "Cabeamento de rede e configuração de roteador básica", bem como posteriormente na seção, "Configurando uma Interface Serial". Se você não definir corretamente o clock rate, o protocolo de linha (a camada de enlace de dados) <b>não será alterado para ativado</b>.</p> <p><b>Mensagens não solicitadas do IOS</b></p> <p><b>Clique em Mensagens não solicitadas do IOS na figura.</b></p> <p>O IOS costuma enviar mensagens não solicitadas semelhantes às mensagens <b>changed state to up</b> recém-abordadas. Como você pode ver na figura, às vezes, essas mensagens ocorrerão quando você estiver digitando um comando, como ao configurar uma descrição para a interface. A mensagem do IOS não afeta o comando, mas pode fazer com que você perca a localização na linha onde você estava digitando. </p> <p><b>Clique em Registrando em log síncrono na figura.</b></p> <p>Para manter a saída não solicitada separada da sua entrada, acesse o modo de configuração de linha da porta de console e adicione o comando <span class="cmd"><b>logging synchronous</b></span>, como mostrado. Você verá que as mensagens retornadas pelo IOS não interferem mais na sua digitação.</p></content-text>
</page>
<page type="OneColumn" id="tl0902020202">
<content-media type="StaticGraphic" id="cm1891083338"><title><content-text></content-text></title><media ref="tl0902000000/tl0902020000/tl0902020200/tl0902020202/cm1891083338.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902020000/tl0902020200/tl0902020202/cm1891083338text.xml"/></content-media>
<content-text><p><b>Lendo a tabela de roteamento</b></p> <p>Agora observe a tabela de roteamento mostrada na figura. Agora observe que R1 tem uma interface FastEthernet 0/0 "diretamente conectada" a uma nova rede. A interface foi configurada com o endereço IP 172.16.3.1/24, que faz dele um membro da rede 172.16.3.0/24.</p> <p>Examine a seguinte linha de saída da tabela:</p> <span class="cmd"><p>C 172.16.3.0 is directly connected, FastEthernet0/0</p></span> <p>O <b>C</b> no início de cada rota indica que se trata de uma rede conectada diretamente. Em outras palavras, R1 tem uma interface que pertence a essa rede. O significado de <b>C</b> é definido na lista de códigos na parte superior da tabela de roteamento.</p> <p>A máscara de sub-rede <b>/24</b> dessa rota é exibida na linha acima da rota real. </p> <span class="cmd"><p>172.16.0.0/24 is subnetted, 1 subnets</p></span> <span class="cmd"><p>C 172.16.3.0 is directly connected, FastEthernet0/0</p></span> <p><b>Roteadores normalmente armazenam endereços de rede</b></p> <p>Com raríssimas exceções, as tabelas de roteamento têm rotas para endereços de rede, e não endereços de host individuais. A rota 172.16.3.0/24 na tabela de roteamento significa que essa rota corresponde a todos os pacotes com um endereço de destino pertencente a essa rede. Ter uma única rota representando uma rede inteira de endereços IP de host diminui a tabela de roteamento, com menos rotas, o que resulta em pesquisas mais rápidas na tabela de roteamento. A tabela de roteamento pode conter todos os 254 endereços IP de host individuais para a rede 172.16.3.0/24, mas essa é uma forma ineficiente de armazenar endereços.</p> <p>Uma agenda telefônica é uma boa analogia para a estrutura de uma tabela de roteamento. Uma agenda telefônica é uma lista de nomes e números de telefone, classificados em ordem alfabética pelo sobrenome. Ao procurar um número, podemos supor que quanto menos nomes houver na lista, mais rápida será a localização de um determinado nome. Uma agenda telefônica com 20 páginas e talvez 2.000 entradas será muito mais fácil de pesquisar do que uma com 200 páginas e 20.000 entradas. </p> <p>A agenda só contém uma listagem para cada número de telefone. Por exemplo, a família Stanford pode ser listada como:</p> <p><b>Stanford, Harold, 742 Evergreen Terrace, 555-1234</b></p> <p>Essa é a única entrada para todos os que moram nesse endereço e têm o mesmo número de telefone. A agenda telefônica pode conter uma listagem para cada pessoa, mas isso aumentaria o tamanho da lista. Por exemplo, poderia haver uma listagem separada para Harold Stanford, Margaret Stanford, Brad Stanford, Leslie Stanford e Maggie Stanford – todos com o mesmo endereço e número de telefone. Se isso fosse feito com todas as famílias, a agenda telefônica seria muito maior e demoraria mais para pesquisá-la. </p> <p>As tabelas de roteamento funcionam da mesma forma: uma entrada na tabela representa uma "família" de dispositivos em que todos compartilham a mesma rede ou espaço de endereço (a diferença entre uma rede e um espaço de endereço será esclarecida na medida em que você avançar no curso). Quanto menos entradas houver na tabela de roteamento, mais rápido será o processo de pesquisa. Para manter as tabelas de roteamento menores, são listados endereços de rede com máscaras de sub-rede, e não endereços IP de host individuais.</p> <p><b>Nota: </b>Às vezes, uma "rota de host" é inserida na tabela de roteamento, o que representa um endereço IP de host individual. Ela é listada com o endereço IP de host do dispositivo e uma máscara de sub-rede /32 (255.255.255.255). O tópico das rotas de host é abordado em outro curso.</p></content-text>
</page>
</topic>
<topic type="" id="tl0902020300">
<title><content-text>Verificando a Interface Ethernet</content-text></title>
<page type="OneColumn" id="tl0902020301">
<content-media type="InteractiveGraphicHotspots" id="cm7397576153"><title><content-text></content-text></title><media ref="tl0902000000/tl0902020000/tl0902020300/tl0902020301/cm7397576153.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902020000/tl0902020300/tl0902020301/cm7397576153text.xml"/></content-media>
<content-text><p><b>Comandos para verificar a configuração da interface</b></p> <p>O comando <span class="cmd"><b>show interfaces fastethernet 0/0</b></span> na figura agora mostra que a interface está <b>”up”</b> e que o protocolo de linha está <b>”up”</b>. O comando <span class="cmd"><b>no shutdown</b></span> alterou a interface de <b>”administratively down”</b> para <b>”up”</b>. Observe que o endereço IP é exibido agora.</p> <p>Clique em <span class="cmd"><b>show ip interface brief</b></span> na figura.</p> <p>O comando <span class="cmd"><b>show ip interface brief</b></span> também é mostrado com a verificação dessas mesmas informações. Em status e protocolo, você deve ver "up".</p> <p>O comando <span class="cmd"><b>show running-config</b></span> mostra a configuração atual dessa interface. Quando a interface é desabilitada, o comando <span class="cmd"><b>running-config</b></span> exibe <span class="cmd"><b>shutdown</b></span>. No entanto, quando a interface é habilitada, <span class="cmd"><b>no shutdown</b></span> não é exibido. </p> <span class="cmd"><p>R1#<b>show running-config</b></p></span> <span class="cmd"><p>&lt;saída de comando omitida&gt;</p></span> <span class="cmd"><p>interface FastEthernet0/0</p></span> <span class="cmd"><p>ip address 172.16.3.1 255.255.255.0</p></span> <span class="cmd"><p>&lt;saída de comando omitida&gt;</p></span> <p>Como explicado no Capítulo 1, um roteador não pode ter várias interfaces pertences à mesma sub-rede IP. Cada interface deve pertencer a uma sub-rede separada. Por exemplo, um roteador não pode ter sua interface FastEthernet 0/0 configurada como o endereço e a máscara 172.16.3.1/24 e sua interface FastEthernet 0/1 configurada como 172.16.3.2/24. </p> <p>O IOS retornará a seguinte mensagem de erro se você tentar configurar a segunda interface com a mesma sub-rede IP como a primeira interface: </p> <span class="cmd"><p>R1(config-if)#<b>int fa0/1</b></p></span> <span class="cmd"><p>R1(config-if)<b>#ip address 172.16.3.2 255.255.255.0</b></p></span> <span class="cmd"><p><span class="blue">172.16.3.0 overlaps with FastEthernet0/0</span></p></span> <span class="cmd"><p>R1(config-if)#</p></span> <p>Normalmente, a interface Ethernet ou FastEthernet do roteador será o endereço IP do gateway padrão de qualquer dispositivo na rede local. Por exemplo, PC1 seria configurado com um endereço IP de host pertencente à rede 172.16.3.0/24, com o endereço IP de gateway padrão 172.16.3.1. 172.16.3.1 é o endereço IP da FastEthernet do roteador R1. Lembre-se de que a interface Ethernet ou FastEthernet de um roteador também participará do processo ARP como membro da rede Ethernet.</p></content-text>
</page>
<page type="OneColumn" id="tl0902020302">
<content-media type="StaticGraphic" id="cm9849595011"><title><content-text></content-text></title><media ref="tl0902000000/tl0902020000/tl0902020300/tl0902020302/cm9849595011.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902020000/tl0902020300/tl0902020302/cm9849595011text.xml"/></content-media>
<content-text><p><b>Interfaces Ethernet participam de ARP</b></p> <p>A interface Ethernet de um roteador participa de uma rede local assim como qualquer outro dispositivo na rede. Isso significa que essas interfaces têm um endereço MAC de Camada 2, como mostra a figura. O comando <span class="cmd"><b>show interfaces</b></span> exibe o endereço MAC das interfaces Ethernet.</p> <span class="cmd"><p>R1#<b>show interfaces fastethernet 0/0</b></p></span> <p>Como demonstrado no Capítulo 1, uma interface Ethernet participa de solicitações e respostas ARP, além de manter uma tabela ARP. Se um roteador tiver um pacote com destino a um dispositivo em uma rede Ethernet conectada diretamente, ele verificará a tabela ARP em busca de uma entrada com esse endereço IP de destino a fim de mapeá-la para o endereço MAC. Se a tabela ARP não contiver esse endereço IP, a interface Ethernet enviará uma solicitação ARP. O dispositivo com o endereço IP de destino retorna uma resposta ARP que lista seu endereço MAC. Em seguida, as informações dos endereços IP e MAC são adicionadas à tabela ARP dessa interface Ethernet. Agora o roteador consegue encapsular o pacote IP em um quadro Ethernet com o endereço MAC de destino da sua tabela ARP. Em seguida, o quadro Ethernet, com o pacote encapsulado, é enviado pela interface Ethernet.</p></content-text>
</page>
<page type="OneColumn" id="tl0902020303">
<content-media type="ActivityPKA" id="cm2918706651"><title><content-text></content-text></title><media ref="tl0902000000/tl0902020000/tl0902020300/tl0902020303/cm2918706651/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902020000/tl0902020300/tl0902020303/cm2918706651/icontext.xml" /></content-media>
<content-text><p>Use a atividade do Packet Tracer para praticar a configuração das interfaces Ethernet. Siga as instruções adicionais fornecidas na atividade para examinar o processo ARP no modo de simulação.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl0902020400">
<title><content-text>Configurando uma Interface Serial</content-text></title>
<page type="OneColumn" id="tl0902020401">
<content-media type="StaticGraphic" id="cm9138951276"><title><content-text></content-text></title><media ref="tl0902000000/tl0902020000/tl0902020400/tl0902020401/cm9138951276.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902020000/tl0902020400/tl0902020401/cm9138951276text.xml"/></content-media>
<content-text><p><b>Configurando uma interface serial</b></p> <p>Em seguida, configuremos a interface Serial 0/0/0 no roteador R1. Essa interface está na rede 172.16.2.0/24, com o endereço IP e a máscara de sub-rede 172.16.2.1/24 atribuídos. O processo que usamos para a configuração da interface serial 0/0/0 é semelhante ao processo que costumávamos usar para configurar a interface FastEthernet 0/0.</p> <span class="cmd"><p>R1(config)#<b>interface serial 0/0/0</b></p></span> <span class="cmd"><p>R1(config-if)#<b>ip address 172.16.2.1 255.255.255.0</b></p></span> <span class="cmd"><p>R1(config-if)#<b>no shutdown</b></p></span> <p>Depois de inserir os comandos acima, o estado da interface serial pode variar de acordo com o tipo de conexão WAN. Isso será abordado com mais detalhes em um curso posterior. Neste curso, usaremos conexões ponto-a-ponto seriais dedicadas entre dois roteadores. A interface serial só ficará <b>”up”</b> depois que a outra extremidade do link serial também for configurada corretamente. Podemos exibir o estado atual de serial 0/0/0 usando o comando <span class="cmd"><b>show interfaces serial 0/0/0</b></span>, como mostrada na figura.</p> <p>Como você pode ver, o link ainda está ”down” (desativado). O link está ”down” porque ainda não configuramos e habilitamos a outra extremidade do link serial.</p> <span class="cmd"><p>R1#<b>show interfaces serial 0/0/0</b></p></span> <span class="cmd"><p>Serial0/0/0 is administratively <span class="blue">down</span>, line protocol is <span class="blue">down</span></p></span> <p>Agora configuraremos a outra extremidade desse link, Serial 0/0/0, para o roteador R2. </p> <p><b>Nota: </b>Não há nenhum requisito de que ambas as extremidades do link serial usem a mesma interface, nesse caso, Serial 0/0/0. No entanto, como as interfaces são membros da mesma rede, elas devem ter endereços IP pertencentes à rede 172.16.2.0/24. (Os termos <i>rede</i> e <i>sub-rede</i> podem ser usados alternadamente nesse caso.) A interface Serial 0/0/0 de R2 é configurada com o endereço IP e a máscara de sub-rede 172.16.2.2/24.</p> <span class="cmd"><p>R2(config)#<b>interface serial 0/0/0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>ip address 172.16.2.2 255.255.255.0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>no shutdown</b></p></span> <p>Se agora emitirmos o comando <span class="cmd"><b>show interfaces serial 0/0/0</b></span> em um dos roteadores, continuaremos vendo que o link está <b>”up/down”</b>. </p> <span class="cmd"><p>R2#<b>show interfaces serial 0/0/0</b></p></span> <span class="cmd"><p>Serial0/0/0 is <span class="blue">up</span>, line protocol is <span class="blue">down</span></p></span> <span class="cmd"><p>&lt;saída de comando omitida&gt;</p></span> <p>O link físico entre R1 e R2 está <b>”up”</b> porque ambas as extremidades do link serial foram configuradas corretamente com um endereço IP/máscara e habilitadas com o comando <span class="cmd"><b>no shutdown</b></span>. No entanto, o protocolo de linha ainda está <b>”down”</b>. Isso porque a interface não está recebendo um sinal de clock. Ainda há um mais comando que precisamos inserir, o comando <span class="cmd"><b>clock rate</b></span>, no roteador com o cabo DCE. O comando <span class="cmd"><b>clock rate</b></span> definirá o sinal de clock do link. A configuração do sinal de clock será abordado na próxima seção.</p></content-text>
</page>
</topic>
<topic type="" id="tl0902020500">
<title><content-text>Examinando interfaces de roteador</content-text></title>
<page type="OneColumn" id="tl0902020501">
<content-media type="StaticGraphic" id="cm6612899463"><title><content-text></content-text></title><media ref="tl0902000000/tl0902020000/tl0902020500/tl0902020501/cm6612899463.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902020000/tl0902020500/tl0902020501/cm6612899463text.xml"/></content-media>
<content-text><p><b>Conectando uma interface WAN fisicamente</b></p> <p>A camada física WAN descreve a interface entre o Equipamento de terminal de dados (DTE, Data Terminal Equipment) e o Equipamento de comunicação de dados( DCE, Data Circuit-terminating Equipment). Normalmente, DCE é a operadora e DTE, o dispositivo conectado. Nesse modelo, os serviços oferecidos ao DTE são disponibilizados por um modem ou uma CSU/DSU.</p> <p>Normalmente, o roteador é o dispositivo DTE, estando conectado a uma CSU/DSU, que é o dispositivo DCE. A CSU/DSU (dispositivo DCE) é usada para converter os dados do roteador (dispositivo DTE) em uma forma aceitável para a operadora WAN. A CSU/DSU (dispositivo DCE) também é responsável por converter os dados da operadora WAN em uma forma aceitável pelo roteador (dispositivo DTE). O roteador costuma ser conectado à CSU/DSU usando um cabo serial DTE, conforme mostrado. </p> <p><b>As interfaces seriais exigem um sinal de clock para controlar o timing da comunicação</b>. Na maioria dos ambientes, a operadora (um dispositivo DCE, como uma CSU/DSU) fornecerá o clock. Por padrão, roteadores Cisco são dispositivos DTE. No entanto, em um ambiente de laboratório, não usamos nenhuma CSU/DSU e, obviamente, não temos uma operadora WAN. </p> <p><b>Passe o mouse sobre os cabos e os dispositivos na figura para ver quais são eles.</b></p></content-text>
</page>
<page type="OneColumn" id="tl0902020502">
<content-media type="InteractiveGraphicHotspots" id="cm9991825749"><title><content-text></content-text></title><media ref="tl0902000000/tl0902020000/tl0902020500/tl0902020502/cm9991825749.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902020000/tl0902020500/tl0902020502/cm9991825749text.xml"/></content-media>
<content-text><p><b>Configurando links seriais em um ambiente de laboratório</b></p> <p>Em links seriais interconectados diretamente, como em um ambiente de laboratório, um lado de uma conexão deve ser considerado um DCE e fornecer um sinal de clock. Embora as interfaces seriais Cisco sejam dispositivos DTE por padrão, elas podem ser configuradas como dispositivos DCE.</p> <p>Para configurar um roteador como dispositivo DCE:</p> <p>1. Conecte a extremidade DCE do cabo à interface serial.</p> <p>2. Configure o sinal de clock na interface serial usando o comando <span class="cmd"><b>clock rate</b></span>.</p> <p>Os cabos seriais usados no laboratório costumam ser de dois tipos. </p> <ul><li> Um cabo crossover DTE/DCE no qual uma extremidade é DTE e a outra, DCE</li> <li> Um cabo DTE conectado a um cabo DCE</li></ul> <p>Em nossa topologia de laboratório, a interface Serial 0/0/0 em R1 é conectada à extremidade DCE do cabo e a interface serial 0/0/0 em R2 é conectada à extremidade DTE do cabo. O cabo deve ser rotulado como DTE ou DCE. </p> <p>Você também pode diferenciar DTE de DCE, observando o conector entre os dois cabos. O cabo DTE tem um conector macho e o cabo DCE, um conector fêmea.</p> <p>Se um cabo for conectado entre os dois roteadores, você poderá usar o comando <span class="cmd"><b>show controllers</b></span> para determinar que extremidade do cabo está acoplada a essa interface. Na saída do comando, observe que R1 tem o cabo DCE conectado à sua interface serial 0/0 e que não há nenhum clock rate definido. </p> <span class="cmd"><p>R1#<b>show controllers serial 0/0/0</b></p></span> <span class="cmd"><p>Interface Serial0/0/0</p></span> <span class="cmd"><p>Hardware is PowerQUICC <span class="blue">MPC860</span></p></span> <span class="cmd"><p><span class="blue">DCE V.35</span>, no clock</p></span> <span class="cmd"><p>&lt;saída de comando omitida&gt;</p></span> <p>Quando o cabo for conectado, o clock poderá ser definido com o comando <span class="cmd"><b>clock rate</b></span>. Os clock rates disponíveis, em bits por segundo, são 1200, 2400, 9600, 19200, 38400, 56000, 64000, 72000, 125000, 148000, 500000, 800000, 1000000, 1300000, 2000000 e 4000000. Algumas taxas de bit talvez não estejam disponíveis em determinadas interfaces seriais. Como a interface Serial 0/0/0 em R1 tem o cabo DCE acoplado, configuraremos a interface com um clock rate. </p> <span class="cmd"><p>R1(config)#<b>interface serial 0/0/0</b></p></span> <span class="cmd"><p>R1(config-if)#<b>clock rate 64000</b></p></span> <span class="cmd"><p>01:10:28: %LINEPROTO-5-UPDOWN: Line protocol on Interface Serial0/0/0, changed state to up</p></span> <p><b>Nota:</b> Se a interface de um roteador com um cabo DTE for configurada com o comando clock rate, o IOS desconsiderará o comando, não havendo nenhum efeito colateral.</p></content-text>
</page>
<page type="OneColumn" id="tl0902020503">
<content-media type="StaticGraphic" id="cm8645466049"><title><content-text></content-text></title><media ref="tl0902000000/tl0902020000/tl0902020500/tl0902020503/cm8645466049.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902020000/tl0902020500/tl0902020503/cm8645466049text.xml"/></content-media>
<content-text><p><b>Verificando a configuração de interface serial</b></p> <p>Como você pode ver na figura, podemos determinar que o protocolo de linha agora está ativado e verificar isso em ambas as extremidades do link serial, usando os comandos <span class="cmd"><b>show interfaces</b></span> e <span class="cmd"><b>show ip interface brief</b></span>. Lembre-se de que a interface serial só estará ativa se ambas as extremidades do link forem configuradas corretamente. Em nosso ambiente de laboratório, configuramos o clock rate na extremidade com o cabo DCE.</p> <p>Ainda podemos verificar se o link está ”up/up” executando ping na interface remota.</p> <span class="cmd"><p>R1#<b>ping 172.16.2.2</b></p></span> <p>Por fim, podemos ver a rede serial 172.16.2.0/24 nas tabelas de roteamento de ambos os roteadores. Se emitirmos o comando <span class="cmd"><b>show ip route</b></span> em R1, veremos a rota conectada diretamente da rede 172.16.2.0/24.</p> <span class="cmd"><p>R1#<b>show ip route</b></p></span> <p>Agora observemos uma configuração em execução do roteador R1 usando o comando <span class="cmd"><b>show running-config</b></span>. </p> <span class="cmd"><p>R1#<b>show running-config</b></p></span> <p><b>Nota</b>: Embora o comando <span class="cmd"><b>clock rate</b></span> tenha duas palavras, o IOS indica <b>clockrate </b>como uma única palavra nos arquivos de configuração em execução e de inicialização.</p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0902030000">
<title><content-text>Explorando redes diretamente conectadas</content-text></title>
<topic type="" id="tl0902030100">
<title><content-text>Verificando alterações feitas na tabela de roteamento</content-text></title>
<page type="OneColumn" id="tl0902030101">
<content-media type="StaticGraphic" id="cm8922664555"><title><content-text></content-text></title><media ref="tl0902000000/tl0902030000/tl0902030100/tl0902030101/cm8922664555.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902030000/tl0902030100/tl0902030101/cm8922664555text.xml"/></content-media>
<content-text><p><b>Conceitos da tabela de roteamento</b></p> <p>Como você pode ver na figura, o comando <span class="cmd"><b>show ip route</b></span> revela o conteúdo da tabela de roteamento. Revisemos a finalidade de uma tabela de roteamento. Uma tabela de roteamento é uma estrutura de dados usada para armazenar informações de roteamento adquiridas de origens diferentes. A principal finalidade de uma tabela de roteamento é fornecer ao roteador caminhos para redes de destino diferentes. </p> <p>A tabela de roteamento consiste em uma lista de endereços de rede "conhecidos" – ou seja, os endereços conectados diretamente, configurados estaticamente e aprendidos dinamicamente. R1 e R2 só têm rotas para redes diretamente conectadas. </p> <p> </p></content-text>
</page>
<page type="OneColumn" id="tl0902030102">
<content-media type="StaticGraphic" id="cm6964272567"><title><content-text></content-text></title><media ref="tl0902000000/tl0902030000/tl0902030100/tl0902030102/cm6964272567.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902030000/tl0902030100/tl0902030102/cm6964272567text.xml"/></content-media>
<content-text><p><b>Observando rotas enquanto elas são adicionadas à tabela de roteamento</b></p> <p>Agora observaremos mais atentamente a forma como as rotas diretamente conectadas são adicionadas e excluídas da tabela de roteamento. Ao contrário dos comandos <span class="cmd"><b>show</b></span>, os comandos <span class="cmd"><b>debug</b></span> podem ser usados para monitorar operações de roteador em tempo real. O comando <span class="cmd"><b>debug ip routing</b></span> nos permitirá ver qualquer alteração feita pelo roteador ao adicionar ou remover rotas. Configuraremos as interfaces no roteador de R2 e examinaremos esse processo.</p> <p>Primeiro, habilitaremos a depuração com o comando <span class="cmd"><b>debug ip routing</b></span> para que possamos ver as redes diretamente conectadas quando elas forem adicionadas à tabela de roteamento.</p> <span class="cmd"><p>R2#<b>debug ip routing</b></p></span> <span class="cmd"><p>IP routing debugging is on</p></span> <p><b>Configurando o endereço IP e a máscara de sub-rede</b></p> <p>Em seguida, configuraremos o endereço IP e a máscara de sub-rede para a interface FastEthernet 0/0 em R2 e usaremos o comando <span class="cmd"><b>no shutdown</b></span>. Como a interface FastEthernet se conecta à rede 172.16.1.0/24, ela deve ser configurada com um endereço IP de host dessa rede.</p> <span class="cmd"><p>R2(config)#<b>interface fastethernet 0/0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>ip address 172.16.1.1 255.255.255.0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>no shutdown</b></p></span> <p>A seguinte mensagem retornará do IOS:</p> <span class="cmd"><p>02:35:30: %LINK-3-UPDOWN: Interface FastEthernet0/0, changed state to <span class="blue">up</span></p></span> <span class="cmd"><p>02:35:31: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet0/0, changed state to <span class="blue">up</span></p></span> <p>Depois que o comando <span class="cmd"><b>no shutdown</b></span> for inserido e o roteador determinar que a interface e o protocolo de linha estão no estado <b>”up”</b> e <b>“up”</b>, a saída do comando de depuração mostrará R2 adicionando a rede conectada diretamente à tabela de roteamento.</p> <span class="cmd"><p>02:35:30: RT: add 172.16.1.0/24 via 0.0.0.0, connected metric [0/0]</p></span> <span class="cmd"><p>02:35:30: RT: <span class="blue">interface FastEthernet0/0 added to routing table</span></p></span> <p><b>Clique na Tabela de roteamento 1 na figura.</b></p> <p>A tabela de roteamento agora mostra a rota da rede conectada diretamente 172.16.1.0/24, como visto na figura.</p> <p>O comando <span class="cmd"><b>debug ip routing</b></span> exibe processos da tabela de roteamento para qualquer rota, independentemente da rota ser uma rede conectada diretamente, uma rota estática ou uma rota dinâmica.</p> <p><b>Clique em Desabilitar depuração na figura.</b></p> <p>Desabilite <span class="cmd"><b>debug ip routing</b></span> usando o comando <span class="cmd"><b>undebug ip routing</b></span> ou o comando <span class="cmd"><b>undebug all</b></span>.</p> <p><b>Alterando um endereço IP</b></p> <p>Para alterar um endereço IP ou uma máscara de sub-rede de uma interface, reconfigure o endereço IP e a máscara de sub-rede da interface. Essa alteração substituirá a entrada anterior. Há formas de configurar uma única interface com vários endereços IP, desde que cada endereço esteja em uma sub-rede diferente. Esse tópico será abordado em um curso posterior.</p> <p>Para remover uma rede conectada diretamente de um roteador, use estes dois comandos: <span class="cmd"><b>shutdown</b></span> e <span class="cmd"><b>no ip address</b></span>.</p> <p>O comando <span class="cmd"><b>shutdown</b></span> é usado para desabilitar interfaces. Esse comando pode ser usado sozinho caso você queira manter a configuração de endereço IP/máscara na interface, mas quiser desativá-la temporariamente. Em nosso exemplo, esse comando desabilitará a interface FastEtherent de R2. No entanto, o endereço IP continuará no arquivo de configuração, <b>running-config</b>. </p> <p>Depois que o comando <span class="cmd"><b>shutdown</b></span> for usado, você poderá remover o endereço IP e a máscara de sub-rede da interface. A ordem na qual você executa esses dois comandos não importa.</p> <p><b>Clique em Depuração 2 na figura.</b></p> <p>Usando <span class="cmd"><b>debug ip routing</b></span>, podemos ver o processo da tabela de roteamento, e excluiremos a configuração da interface FastEthernet 0/0 de R2.</p> <span class="cmd"><p>R2(config)#<b>interface fastethernet 0/0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>shutdown</b></p></span> <p>Podemos ver o processo da tabela de roteamento, removendo a rota conectada diretamente.</p> <span class="cmd"><p>02:53:58: RT:<span class="blue"> interface FastEthernet0/0 removed from routing table</span></p></span> <span class="cmd"><p>02:53:58: RT: del 172.16.1.0/24 via 0.0.0.0, connected metric [0/0]</p></span> <span class="cmd"><p>02:53:58: RT: <span class="blue">delete subnet route to 172.16.1.0/24</span></p></span> <p>O IOS também indica que a interface e o protocolo de linha agora estão <b>”down”</b>:</p> <span class="cmd"><p>02:54:00: %LINK-5-CHANGED: Interface FastEthernet0/0, changed state to administratively <span class="blue">down</span></p></span> <span class="cmd"><p>02:54:01: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet0/0, changed state to <span class="blue">down</span></p></span> <p> </p> <p>Agora removeremos o endereço IP na interface.</p> <span class="cmd"><p>R2(config-if)#<b>no ip address</b></p></span> <p>Desabilite a depuração:</p> <span class="cmd"><p>R2#<b>undebug all</b></p></span> <span class="cmd"><p>Toda a depuração possível foi desativada</p></span> <p><b>Clique na Tabela de roteamento 2 na figura.</b></p> <p>Para verificar se a rota foi removida da tabela de roteamento, usamos o comando <b><span class="cmd">show ip route</span></b>. Observe que a rota para 172.16.1.0/24 foi removida.</p> <p><b>Reconfigurando a interface para prosseguir com o capítulo.</b></p> <p>Tendo em vista o restante deste capítulo, partiremos do pressuposto de que o endereçamento de FastEthernet 0/0 não foi removido. Para reconfigurar a interface, basta inserir novamente os comandos:</p> <span class="cmd"><p>R2(config)#<b>interface fastethernet 0/0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>ip address 172.16.1.1 255.255.255.0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>no shutdown</b></p></span> <p><b>AVISO:</b> Os comandos de depuração, especialmente o comando <span class="cmd"><b>debug all</b></span>, devem ser usados com moderação. Esses comandos podem interromper operações de roteador. Os comandos de depuração são úteis durante a configuração ou a identificação e solução de problemas de uma rede. No entanto, eles podem usar muito a CPU e os recursos de memória. É recomendável que você execute o mínimo necessário de processos de depuração e os desabilite imediatamente quando eles deixarem de ser necessários. Os comandos de depuração devem ser usados com cuidado em redes de produção porque eles podem afetar o desempenho do dispositivo. </p></content-text>
</page>
<page type="OneColumn" id="tl0902030103">
<content-media type="ActivityPKA" id="cm1541781751"><title><content-text></content-text></title><media ref="tl0902000000/tl0902030000/tl0902030100/tl0902030103/cm1541781751/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902030000/tl0902030100/tl0902030103/cm1541781751/icontext.xml"/></content-media>
<content-text><p>Use a atividade do Packet Tracer para testar a configuração das interfaces seriais. Você também usará <span class="cmd"><b>debug ip routing</b></span> para observar os processos da tabela de roteamento.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl0902030200">
<title><content-text>Dispositivos em redes diretamente conectadas</content-text></title>
<page type="OneColumn" id="tl0902030201">
<content-media type="InteractiveGraphicHotspots" id="cm6511590538"><title><content-text></content-text></title><media ref="tl0902000000/tl0902030000/tl0902030200/tl0902030201/cm6511590538.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902030000/tl0902030200/tl0902030201/cm6511590538text.xml"/></content-media>
<content-text><p><b>Acessando dispositivos em redes diretamente conectadas</b></p> <p>Para restaurar a nossa configuração no exemplo de topologia, partiremos do pressuposto de que agora todas as redes diretamente conectadas sejam configuradas para todos os três roteadores. A figura mostra as demais configurações dos roteadores R2 e R3.</p> <p><b>Clique em </b><span class="cmd"><b>show ip interface brief </b></span> <b>na figura.</b></p> <p>A saída nesta figura atesta que todas as interfaces configuradas estão <b>”up" </b>e <b>”up"</b>.</p> <p><b>Clique em </b><span class="cmd"><b>show ip route </b></span> <b>na figura.</b></p> <p>Revisando as tabelas de roteamento na figura, podemos verificar se todas as redes diretamente conectadas estão instaladas para roteamento.</p>  <p>A etapa essencial da configuração da sua rede é verificar se todas as interfaces estão "up" e "up" e se as tabelas de roteamento estão completas. Independentemente do esquema de roteamento que você acabar configurando – estático, dinâmico ou uma combinação de ambos –, verifique suas configurações de rede iniciais usando os comandos <span class="cmd"><b>show ip interface brief</b></span> e <span class="cmd"><b>show ip route</b></span> antes de continuar com configurações mais complexas.</p>  <p>Quando um roteador só tem suas interfaces configuradas e a tabela de roteamento contém as redes diretamente conectadas, mas nenhuma outra, apenas os dispositivos nessas redes diretamente conectadas são alcançáveis. </p> <ul><li> R1 pode se comunicar com qualquer dispositivo nas redes 172.16.3.0/24 e 172.16.2.0/24.</li> <li> R2 pode se comunicar com qualquer dispositivo nas redes 172.16.1.0/24, 172.16.2.0/24 e 192.168.1.0/24.</li> <li> R3 pode se comunicar com qualquer dispositivo nas redes 192.168.1.0/24 e 192.168.2.0/24.</li></ul>  <p>Como esses roteadores só conhecem suas redes diretamente conectadas, os roteadores só podem se comunicar com esses dispositivos em suas próprias redes locais diretamente conectadas e nas redes seriais. </p> <p>Por exemplo, PC1 na topologia foi configurado com o endereço IP 172.16.3.10 e a máscara de sub-rede 255.255.255.0. PC1 também foi configurado com o endereço IP 172.16.3.1 de gateway padrão, que é o endereço IP da interface FastEthernet 0/0 do roteador. Como R1 só conhece as redes diretamente conectadas, ele pode encaminhar pacotes de PC1 para dispositivos na rede 172.16.2.0/24, como 172.16.2.1 e 172.16.2.2. Os pacotes de PC1 com qualquer outro endereço IP de destino, como PC2 em 172.16.1.10, seriam descartados por R1.</p> <p>Observemos a tabela de roteamento de R2 na figura. R2 só conhece suas três redes diretamente conectadas. Tente prever o que acontecerá se nós executarmos ping em uma das interfaces FastEthernet em um dos outros roteadores.</p> <p><b>Clique em <span class="cmd">ping</span> na figura.</b></p> <p>Observe que há falha nos pings, como indicado pela série de cinco pontos. Houve falha porque R2 não tem uma rota em sua tabela de roteamento correspondente a 172.16.3.1 ou 192.168.2.1, que é o endereço IP de destino do pacote de ping. Para que haja uma correspondência entre o endereço IP de destino do pacote 172.16.3.1 e uma rota na tabela de roteamento, o endereço deve corresponder ao número de bits à esquerda do endereço de rede, como indicado pelo prefixo da rota. Em R2, todas as rotas têm um prefixo /24, logo, os 24 bits à esquerda são verificados para cada rota.</p></content-text>
</page>
<page type="OneColumn" id="tl0902030202">
<content-media type="AnimationPartialScreen" id="cm3706041267"><title><content-text></content-text></title><media ref="tl0902000000/tl0902030000/tl0902030200/tl0902030202/cm3706041267.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902030000/tl0902030200/tl0902030202/cm3706041267text.xml"/></content-media>
<content-text><p><b>Verificando todas as rotas uma por uma</b></p> <p>A primeira rota na tabela para R1 é 172.16.1.0/24.</p> <span class="cmd"><p>172.16.0.0/24 is subnetted, 2 subnets</p></span> <span class="cmd"><p>C 172.16.1.0 is directly connected, FastEthernet0/0</p></span> <p>O processo da tabela de roteamento do IOS verifica se os 24 bits à esquerda do endereço IP de destino do pacote, 172.16.3.1, correspondem à rede 172.16.1.0/24. </p> <p><b>Reproduza a primeira animação na figura.</b></p> <p>Se converter esses endereços em binário e compará-los, como mostrado na animação, você verá que os primeiros 24 bits dessa rota não são correspondentes porque o 23º bit não corresponde. Portanto, essa rota é rejeitada.</p> <span class="cmd"><p> 172.16.0.0/<span class="blue">24 </span>is subnetted, 2 subnets</p></span> <span class="cmd"><p>C 172.16.2.0 is directly connected, Serial0/0/0</p></span> <p>Na animação, vimos que os primeiros 24 bits da segunda rota não são correspondentes porque o 24 bit não corresponde. Portanto, essa rota também é rejeitada, e o processo passa para a próxima rota na tabela de roteamento.</p> <span class="cmd"><p>C 192.168.1.0/<span class="blue">24 </span>is directly connected, Serial0/0/1</p></span> <p>A terceira rota também não é uma correspondência. Como mostrado, 10 dos primeiros 24 bits não são correspondentes. Portanto, essa rota é rejeitada. Como não há mais nenhuma rota na tabela de roteamento, os pings são descartados. O roteador toma sua decisão de encaminhamento na Camada 3, um "melhor esforço" para encaminhar o pacote, mas não dá nenhuma garantia.</p> <p><b>Clique em Pings são enviados para R3 na figura e reproduza a animação.</b></p> <p>Observemos a segunda animação para ver o que acontecerá se o roteador R2 executar ping na interface 192.168.1.1 no Roteador R3.</p> <p>Agora há êxito no ping! Há êxito porque R2 tem uma rota em sua tabela de roteamento correspondente a 192.168.1.1, que é o endereço IP de destino do pacote de ping. As duas primeiras rotas, 172.16.1.0/24 e 172.16.2.0/24, são rejeitadas. Mas a última rota, 192.168.1.0/24, corresponde aos primeiros 24 bits do endereço IP de destino. O pacote de ping é encapsulado no protocolo HDLC da Camada 2 de Serial0/0/1, a interface de saída, e encaminhado pela interface Serial0/0/1. Agora R2 toma as decisões de encaminhamento quanto a esse pacote. As decisões tomadas por outros roteadores referentes a esse pacote não são uma preocupação.</p> <p><b>Nota:</b> O processo de pesquisa da tabela de roteamento será abordado com mais detalhes no Capítulo 8, "A tabela de roteamento: Um exame mais detalhado".</p></content-text>
</page>
<page type="OneColumn" id="tl0902030203">
<content-media type="ActivityPKA" id="cm5876133420"><title><content-text></content-text></title><media ref="tl0902000000/tl0902030000/tl0902030200/tl0902030203/cm5876133420/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902030000/tl0902030200/tl0902030203/cm5876133420/icontext.xml"/></content-media>
<content-text><p>Use a atividade do Packet Tracer para testar a conectividade entre dispositivos conectados diretamente.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl0902030300">
<title><content-text>Protocolo CDP (Cisco Discovery Protocol)</content-text></title>
<page type="OneColumn" id="tl0902030301">
<content-media type="StaticGraphic" id="cm1748284186"><title><content-text></content-text></title><media ref="tl0902000000/tl0902030000/tl0902030300/tl0902030301/cm1748284186.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902030000/tl0902030300/tl0902030301/cm1748284186text.xml"/></content-media>
<content-text><p><b>Detecção de rede com CDP</b></p> <p>CDP é uma ferramenta eficiente para o monitoramento, identificação e solução de problemas de rede. CDP é uma ferramenta que reúne informações usada por administradores de rede para obter informações sobre dispositivos Cisco conectados diretamente. CDP é uma ferramenta própria que permite acessar um resumo das informações de protocolo e de endereço sobre dispositivos Cisco conectados diretamente. Por padrão, cada dispositivo Cisco envia mensagens periódicas, conhecidas como anúncios CDP, para dispositivos Cisco conectados diretamente. Esses anúncios contêm informações como os tipos de dispositivos conectados, as interface de roteador a que estão conectados, as interfaces usadas para estabelecer as conexões e os números de modelo dos dispositivos.</p> <p>A maioria dos dispositivos de rede, por definição, não funciona isolada. Um dispositivo Cisco normalmente tem outros dispositivos Cisco como seus vizinhos na rede. Informações obtidas de outros dispositivos podem ajudar a tomar decisões de design de rede, identificar e solucionar problemas e fazer alterações no equipamento. CDP pode ser usado como uma ferramenta de detecção de rede, ajudando a criar uma topologia lógica de uma rede quando não houver essa documentação ou faltar detalhes. </p> <p>A familiaridade com o conceito geral de <i>vizinhos</i> é importante para compreender o CDP, bem como para discussões futuras sobre protocolos de roteamento dinâmico.</p> <p><b>Vizinhos de Camada 3</b></p> <p>Neste ponto da configuração da nossa topologia, só temos os vizinhos conectados diretamente. Na Camada 3, os protocolos de roteamento consideram os <i>vizinhos</i> dispositivos que compartilham o mesmo espaço de endereço da rede. </p> <p>Por exemplo, R1 e R2 são vizinhos. Ambos são os membros da rede 172.16.1.0/24. R2 e R3 também são vizinhos porque compartilham a rede 192.168.1.0/24. Mas R1 e R3 não são <i>vizinhos</i> porque não compartilham nenhum espaço de endereço da rede. Se conectássemos R1 e R3 usando um cabo e configurássemos cada um com um endereço IP da mesma rede, eles seriam vizinhos.</p> <p><b>Vizinhos de Camada 2</b></p> <p>O CDP só funciona na Camada 2. Por isso, os vizinhos CDP são dispositivos Cisco conectados direta e fisicamente e que compartilham o mesmo vínculo de dados. Na figura do protocolo CDP, o administrador de rede fez o login em S3. S3 só receberá anúncios CDP de S1, S2 e R2.</p> <p>Pressupondo que todos os roteadores e switches na figura sejam dispositivos Cisco com o CDP em execução, que vizinhos R1 teria? Você pode determinar os vizinhos CDP de cada dispositivo?</p> <p><b>Clique no botão Topologia na figura.</b></p> <p>Na topologia do nosso capítulo, podemos ver as seguintes relações de vizinho CDP:</p> <ul><li> R1 e S1 são vizinhos CDP.</li> <li> R1 e R2 são vizinhos CDP.</li> <li> R2 e S2 são vizinhos CDP.</li> <li> R2 e R3 são vizinhos CDP.</li> <li> R3 e S3 são vizinhos CDP.</li></ul> <p>Observe a diferença entre os vizinhos das camadas 2 e 3. Os switches não são vizinhos dos roteadores na Camada 3, porque funcionam na Camada 2. No entanto, os switches são vizinhos de Camada 2 de seus roteadores conectados diretamente. </p> <p>Vejamos como o CDP pode ser útil para um administrador de rede.</p></content-text>
</page>
<page type="OneColumn" id="tl0902030302">
<content-media type="StaticGraphic" id="cm7540033566"><title><content-text></content-text></title><media ref="tl0902000000/tl0902030000/tl0902030300/tl0902030302/cm7540033566.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902030000/tl0902030300/tl0902030302/cm7540033566text.xml"/></content-media>
<content-text><p><b>Operação CDP</b></p> <p>Examine a saída dos comandos <span class="cmd"><b>show cdp neighbors</b></span> e <span class="cmd"><b>show cdp neighbors detail</b></span> na figura. Observe que R3 obteve algumas informações detalhadas sobre R2 e que o switch está conectado à interface Fast Ethernet em R3.</p> <p>O CDP é executado na camada de enlace de dados que conecta os meios físicos aos Protocolos de camada superior(ULPs, Upper-Layer Protocols). Como CDP funciona na camada de enlace de dados, dois ou mais dispositivos de rede Cisco, como roteadores que oferecem suporte a protocolos de camada de rede diferentes (por exemplo, IP e Novell <content-link target="cg7950820394" type="glossary">IPX</content-link>), podem saber um sobre o outro.</p> <p>Quando um dispositivo Cisco é inicializado, o CDP é inicializado por padrão. O CDP detecta automaticamente dispositivos Cisco vizinhos que executam CDP, independentemente do protocolo ou dos conjuntos de aplicações de protocolo que estejam executando. CDP troca informações dos dispositivos de hardware e de software com seus vizinhos de CDP conectados diretamente.</p> <p>CDP fornece as seguintes informações sobre cada dispositivo CDP vizinho:</p> <ul><li> <b>Identificadores de dispositivo</b> – Por exemplo, o nome de host configurado de um switch</li> <li> <b>Lista de endereços</b> – suporte até um endereço da camada de rede para cada protocolo</li> <li> <b>Lista de recursos</b> – por exemplo, se esse dispositivo é um roteador ou um switch</li> <li> <b>Plataforma </b> – a plataforma de hardware do dispositivo; por exemplo, um roteador série Cisco 7200</li></ul></content-text>
</page>
<page type="OneColumn" id="tl0902030303">
<content-media type="ActivityPKA" id="cm5792531794"><title><content-text></content-text></title><media ref="tl0902000000/tl0902030000/tl0902030300/tl0902030303/cm5792531794/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902030000/tl0902030300/tl0902030303/cm5792531794/icontext.xml"/></content-media>
<content-text><p>Use a atividade do Packet Tracer para explorar os recursos do CDP. Pratique habilitando e desabilitando o CDP – globalmente e por interface. Investigue a eficiência de usar CDP na detecção da topologia de uma rede.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl0902030400">
<title><content-text>Usando CDP na detecção de rede</content-text></title>
<page type="OneColumn" id="tl0902030401">
<content-media type="StaticGraphic" id="cm5259822858"><title><content-text></content-text></title><media ref="tl0902000000/tl0902030000/tl0902030400/tl0902030401/cm5259822858.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902030000/tl0902030400/tl0902030401/cm5259822858text.xml"/></content-media>
<content-text><p><b>Comandos </b><span class="cmd"><b>show </b></span><b>CDP</b></p> <p>As informações obtidas pelo protocolo CDP podem ser examinadas com o comando <span class="cmd"><b>show cdp neighbors</b></span>. Para cada dispositivo CDP vizinho, são exibidas as seguintes informações:</p> <ul><li> ID de dispositivo vizinho</li> <li> Interface local</li> <li> Valor do tempo de espera, em segundos </li> <li> Código de recurso do dispositivo vizinho</li> <li> Plataforma de hardware do vizinho </li> <li> ID de porta remota do vizinho</li></ul> <p><b>Clique em <span class="cmd">show cdp neighbors detail </span>na figura.</b></p> <p>O comando <span class="cmd"><b>show cdp neighbors detail</b></span> também revela o endereço IP de um dispositivo vizinho. CDP revelará o endereço IP do vizinho, independentemente de você conseguir ou não executar ping no vizinho. Esse comando é muito útil quando dois roteadores Cisco não podem rotear usando o vínculo de dados compartilhado. O comando <span class="cmd"><b>show cdp neighbors detail</b></span> ajudará a determinar se um dos vizinhos CDP tem um erro na configuração IP.</p> <p>Em situações de detecção de rede, saber o endereço IP do vizinho CDP costuma ser toda a informação necessária à execução de telnet no dispositivo. Com uma sessão Telnet estabelecida, as informações podem ser obtidas sobre os dispositivos Cisco conectados diretamente de um vizinho. Dessa forma, você pode executar telnet em uma rede e construir uma topologia lógica. Na próxima atividade do Packet Tracer, você fará isso.</p> <p><b>Desabilitando CDP</b></p> <p>CDP pode ser um risco à segurança? Sim, pode. Talvez você já tenha visto pacotes CDP em seus laboratórios de captura de pacote de um curso anterior. Como algumas versões do IOS enviam anúncios CDP por padrão, é importante saber desabilitar o CDP.</p> <p><b>Clique em Desabilitando CDP na figura.</b></p> <p>Se você precisar desabilitar o CDP globalmente, use este comando para todo o dispositivo:</p> <span class="cmd"><p>Router(config)#<b>no cdp run</b></p></span> <p>Se você quiser usar CDP, mas precisar parar anúncios CDP em uma determinada interface, use este comando:</p> <span class="cmd"><p>Router(config-if)#<b>no cdp enable</b></p></span></content-text>
</page>
<page type="OneColumn" id="tl0902030402">
<content-media type="ActivityPKA" id="cm3840698242"><title><content-text></content-text></title><media ref="tl0902000000/tl0902030000/tl0902030400/tl0902030402/cm3840698242/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902030000/tl0902030400/tl0902030402/cm3840698242/icontext.xml"/></content-media>
<content-text><p>Os comandos <span class="cmd"><b>show </b></span> do CPD podem ser usados na detecção de informações sobre dispositivos desconhecidos em uma rede. Os comandos <span class="cmd"><b>show </b></span> do CPD exibem informações sobre dispositivos Cisco conectados diretamente, inclusive um endereço IP que pode ser usado para alcançar o dispositivo. Dessa forma, você pode executar telnet no dispositivo e repetir o processo até que toda a rede seja mapeada. </p> <p>Use a atividade do Packet Tracer para detectar e mapear uma rede desconhecida usando CDP e Telnet.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0902040000">
<title><content-text>Rotas estáticas com endereços do "próximo salto"</content-text></title>
<topic type="" id="tl0902040100">
<title><content-text>Finalidade e sintaxe do comando ip route</content-text></title>
<page type="OneColumn" id="tl0902040101">
<content-media type="StaticGraphic" id="cm3707745981"><title><content-text></content-text></title><media ref="tl0902000000/tl0902040000/tl0902040100/tl0902040101/cm3707745981.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902040000/tl0902040100/tl0902040101/cm3707745981text.xml"/></content-media>
<content-text><p><b>Finalidade e sintaxe do comando ip route</b></p> <p>Como abordamos anteriormente, um roteador pode aprender redes remotas de duas formas:</p> <ul><li> Manualmente, a partir de rotas estáticas configuradas</li> <li> Automaticamente, a partir de um protocolo de roteamento dinâmico </li></ul> <p>O restante deste capítulo se concentra em como configurar rotas estáticas. Os protocolos de roteamento dinâmico serão apresentados no próximo capítulo.</p> <p><b>Rotas estáticas</b></p> <p>As rotas estáticas costumam ser usadas no roteamento de uma rede para uma rede stub. <b>Rede stub é uma rede acessada por uma única rota.</b> Para obter um exemplo, veja a figura. Vemos aqui que qualquer rede conectada a R1 só teria uma forma de alcançar outros destinos, independentemente de serem redes conectadas a R2 ou destinos além de R2. Portanto, a rede 172.16.3.0 é uma rede stub e R1 é um roteador stub. </p> <p>Executar um protocolo de roteamento entre R1 e R2 é um desperdício de recursos porque R1 só tem uma saída para enviar tráfego que não seja local. Por isso, as rotas estáticas são configuradas tendo em vista a conectividade com redes remotas que não estejam diretamente conectadas a um roteador. Mais uma vez, consultando a figura, configuraríamos uma rota estática em R2 para a rede local conectada a R1. Também veremos como configurar uma rota estática padrão de R1 para R2 posteriormente no capítulo para que R1 possa enviar tráfego para qualquer destino além de R2.</p></content-text>
</page>
<page type="OneColumn" id="tl0902040102">
<content-media type="StaticGraphic" id="cm1702038481"><title><content-text></content-text></title><media ref="tl0902000000/tl0902040000/tl0902040100/tl0902040102/cm1702038481.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902040000/tl0902040100/tl0902040102/cm1702038481text.xml"/></content-media>
<content-text><p><b>O </b><b>comando </b><span class="cmd"><b>ip route</b></span></p> <p>O comando para configurar uma rota estática é <span class="cmd"><b>ip route</b></span>. A sintaxe completa para configurar uma rota estática é:</p> <span class="cmd"><p>Router(config)#<b>ip route prefix mask</b> {<i>ip-address | interface-type interface-number </i>[<i>ip-address</i>]} [<i>distance</i>] [<i>name</i>] [<b>permanent</b>] [<b>tag </b>tag] </p></span> <p>A maioria desses parâmetros não é relevante para este capítulo ou para seus estudos CCNA. Como mostrado na figura, usaremos uma versão mais simples da sintaxe:</p> <span class="cmd"><p>Router(config)#<b>ip route </b><i>network-address subnet-mask</i> {<i>ip-address</i> | <i>exit-interface </i>}</p></span> <p>Os seguintes parâmetros são usados:</p> <ul><li> <span class="cmd"><i>network-address</i></span> - Endereço da rede de destino da rede remota a ser adicionado à tabela de roteamento</li> <li> <span class="cmd"><i>subnet-mask</i></span> - Máscara de sub-rede da rede remota a ser adicionada à tabela de roteamento. A máscara de sub-rede pode ser modificada para resumir um grupo de redes. </li></ul> <p>Um ou dois dos seguintes parâmetros também devem ser usados:</p> <ul><li> <span class="cmd"><i>ip-address</i></span> - Normalmente conhecido como o endereço IP do roteador do próximo salto </li> <li> <span class="cmd"><i>exit-interface</i></span> - Interface de saída que seria usada no encaminhamento de pacotes para a rede de destino</li></ul> <p><b>Nota: </b>O parâmetro <span class="cmd"><i>ip-address</i></span> costuma ser conhecido como o endereço IP do "próximo salto" do roteador. O endereço IP do próximo salto do roteador costuma ser usado nesse parâmetro. No entanto, o parâmetro <span class="cmd"><i>ip-address</i></span> pode ser qualquer endereço IP, desde que possa ser resolvido na tabela de roteamento. Isso está além do escopo desse curso, mas nós adicionamos esse ponto para manter a precisão técnica.</p></content-text>
</page>
</topic>
<topic type="" id="tl0902040200">
<title><content-text>Configurando rotas estáticas</content-text></title>
<page type="OneColumn" id="tl0902040201">
<content-media type="InteractiveGraphicHotspots" id="cm8293580789"><title><content-text></content-text></title><media ref="tl0902000000/tl0902040000/tl0902040200/tl0902040201/cm8293580789.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902040000/tl0902040200/tl0902040201/cm8293580789text.xml"/></content-media>
<content-text><p><b>Instalando uma rota estática na tabela de roteamento</b></p> <p>Lembre-se de que R1 conhece suas três redes diretamente conectadas. Elas são as rotas atualmente em sua tabela de roteamento. As redes remotas que R1 <b>não</b> conhece são:</p> <ul><li> 172.16.1.0/124 – a rede local em R2</li> <li> 192.168.1.0/24 – a rede serial entre R2 e R3</li> <li> 192.168.2.0/24 – a rede local em R3</li></ul> <p><b>Clique em Rota estática na figura.</b></p> <p>Primeiro, habilite <span class="cmd"><b>debug ip routing</b></span> para que o IOS exiba uma mensagem quando a nova rota é adicionada à tabela de roteamento. Em seguida, use o comando <span class="cmd"><b>ip route</b></span> para configurar rotas estáticas em R1 para cada uma dessas redes. A figura mostra a primeira rota configurada.</p> <span class="cmd"><p>R1#<b>debug ip routing</b></p></span> <span class="cmd"><p>R1#<b>conf t</b></p></span> <span class="cmd"><p>R1(config)#<b>ip route 172.16.1.0 255.255.255.0 172.16.2.2</b></p></span> <p>Examinemos cada elemento nessa saída do comando:</p> <ul><li> <span class="cmd"><b>ip route</b></span> - Comando de rota estática</li> <li> <span class="cmd"><b>172.16.1.0</b></span> - Endereço de rede da rede remota</li> <li> <span class="cmd"><b>255.255.255.0</b></span> - Máscara de sub-rede da rede remota</li> <li> <span class="cmd"><b>172.16.2.2</b></span> - Endereço IP da interface Serial 0/0/0 em R2, que é o "próximo salto" da rede</li></ul> <p>Quando o endereço IP for o endereço IP do roteador do próximo salto real, esse endereço IP será alcançável de uma das redes diretamente conectadas do roteador. Em outras palavras, o endereço IP do próximo salto <b>172.16.2.2</b> está na rede <b>172.16.2.0/24</b> Serial 0/0/0 conectada diretamente ao roteador R1.</p> <p><b>Verificando a rota estática</b></p> <p>A saída do comando <span class="cmd"><b>debug ip routing</b></span> mostra que essa rota foi adicionada à tabela de roteamento. </p> <span class="cmd"><p>00:20:15: RT: <span class="blue">add 172.16.1.0/24 via 172.16.2.2</span>, static metric [1/0]</p></span> <p>Observe na figura que inserir <span class="cmd"><b>show ip route</b></span> em R1 mostra a nova tabela de roteamento. A entrada de rota estática é realçada.</p> <p>Examinemos esta saída do comando:</p> <ul><li> <span class="cmd"><b>S</b></span> - Código da tabela de roteamento para rota estática</li> <li> <span class="cmd"><b>172.16.1.0</b></span> - Endereço de rede da rota</li> <li><span class="cmd"><b>/24</b></span> - Máscara de sub-rede da rota; ela é exibida na linha anterior, conhecida como a rota primária e abordada no Capítulo 8</li> <li> <span class="cmd"><b>[1/0]</b></span> - Distância administrativa e métrica da rota estática (explicada em um capítulo posterior)</li> <li> <span class="cmd"><b>via 172.16.2.2</b></span> - Endereço IP do roteador do próximo salto, o endereço IP da interface Serial 0/0/0 de R2</li></ul> <p>Qualquer pacote com um endereço IP de destino que tenha os 24 bits à esquerda correspondentes a <b>172.16.1.0</b> usará essa rota.</p></content-text>
</page>
<page type="OneColumn" id="tl0902040202">
<content-media type="StaticGraphic" id="cm2247731259"><title><content-text></content-text></title><media ref="tl0902000000/tl0902040000/tl0902040200/tl0902040202/cm2247731259.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902040000/tl0902040200/tl0902040202/cm2247731259text.xml"/></content-media>
<content-text><p><b>Configurando rotas para mais duas redes remotas</b></p> <p>Os comandos para configurar as rotas para as outras duas redes remotas são mostrados na figura. Observe que todas as três rotas estáticas configuradas em R1 têm o mesmo endereço IP do próximo salto: 172.16.2.2. Usando o diagrama de topologia como referência, podemos ver que isso é verdade porque os pacotes de todas as redes remotas devem ser encaminhados para o roteador R2, o roteador do próximo salto.</p> <p>Use o comando <span class="cmd"><b>show ip route</b></span> novamente para examinar as novas rotas estáticas na tabela de roteamento, como mostrado.</p> <span class="cmd"><p>S 192.168.1.0/<span class="blue">24 </span>[1/0] via 172.16.2.2</p></span> <span class="cmd"><p>S 192.168.2.0/<span class="blue">24 </span>[1/0] via 172.16.2.2</p></span> <p>As máscaras de sub-rede /24 são localizadas na mesma linha do endereço de rede. Por enquanto, essa diferença não importa. Ela será explicada com mais detalhes no Capítulo 8, "A Tabela de Roteamento: Uma Análise Mais Profunda".</p> <p><b>Clique em Verificar a configuração de rota estática na figura.</b></p> <p>As rotas estáticas que foram configuradas também podem ser verificadas examinando-se a configuração em execução com o comando <span class="cmd"><b>show running-config</b></span>.</p> <p>Agora é um bom momento para salvar a configuração na NVRAM:</p> <span class="cmd"><p>R1#<b>copy running-config startup-config</b></p></span></content-text>
</page>
</topic>
<topic type="" id="tl0902040300">
<title><content-text>Princípios da tabela de roteamento e rotas estáticas</content-text></title>
<page type="OneColumn" id="tl0902040301">
<content-media type="StaticGraphic" id="cm5151278335"><title><content-text></content-text></title><media ref="tl0902000000/tl0902040000/tl0902040300/tl0902040301/cm5151278335.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902040000/tl0902040300/tl0902040301/cm5151278335text.xml"/></content-media>
<content-text><p><b>Princípios da tabela de roteamento</b></p> <p>Agora que há três rotas estáticas configuradas, você pode prever se os pacotes com destino a essas redes alcançarão seu destino? Os pacotes de todas essas redes com destino à rede 172.16.3.0/24 alcançarão seu destino? </p> <p>Apresentemos três princípios da tabela de roteamento, conforme a descrição de Alex Zinin em seu livro, <i>Cisco IP Routing</i>. </p> <p><b>Princípio 1: "Todos os roteadores tomam suas decisões sozinhos com base nas informações presentes em sua própria tabela de roteamento."</b></p> <p>R1 tem três rotas estáticas em sua tabela de roteamento e toma decisões de encaminhamento exclusivamente com base na tabela de roteamento. R1 não consulta as tabelas de roteamento em qualquer outro roteador. Nem sabe se esses roteadores têm ou não rotas para outras redes. Alertar cada roteador sobre redes remotas é responsabilidade do administrador de rede.</p> <p><b>Princípio 2: "O fato de um roteador ter determinadas informações em sua tabela de roteamento não significa que todos os roteadores tenham as mesmas informações."</b></p> <p>R1 não sabe que informações os demais roteadores têm em sua tabela de roteamento. Por exemplo, R1 tem uma rota para a rede 192.168.2.0/24 por meio do roteador R2. Qualquer pacote correspondente a essa rota pertence à rede 192.168.2.0/24, sendo encaminhado para o roteador R2. R1 não sabe se R2 tem uma rota até a rede 192.168.2.0/24. Mais uma vez, o administrador de rede seria responsável por assegurar que o roteador do próximo salto também tenha uma rota para essa rede.</p> <p>Usando o Princípio 2, continuamos precisando configurar o roteamento apropriado nos demais roteadores (R2 e R3) para ter certeza de que eles tenham rotas para essas três redes. </p> <p><b>Princípio 3: "As informações de roteamento sobre um caminho de uma rede para outra não fornecem informações de roteamento sobre o caminho inverso ou de retorno."</b></p> <p>Grande parte da comunicação em redes é bidirecional. Isso significa que os pacotes devem percorrer ambas as direções entre os dispositivos finais envolvidos. Um pacote de PC1 pode alcançar PC3 porque todos os roteadores envolvidos têm rotas para a rede de destino 192.168.2.0/24. No entanto, o êxito de qualquer pacote de retorno indo de PC3 para PC1 depende se os roteadores envolvidos possuem ou não uma rota para o caminho de retorno, a rede172.16.3.0/24 de PC1. </p> <p>Usando o Princípio 3 como base, configuraremos rotas estáticas apropriadas nos demais roteadores para ter certeza de que haja rotas para a rede 172.16.3.0/24.</p></content-text>
</page>
<page type="OneColumn" id="tl0902040302">
<content-media type="InteractiveGraphicHotspots" id="cm7642174641"><title><content-text></content-text></title><media ref="tl0902000000/tl0902040000/tl0902040300/tl0902040302/cm7642174641.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902040000/tl0902040300/tl0902040302/cm7642174641text.xml"/></content-media>
<content-text><p><b>Aplicando os princípios</b></p> <p>Tendo esses princípios em mente, como você responderia as perguntas feitas por nós sobre pacotes com origem em PC1?</p> <p>1. Os pacotes de PC1 alcançariam seu destino? </p> <p>Nesse caso, os pacotes com destino a redes 172.16.1.0/24 e 192.168.1.0/24 alcançariam seu destino. Isso porque o roteador R1 tem uma rota para essas redes por meio de R2. Quando os pacotes alcançam o Roteador R2, essas redes são diretamente conectadas em R2 e roteadas usando sua tabela de roteamento.</p> <p>Os pacotes com destino à rede 192.168.2.0/24 não alcançaria seu destino. R1 tem uma rota estática para essa rede por meio de R2. No entanto, quando R2 receber um pacote, ele o descartará porque R2 ainda não contém uma rota para essa rede em sua tabela de roteamento.</p> <p>2. Isso significa que algum pacote dessas redes com destino à rede 172.16.3.0/24 alcançará seu destino?</p> <p>Se R2 ou R3 receber um pacote com destino a 172.16.3.0/24, o pacote não alcançará seu destino, porque nenhum roteador tem uma rota para a rede 172.16.3.0/24.</p> <p><b>Clique em Rotas Estáticas de R2 e R3 na figura.</b></p> <p>Com os comandos mostrados na figura, agora todos os roteadores têm rotas para todas as redes remotas. </p> <p><b>Clique em </b><span class="cmd"><b>show ip route</b></span><b> na figura.</b></p> <p>Examine as tabelas de roteamento na figura para verificar se todos os roteadores agora têm rotas para todas as redes remotas.</p> <p><b>Clique em </b><span class="cmd"><b>ping</b></span><b> na figura.</b></p> <p>A conectividade pode ser melhor verificada, executando-se ping nas interfaces do roteador remoto a partir do roteador R1, como mostrado na figura.</p> <p>Agora a conectividade total é obtida para os dispositivos em nossa topologia. Agora qualquer PC, em qualquer rede local, pode acessar PCs em todas as outras redes locais.</p></content-text>
</page>
</topic>
<topic type="" id="tl0902040400">
<title><content-text>Resolvendo uma interface de saída</content-text></title>
<page type="OneColumn" id="tl0902040401">
<content-media type="StaticGraphic" id="cm8459832998"><title><content-text></content-text></title><media ref="tl0902000000/tl0902040000/tl0902040400/tl0902040401/cm8459832998.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902040000/tl0902040400/tl0902040401/cm8459832998text.xml"/></content-media>
<content-text><p><b>Pesquisa de rota recursiva</b></p> <p>Para que um pacote seja encaminhado por um roteador, o processo da tabela de roteamento deve determinar a interface de saída a ser usada no encaminhamento do pacote. Isso é conhecido como capacidade de resolução da rota. Examinemos esse processo, observando a tabela de roteamento de R1 na figura. R1 tem uma rota estática para a rede remota 192.168.2.0/24, que encaminha todos os pacotes para o endereço IP 172.16.2.2 do próximo salto. </p> <span class="cmd"><p><b>S 192.168.2.0/24 [1/0] via 172.16.2.2</b></p></span> <p>Localizar uma rota é apenas a primeira etapa do processo de pesquisa. R1 deve determinar como alcançar o endereço IP 172.16.2.2 do próximo salto. Ele fará uma segunda pesquisa em busca de uma correspondência para 172.16.2.2. Nesse caso, o endereço IP 172.16.2.2 corresponde à rota da rede 17216.2.0/24 conectada diretamente. </p> <span class="cmd"><p><b>C 172.16.2.0 is directly connected, Serial0/0/0</b></p></span> <p>A rota 172.16.2.0 é uma rede conectada diretamente com a interface de saída Serial 0/0/0. Essa pesquisa informa ao processo da tabela de roteamento que esse pacote será encaminhado pela interface. Portanto, ele, na verdade, usa dois processos de pesquisa da tabela de roteamento para encaminhar um pacote para a rede 192.168.2.0/24. Quando o roteador precisa executar várias pesquisas na tabela de roteamento antes de encaminhar um pacote, ele executa um processo conhecido como <i>pesquisa recursiva</i>. Neste exemplo:</p> <p>1. O endereço IP de destino do pacote corresponde à rota estática 192.168.2.0/24 com o endereço IP 172.16.2.2 do próximo salto.</p> <p>2. O endereço IP do próximo salto da rota estática, 172.16.2.2, corresponde à rede conectada diretamente 172.16.2.0/24 com a interface de saída de Serial 0/0/0.</p>  <p>Toda rota que só referencia um endereço IP do próximo salto, e não uma interface de saída, deve ter o endereço IP do próximo salto resolvido usando outra rota na tabela de roteamento que tenha uma interface de saída. </p> <p>Normalmente, essas rotas são resolvidas para rotas na tabela de roteamento que são redes diretamente conectadas, porque essas entradas sempre conterão uma interface de saída. Veremos na próxima seção que as rotas estáticas podem ser configuradas com uma interface de saída. Isso significa que elas não precisam ser resolvidas usando outra entrada de rota.</p></content-text>
</page>
<page type="OneColumn" id="tl0902040402">
<content-media type="StaticGraphic" id="cm6416309300"><title><content-text></content-text></title><media ref="tl0902000000/tl0902040000/tl0902040400/tl0902040402/cm6416309300.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902040000/tl0902040400/tl0902040402/cm6416309300text.xml"/></content-media>
<content-text><p><b>Interface de saída está desativada</b></p> <p>Consideremos o que aconteceria se uma interface de saída fosse desativada. Por exemplo, o que aconteceria com a rota estática de R1 para 192.16.2.0/24 se a interface Serial 0/0/0 fosse desativada? Se a rota estática não puder ser resolvida para uma interface de saída, neste caso Serial 0/0/0, a rota estática será removida da tabela de roteamento. </p> <p>Examine esse processo com <span class="cmd"><b>debug ip routing</b></span> em R1 e configure a Serial 0/0/0 como <span class="cmd"><b>shutdown</b></span>, como mostrado. </p> <p>Observe, a partir da saída de depuração, que todas as três rotas estáticas foram excluídas quando a interface Serial 0/0/0 foi fechada. Elas foram excluídas porque todas as três rotas estáticas foram resolvidas para Serial 0/0/0. No entanto, as rotas estáticas ainda estão na configuração em execução de R1. Se a interface voltar (ser habilitada novamente com <span class="cmd"><b>no shutdown</b></span>), o processo da tabela de roteamento do IOS reinstalará essas rotas estáticas na tabela de roteamento. </p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0902050000">
<title><content-text>Rotas estáticas com interfaces de saída</content-text></title>
<topic type="" id="tl0902050100">
<title><content-text>Configurando uma rota estática com uma interface de saída</content-text></title>
<page type="OneColumn" id="tl0902050101">
<content-media type="StaticGraphic" id="cm9764670292"><title><content-text></content-text></title><media ref="tl0902000000/tl0902050000/tl0902050100/tl0902050101/cm9764670292.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902050000/tl0902050100/tl0902050101/cm9764670292text.xml"/></content-media>
<content-text><p><b>Configurando uma rota estática com uma interface de saída</b></p> <p>Investiguemos outra forma de configurar as mesmas rotas estáticas. Atualmente, a rota estática de R1 da rede 192.168.2.0/24 está configurada com o endereço IP do próximo salto de 172.16.2.2. Na configuração em execução, observe a seguinte linha: </p> <span class="cmd"><p><b>ip route 192.168.2.0 255.255.255.0 172.16.2.2</b></p></span> <p>Como você se lembrará da seção anterior, essa rota estática exige uma segunda pesquisa na tabela de roteamento para resolver o endereço IP do próximo salto 172.16.2.2 para uma interface de saída. No entanto, a maioria das rotas estáticas pode ser configurada com uma interface de saída, o que permite à tabela de roteamento resolver a interface de saída em uma única pesquisa, e não duas. </p></content-text>
</page>
<page type="OneColumn" id="tl0902050102">
<content-media type="StaticGraphic" id="cm8438402046"><title><content-text></content-text></title><media ref="tl0902000000/tl0902050000/tl0902050100/tl0902050102/cm8438402046.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902050000/tl0902050100/tl0902050102/cm8438402046text.xml"/></content-media>
<content-text><p><b>Rota estática e uma interface de saída</b></p> <p>Reconfiguremos essa rota estática para usar uma interface de saída, e não um endereço IP do próximo salto. A primeira coisa a se fazer é excluir a rota estática atual. Isso é feito usando-se o comando <span class="cmd"><b>no ip route</b></span> como mostrado na figura.</p> <p>Em seguida, configure a rota estática de R1 como <b>192.168.2.0/24</b> usando a interface de saída Serial 0/0/0.</p> <p>E use o comando <span class="cmd"><b>show ip route</b></span> para examinar a alteração feita na tabela de roteamento. Observe que a entrada na tabela de roteamento já não se refere mais ao endereço IP do próximo salto, mas diretamente à interface de saída. Essa interface de saída é a mesma para a qual a rota estática foi resolvida quando usou o endereço IP do próximo salto. </p> <span class="cmd"><p><b>S 192.168.2.0/24 </b><b><span class="blue">is directly connected, Serial0/0/0</span></b></p></span> <p>Agora quando o processo da tabela de roteamento tiver uma correspondência para um pacote e essa rota estática, ele poderá resolver a rota para uma interface de saída em uma única pesquisa. Como você pode ver na figura, as outras duas rotas estáticas ainda devem ser processadas em duas etapas, resolvendo para a mesma interface Serial 0/0/0.</p> <p><b>Nota: </b>A rota estática exibe a rota como <b>conectada diretamente</b>. É importante compreender que isso não significa que essa rota é uma rede conectada diretamente ou uma rota conectada diretamente. Essa rota continua sendo uma rota estática. Examinaremos a importância desse fato ao discutirmos as distâncias administrativas no próximo capítulo. Aprenderemos que esse tipo de rota estática ainda tem uma distância administrativa "1". Por enquanto, apenas observe que essa rota ainda é uma rota estática com uma distância administrativa "1", e não é uma rede conectada diretamente.</p> <p><b>Rotas estáticas e redes ponto-a-ponto</b></p> <p>As rotas estáticas configuradas com interfaces de saída, e não endereços IP do próximo salto, são ideais para a maioria das redes ponto-a-ponto seriais. As redes ponto-a-ponto que usam protocolos, como HDLC e PPP, não usam o endereço IP do próximo salto no processo de encaminhamento de pacote. O pacote IP roteado é encapsulado em um quadro de Camada 2 HDLC com um endereço de destino de Camada 2 de broadcast. </p> <p>Esses tipos de links seriais ponto-a-ponto são como pipes. Um pipe tem apenas duas extremidades. O que entra em uma extremidade só pode ter um destino único – a outra extremidade do pipe. Qualquer pacote enviado pela interface Serial 0/0/0 de R1 só pode ter um destino: interface Serial 0/0/0 de R2. A interface serial de R2 acaba sendo o endereço IP 172.16.2.2. </p> <p><b>Nota:</b> Em determinadas condições, o administrador de rede não irá querer configurar a rota estática com uma interface de saída, mas com o endereço IP do próximo salto. Esse tipo de situação está além do escopo deste curso, mas é importante observá-la.</p></content-text>
</page>
</topic>
<topic type="" id="tl0902050200">
<title><content-text>Modificando rotas estáticas</content-text></title>
<page type="OneColumn" id="tl0902050201">
<content-media type="StaticGraphic" id="cm4808586953"><title><content-text></content-text></title><media ref="tl0902000000/tl0902050000/tl0902050200/tl0902050201/cm4808586953.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902050000/tl0902050200/tl0902050201/cm4808586953text.xml"/></content-media>
<content-text><p><b>Modificando rotas estáticas</b></p> <p>Há momentos em que uma rota estática configurada anteriormente precisa ser modificada:</p> <ul><li> A rede de destino não existe mais e, por isso, a rota estática deve ser excluída.</li> <li> Há uma alteração na topologia, e o endereço intermediário ou a interface de saída deve ser alterada. </li></ul> <p>Não há forma de modificar uma rota estática existente. A rota estática deve ser excluída, e uma nova é configurada. </p> <p>Para excluir uma rota estática, adicione <span class="cmd"><b>no </b></span>na frente do comando <span class="cmd"><b>ip route</b></span>, seguido pelo resto da rota estática a ser removida.</p> <p>Na seção anterior, tínhamos uma rota estática:</p> <span class="cmd"><p><b>ip route 192.168.2.0 255.255.255.0 172.16.2.2</b></p></span> <p>Podemos excluir essa rota estática usando o comando <span class="cmd"><b>no ip route</b></span>:</p> <span class="cmd"><p><b>no ip route 192.168.2.0 255.255.255.0 172.16.2.2</b></p></span> <p>Como você deve se lembrar, excluímos a rota estática porque queríamos modificá-la para usar uma interface de saída, e não um endereço IP do próximo salto. Configuramos uma nova rota estática, usando a interface de saída:</p> <span class="cmd"><p>R1(config)#<b>ip route 192.168.2.0 255.255.255.0 </b><b><span class="blue">serial 0/0/0</span></b></p></span> <p>É mais eficiente para o processo de pesquisa da tabela de roteamento ter rotas estáticas com interfaces de saída – pelo menos para redes de saída ponto-a-ponto seriais. Reconfiguremos as demais rotas estáticas em R1, R2 e R3 para usar interfaces de saída.</p> <p>Como você pode ver na figura, quando excluirmos uma rota, configuraremos uma nova para a mesma rede usando uma interface de saída.</p></content-text>
</page>
</topic>
<topic type="" id="tl0902050300">
<title><content-text>Verificando a configuração de rota estática</content-text></title>
<page type="OneColumn" id="tl0902050301">
<content-media type="InteractiveGraphicHotspots" id="cm5446374560"><title><content-text></content-text></title><media ref="tl0902000000/tl0902050000/tl0902050300/tl0902050301/cm5446374560.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902050000/tl0902050300/tl0902050301/cm5446374560text.xml"/></content-media>
<content-text><p><b>Verificando a configuração de rota estática</b></p> <p>Sempre que alterações forem feitas em rotas estáticas – ou em outros aspectos da rede – verifique se as alterações entraram em vigor e se produziram os resultados desejados.</p> <p><b>Verificando alterações feitas na rota estática</b></p> <p>Na seção anterior, excluímos e reconfiguramos as rotas estáticas para todos os três roteadores. Lembre-se de que a configuração em execução contém a configuração do roteador atual – os comandos e os parâmetros que o roteador está usando atualmente. Verifique as suas alterações, examinando a configuração em execução. A figura mostra as porções da configuração em execução de cada roteador que mostram a rota estática atual.</p> <p><b>Clique em </b><span class="cmd"><b>show ip route</b></span><b> na figura.</b></p> <p>Essa figura mostra a tabela de roteamento de todos os três roteadores. Observe que rotas estáticas com interfaces de saída foram adicionadas à tabela de roteamento e que as rotas estáticas anteriores com endereços do próximo salto foram excluídas.</p> <p><b>Clique em </b><span class="cmd"><b>ping</b></span><b> na figura.</b></p> <p>O teste final é rotear pacotes da origem para o destino. Usando o comando <span class="cmd"><b>ping</b></span>, podemos testar se os pacotes de cada roteador estão alcançando seu destino e se o caminho de retorno também está funcionando corretamente. Essa figura mostra saídas comando ping bem-sucedidas.</p></content-text>
</page>
<page type="OneColumn" id="tl0902050302">
<content-media type="ActivityPKA" id="cm9988989788"><title><content-text></content-text></title><media ref="tl0902000000/tl0902050000/tl0902050300/tl0902050302/cm9988989788/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902050000/tl0902050300/tl0902050302/cm9988989788/icontext.xml"/></content-media>
<content-text><p>Use a atividade do Packet Tracer para testar a remoção de rotas estáticas e a reconfiguração de rotas estáticas usando o argumento da interface de saída. Em seguida, verifique a nova configuração e teste a conectividade.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl0902050400">
<title><content-text>Rotas estáticas com interfaces Ethernet</content-text></title>
<page type="OneColumn" id="tl0902050401">
<content-media type="StaticGraphic" id="cm9316366598"><title><content-text></content-text></title><media ref="tl0902000000/tl0902050000/tl0902050400/tl0902050401/cm9316366598.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902050000/tl0902050400/tl0902050401/cm9316366598text.xml"/></content-media>
<content-text><p><b>Interfaces Ethernet e ARP</b></p> <p>Às vezes, a interface de saída é uma rede Ethernet. </p> <p>Suponhamos que o link de rede entre R1 e R2 seja um link Ethernet e que a interface FastEthernet 0/1 de R1 esteja conectada à essa rede, como mostrado na figura. Uma rota estática, usando um endereço IP do próximo salto para a rede 192.168.2.0/24, pode ser definido usando este comando:</p> <span class="cmd"><p>R1(config)#<b>ip route 192.168.2.0 255.255.255.0 172.16.2.2</b></p></span> <p>Como abordado na seção anterior, "Configurando uma interface Ethernet", o pacote IP deve ser encapsulado em um quadro Ethernet com um endereço MAC de destino Ethernet. Se o pacote precisar ser enviado para um roteador do próximo salto, o endereço MAC de destino será o endereço da interface Ethernet do roteador do próximo salto. Nesse caso, o endereço MAC de destino Ethernet será correspondente ao endereço IP do próximo salto 172.16.2.2. R1 verifica sua tabela ARP de FastEthernet 0/1 em busca de uma entrada com 172.16.2.2 e um endereço MAC correspondente. </p> <p><b>Enviando uma solicitação ARP</b></p> <p>Se essa entrada não estiver na tabela ARP, R1 enviará uma solicitação ARP pela interface FastEthernet 0/1. O broadcast de Camada 2 está solicitando que, se algum dispositivo tiver o endereço IP 172.16.2.2, que responda com seu endereço MAC. Como a interface FastEthernet de R2 0/1 tem o endereço IP 172.16.2.2, ela manda de volta uma resposta ARP com o endereço MAC da interface.</p> <p>R1 recebe a resposta ARP e adiciona o endereço IP 172.16.2.2, além do endereço MAC associado, à sua tabela ARP. Agora o pacote IP é encapsulado em um quadro Ethernet com o endereço MAC de destino encontrado na tabela ARP. Em seguida, o quadro Ethernet com o pacote encapsulado é enviado pela interface FastEthernet 0/1 para o Roteador R2.</p></content-text>
</page>
<page type="OneColumn" id="tl0902050402">
<content-media type="StaticGraphic" id="cm4941855589"><title><content-text></content-text></title><media ref="tl0902000000/tl0902050000/tl0902050400/tl0902050402/cm4941855589.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902050000/tl0902050400/tl0902050402/cm4941855589text.xml"/></content-media>
<content-text><p><b>Rotas estáticas e interfaces de saída Ethernet</b></p> <p>Configuremos uma rota estática com uma interface de saída Ethernet, e não um endereço IP do próximo salto. Altere a rota estática para 192.168.2.0/24 a fim de usar uma interface de saída com este comando:</p> <span class="cmd"><p>R1(config)#<b>ip route 192.168.2.0 255.255.255.0 fastethernet 0/1</b></p></span> <p>A diferença entre uma rede Ethernet e uma rede serial ponto-a-ponto é que uma rede ponto-a-ponto tem apenas um outro dispositivo nessa rede – o roteador na outra extremidade do link. Com redes Ethernet, talvez haja muitos dispositivos diferentes compartilhando a mesma rede multiacesso, inclusive hosts e até mesmo vários roteadores. Designando apenas a interface de saída Ethernet na rota estática, o roteador não terá informações suficientes para determinar que dispositivo é o dispositivo do próximo salto. </p> <p>R1 sabe que o caminho precisa ser encapsulado em um quadro Ethernet e enviado pela interface FastEthernet 0/1. No entanto, R1 não sabe o endereço IP do próximo salto e, por isso, não pode determinar o endereço MAC de destino para o quadro Ethernet.</p> <p>Dependendo da topologia e das configurações em outros roteadores, essa rota estática talvez funcione ou não. Não entraremos em detalhes aqui, mas é recomendável que, quando a interface de saída for uma rede Ethernet, que você não use apenas a interface de saída na rota estática. </p> <p>A pessoa pode perguntar: Existe alguma forma de configurar uma rota estática em uma rede Ethernet para que ela não tenha que usar a pesquisa recursiva do endereço IP do próximo salto? Sim, isso pode ser feito configurando a rota estática para incluir a interface de saída e o endereço IP do próximo salto. </p> <p>Como você pode ver na figura, a interface de saída seria FastEthernet 0/1 e o endereço IP do próximo salto, 172.16.2.2.</p> <span class="cmd"><p>R1(config)#<b>ip route 192.168.2.0 255.255.255.0 fastethernet 0/1 172.16.2.2</b></p></span> <p>A entrada da tabela de roteamento dessa rota seria:</p> <span class="cmd"><p><b>S 192.168.2.0/24 [1/0] via 172.16.2.2 FastEthernet0/1</b></p></span> <p>O processo da tabela de roteamento só precisará executar uma única pesquisa para obter a interface de saída e o endereço IP do próximo salto.</p> <p><b>Vantagens de usar uma interface de saída com rotas estáticas</b></p> <p>Há uma vantagem em usar interfaces de saída em rotas estáticas para redes de saída ponto-a-ponto seriais e Ethernet. O processo da tabela de roteamento só precisa executar uma única pesquisa para localizar a interface de saída, e não uma segunda pesquisa para resolver um endereço do próximo salto.</p> <p>Para rotas estáticas com redes seriais ponto-a-ponto de saída, é melhor configurar rotas estáticas apenas com a interface de saída. Para interfaces seriais ponto-a-ponto, o endereço do próximo salto na tabela de roteamento jamais é usado pelo procedimento de entrega do pacote e, assim, não é necessário. </p> <p>Para rotas estáticas com redes Ethernet de saída, é melhor configurar as rotas estáticas com o endereço do próximo salto e a interface de saída.</p> <p><b>Nota: </b>Para obter mais informações sobre os problemas que podem ocorrer com rotas estáticas que só usam uma interface Ethernet ou FastEthernet de saída, leia o livro <i>Cisco IP Routing</i>, de Alex Zinin.</p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0902060000">
<title><content-text>Rotas estáticas padrão e sumarizadas</content-text></title>
<topic type="" id="tl0902060100">
<title><content-text>Rotas estáticas sumarizadas</content-text></title>
<page type="OneColumn" id="tl0902060101">
<content-media type="InteractiveGraphicHotspots" id="cm8063643556"><title><content-text></content-text></title><media ref="tl0902000000/tl0902060000/tl0902060100/tl0902060101/cm8063643556.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902060000/tl0902060100/tl0902060101/cm8063643556text.xml"/></content-media>
<content-text><p><b>Resumindo rotas para reduzir o tamanho da tabela de roteamento</b></p> <p>Criar tabelas de roteamento menores torna o processo de pesquisa na tabela de roteamento mais eficiente, porque há menos rotas a serem pesquisadas. Se uma rota estática puder ser usada em lugar de várias rotas estáticas, o tamanho da tabela de roteamento será reduzido. Em muitos casos, uma única rota estática pode ser usada para representar dúzias, centenas ou até mesmo milhares de rotas.</p> <p>Podemos usar um único endereço de rede para representar várias sub-redes. Por exemplo, as redes 10.0.0.0/16, 10.1.0.0/16, 10.2.0.0/16, 10.3.0.0/16, 10.4.0.0/16, 10.5.0.0/16 até 10.255.0.0/16 podem ser representadas por um único endereço de rede: 10.0.0.0/8.</p> <p><b>Sumarização de rota</b></p> <p>Várias rotas estáticas podem ser sumarizadas em uma única rota estática caso:</p> <ul><li> As redes de destino possam ser sumarizadas em um único endereço de rede e </li> <li> As várias rotas estáticas usem a mesma interface de saída ou o endereço IP do próximo salto </li></ul> <p>Isso é chamado de <content-link target="cg3862210443" type="glossary">sumarização de rota</content-link>.</p> <p>Em nosso exemplo, R3 tem três rotas estáticas. Todas as três rotas estão encaminhando tráfego pela mesma interface Serial0/0/1. As três rotas estáticas em R3 são:</p> <span class="cmd"><p><b>ip route 172.16.1.0 255.255.255.0 Serial0/0/1</b></p></span> <span class="cmd"><p><b>ip route 172.16.2.0 255.255.255.0 Serial0/0/1</b></p></span> <span class="cmd"><p><b>ip route 172.16.3.0 255.255.255.0 Serial0/0/1</b></p></span> <p>Se possível, gostaríamos de sumarizar todas essas rotas em uma única rota estática. 172.16.1.0/24, 172.16.2.0/24 e 172.16.3.0/24 podem ser sumarizadas para a rede 172.16.0.0/22. Como todas as três rotas usam a mesma interface de saída, elas podem ser sumarizadas para a única rede 172.16.0.0 255.255.252.0, e podemos criar uma única rota de sumarização.</p> <p><b>Calculando uma rota de sumarização</b></p> <p>Aqui está o processo de criação da rota de sumarização 172.16.1.0/22, como mostrado na figura:</p> <p>1. Escreva as redes que você deseja sumarizar em binário. </p> <p>2. Para localizar a máscara de sub-rede para sumarização, inicie com o bit mais à esquerda. </p> <p>3. Siga seu caminho para a direita, localizando todos os bits que correspondem consecutivamente.</p> <p>4. Quando você localizar uma coluna de bits <i>não</i> correspondente, pare. Você está no limite de sumarização. </p> <p>5. Agora, conte o número de bits mais à esquerda, que em nosso exemplo é 22. Este número se torna sua máscara de sub-rede para a rota de sumarização, /22 or 255.255.252.0</p> <p>6. Para localizar o endereço de rede para sumarização, copie os 22 bits correspondentes e adicione todos os bits 0 ao final para formar 32 bits.</p> <p>Seguindo essas etapas, podemos detectar que as três rotas estáticas em R3 podem ser sumarizadas em uma única rota estática, usando o endereço de rede de sumarização 172.16.0.0 255.255.252.0:</p> <span class="cmd"><p><b>ip route 172.16.0.0 255.255.252.0 Serial0/0/1</b></p></span> <p></p></content-text>
</page>
<page type="OneColumn" id="tl0902060102">
<content-media type="InteractiveGraphicHotspots" id="cm8842667530"><title><content-text></content-text></title><media ref="tl0902000000/tl0902060000/tl0902060100/tl0902060102/cm8842667530.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902060000/tl0902060100/tl0902060102/cm8842667530text.xml"/></content-media>
<content-text><p><b>Configurando uma <content-link target="cg7394034673" type="glossary">Rota de sumarização</content-link></b></p> <p>Para implementar a rota de sumarização, devemos excluir as três rotas estáticas atuais primeiro:</p> <span class="cmd"><p>R3(config)#<b>no ip route 172.16.1.0 255.255.255.0 serial0/0/1</b></p></span> <span class="cmd"><p>R3(config)#<b>no ip route 172.16.2.0 255.255.255.0 serial0/0/1</b></p></span> <span class="cmd"><p>R3(config)#<b>no ip route 172.16.3.0 255.255.255.0 serial0/0/1</b></p></span> <p>Em seguida, nós configuraremos a rota estática de sumarização:</p> <span class="cmd"><p>R3(config)#<b>ip route 172.16.0.0 255.255.252.0 serial0/0/1</b></p></span> <p><b>Clique em Efeito da rota de sumarização na figura.</b></p> <p>Para verificar a nova rota estática, examine a tabela de roteamento de R3 usando o comando <span class="cmd">show ip route</span>, como mostrado:</p> <span class="cmd"><p>172.16.0.0/<span class="blue">22 </span>is subnetted, 1 subnets</p></span> <span class="cmd"><p><span class="blue">S 172.16.0.0 is directly connected, Serial0/0/1</span></p></span> <p>Com essa rota de sumarização, o endereço IP de destino de um pacote só precisa corresponder aos 22 bits à esquerda do endereço de rede 172.16.0.0. Qualquer pacote com um endereço IP de destino pertencente às redes 172.16.1.0/24, 172.16.2.0/24 ou 172.16.3.0/24 corresponde a essa rota de sumarização.</p> <p><b>Clique em Verificar rota de sumarização na figura.</b></p> <p>Como você pode ver na figura, podemos testar a reconfiguração usando o comando <span class="cmd"><b>ping</b></span>. Verificamos que ainda temos uma conectividade apropriada ao longo da rede.</p> <p><b>Nota:</b> A partir de março de 2007, há mais de 200.000 rotas nos principais roteadores de Internet. A maioria delas é de rotas sumarizadas.</p></content-text>
</page>
</topic>
<topic type="" id="tl0902060200">
<title><content-text>Rota estática padrão</content-text></title>
<page type="OneColumn" id="tl0902060201">
<content-media type="StaticGraphic" id="cm7376673512"><title><content-text></content-text></title><media ref="tl0902000000/tl0902060000/tl0902060200/tl0902060201/cm7376673512.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902060000/tl0902060200/tl0902060201/cm7376673512text.xml"/></content-media>
<content-text><p><b>Correspondência mais específica</b></p> <p>É possível que o endereço IP de destino de um pacote corresponda a várias rotas na tabela de roteamento. Por exemplo, e se nós tivéssemos as duas rotas estáticas a seguir na tabela de roteamento:</p> <span class="cmd"><p>172.16.0.0/<span class="blue">24 </span>is subnetted, 3 subnets</p></span> <span class="cmd"><p><span class="blue">S 172.16.1.0</span> is directly connected, Serial0/0/0 and</p></span> <span class="cmd"><p><span class="blue">S 172.16.0.0/16</span> is directly connected, Serial0/0/1</p></span> <p>Considere um pacote com o endereço IP 172.16.1.10 de destino. Esse endereço IP corresponde a ambas as rotas. O processo de pesquisa da tabela de roteamento usará a correspondência mais específica. Como 24 bits correspondem à rota 172.16.1.0/24, e apenas 16 bits da rota 172.16.0.0/16 são correspondentes, a rota estática com a correspondência do 24º bit será usada. Essa é a correspondência mais longa. Em seguida, o pacote será encapsulado em um quadro de Camada 2 e enviado pela interface Serial 0/0/0. Lembre-se de que a máscara de sub-rede na entrada da rota é o que determina quantos bits devem corresponder ao endereço IP de destino do pacote para essa rota para que haja uma correspondência.</p> <p><b>Nota:</b> Esse processo é o mesmo para todas as rotas na tabela de roteamento, inclusive rotas estáticas, rotas aprendidas de um protocolo de roteamento e redes diretamente conectadas. O processo de pesquisa da tabela de roteamento será explicado com mais detalhes em um capítulo posterior.</p> <p>A rota estática padrão corresponde a todos os pacotes</p> <p>Uma rota estática padrão é uma rota que corresponderá a todos os pacotes. São usadas rotas estáticas padrão:</p> <ul><li> Quando nenhuma outra rota na tabela de roteamento corresponde ao endereço IP de destino. Em outras palavras, quando não houver uma correspondência mais específica. Um uso comum é ao conectar o roteador de borda de uma empresa à rede ISP.</li> <li> Quando um roteador só tem um outro roteador ao quale está conectado. Essa condição é conhecida como um roteador stub. </li></ul> <p><b>Configurando uma rota estática padrão</b></p> <p>A sintaxe de uma rota estática padrão é semelhante a qualquer outra rota estática, exceto pelo endereço de rede ser 0.0.0.0 e a máscara de sub-rede, 0.0.0.0:</p> <span class="cmd"><p>Router(config)#<b>ip route 0.0.0.0 0.0.0.0</b> [<b>exit-interface</b> | <b>ip-address</b> ]</p></span> <p>O endereço de rede <span class="cmd">0.0.0.0 0.0.0.0</span> e a máscara são chamados de rota "quad-zero". </p> <p>R1 é um roteador stub. Ele só é conectado a R2. Atualmente, R1 tem três rotas estáticas, usadas para alcançar todas as redes remotas em nossa topologia. Todas as três rotas estáticas têm a interface de saída Serial 0/0/0, encaminhando pacotes para o roteador R2 do próximo salto. </p> <p>As três rotas estáticas em R1 são:</p> <span class="cmd"><p><b>ip route 172.16.1.0 255.255.255.0 serial 0/0/0</b></p></span> <span class="cmd"><p><b>ip route 192.168.1.0 255.255.255.0 serial 0/0/0</b></p></span> <span class="cmd"><p><b>ip route 192.168.2.0 255.255.255.0 serial 0/0/0</b></p></span> <p>R1 é um candidato ideal para ter todas as suas rotas estáticas substituídas por uma única rota padrão. Primeiro, exclua as três rotas estáticas:</p> <span class="cmd"><p>R1(config)#<b>no ip route 172.16.1.0 255.255.255.0 serial 0/0/0</b></p></span> <span class="cmd"><p>R1(config)#<b>no ip route 192.168.1.0 255.255.255.0 serial 0/0/0</b></p></span> <span class="cmd"><p>R1(config)#<b>no ip route 192.168.2.0 255.255.255.0 serial 0/0/0</b></p></span> <p>Em seguida, configure a única rota estática padrão usando a mesma interface de saída Serial 0/0/0 como as três rotas estáticas anteriores:</p> <span class="cmd"><p>R1(config)#<b>ip route 0.0.0.0 0.0.0.0 serial 0/0/0</b></p></span></content-text>
</page>
<page type="OneColumn" id="tl0902060202">
<content-media type="StaticGraphic" id="cm5763692333"><title><content-text></content-text></title><media ref="tl0902000000/tl0902060000/tl0902060200/tl0902060202/cm5763692333.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902060000/tl0902060200/tl0902060202/cm5763692333text.xml"/></content-media>
<content-text><p><b>Verificando uma rota estática padrão</b></p> <p>Verifique a alteração feita na tabela de roteamento usando o comando <span class="cmd">show ip route</span>, como mostrado na Figura:</p> <span class="cmd"><p><b>S* 0.0.0.0/0 is directly connected, Serial0/0/0</b></p></span> <p>Observe o <b>*</b> ou o asterisco próximo ao <b>S</b>. Como você pode ver na tabela <b>Códigos</b> na figura, o asterisco indica que essa rota estática é uma rota <b>candidata padrão</b>. É por isso que ela é chamada de "rota estática padrão". Nós veremos nos capítulos posteriores que uma rota "padrão" nem sempre precisa ser uma rota "estática". </p> <p>A chave dessa configuração está na máscara <span class="cmd"> <b>/0</b></span>. Dissemos anteriormente que é a máscara de sub-rede na tabela de roteamento quem determina quantos bits devem ser correspondentes entre o endereço IP de destino do pacote e a rota na tabela de roteamento. Uma máscara /0 indica que não há necessidade de correspondência de zero ou nenhum bit. Como não há uma correspondência mais específica, a rota estática padrão corresponderá a todos os pacotes.</p> <p><b>As rotas padrão são muito comuns em roteadores.</b> Em vez dos roteadores precisarem armazenar rotas para todas as redes na Internet, eles podem armazenar uma única rota padrão para representar uma rede que não está na tabela de roteamento. Esse tópico será abordado com mais detalhes quando discutirmos protocolos de roteamento dinâmico. </p></content-text>
</page>
<page type="OneColumn" id="tl0902060203">
<content-media type="ActivityPKA" id="cm4520039658"><title><content-text></content-text></title><media ref="tl0902000000/tl0902060000/tl0902060200/tl0902060203/cm4520039658/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902060000/tl0902060200/tl0902060203/cm4520039658/icontext.xml"/></content-media>
<content-text><p>Use a atividade do Packet Tracer para testar a configuração de rotas de sumarização e padrão. Em seguida, verifique a nova configuração, testando a conectividade.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0902070000">
<title><content-text>Gerenciando, identificando e solucionando problemas de rotas estáticas</content-text></title>
<topic type="" id="tl0902070100">
<title><content-text>Rotas estáticas e encaminhamento de pacotes</content-text></title>
<page type="OneColumn" id="tl0902070101">
<content-media type="AnimationPartialScreen" id="cm4895681103"><title><content-text></content-text></title><media ref="tl0902000000/tl0902070000/tl0902070100/tl0902070101/cm4895681103.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902070000/tl0902070100/tl0902070101/cm4895681103text.xml"/></content-media>
<content-text><p><b>Rotas estáticas e encaminhamento de pacotes</b></p> <p>Este é um exemplo do processo de encaminhamento de pacotes com rotas estáticas. Como você pode ver na animação, PC1 está enviando um pacote para PC3:</p> <p>1. O pacote chega na interface FastEthernet 0/0 de R1.</p> <p>2. R1 não tem uma rota específica até a rede de destino, 192.168.2.0/24. Por isso, R1 usa a rota estática padrão .</p> <p>3. R1 encapsula o pacote em um novo quadro. Como o link de R2 é um link ponto-a-ponto, R1 adiciona um endereço "todos 1s" para o endereço de destino da Camada 2.</p> <p>4. O quadro é encaminhado pela interface serial 0/0/0. O pacote chega pela interface Serial 0/0/0 em R2.</p> <p>5. R2 desencapsula o quadro e procura uma rota para o destino. R2 tem uma rota estática para 192.168.2.0/24 por Serial0/0/1.</p> <p>6. R2 encapsula o pacote em um novo quadro. Como o link de R3 é um link ponto-a-ponto, R2 adiciona um endereço "todos 1s" para o endereço de destino da Camada 2.</p> <p>7. O quadro é encaminhado pela interface Serial0/0/1. O pacote chega pela interface Serial0/0/1 em R3.</p> <p>8. R3 desencapsula o quadro e procura uma rota para o destino. R3 tem uma rota conectada para 192.168.2.0/24 por FastEthernet 0/1.</p> <p>9. R3 procura a entrada de tabela ARP em busca de 192.168.2.10 para localizar o endereço MAC de Camada 2 para PC3.</p> <p> a. Se não houver nenhuma entrada, R3 enviará uma solicitação ARP por FastEthernet 0/0.</p> <p> b. PC3 responde com uma resposta ARP que inclui o endereço MAC de PC3.</p> <p>10. R3 encapsula o pacote em um novo quadro com o endereço MAC da interface FastEthernet 0/0 como o endereço da Camada 2 de origem e o endereço MAC de PC3 como o endereço MAC de destino.</p> <p>11. O quadro é encaminhado pela interface FastEthernet 0/0/0. O pacote chega pela interface da placa de rede de PC3.</p> <p>Esse processo não é diferente do processo demonstrado no Capítulo 1. Como foi explicado no Capítulo 1, você deve ser capaz de descrever esse processo com mais detalhes. Saber como um roteador executa suas duas funções básicas – determinação do caminho e encaminhamento de pacotes – é essencial para todas as discussões de roteamento. No Laboratório 2.8.1, "Configuração básica de rota estática", você tem uma oportunidade para demonstrar seu conhecimento da determinação do caminho e do processo de encaminhamento de pacotes.</p></content-text>
</page>
</topic>
<topic type="" id="tl0902070200">
<title><content-text>Identificando e Solucionando Problemas de uma Rota Não Encontrada</content-text></title>
<page type="OneColumn" id="tl0902070201">
<content-media type="StaticGraphic" id="cm1421063275"><title><content-text></content-text></title><media ref="tl0902000000/tl0902070000/tl0902070200/tl0902070201/cm1421063275.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902070000/tl0902070200/tl0902070201/cm1421063275text.xml"/></content-media>
<content-text><p><b>Identificando e Solucionando problemas de uma rota não encontrada</b></p> <p>As redes estão sujeitas a muitas forças diferentes que podem fazer com que seu status mude muito:</p> <ul><li> Há falha em uma interface. </li> <li> Uma operadora descarta uma conexão.</li> <li> Há links saturados.</li> <li> Um administrador insere uma configuração errada.</li></ul> <p>Quando houver uma alteração na rede, a conectividade poderá ser perdida. Como administrador de rede, você é o responsável por identificar e resolver o problema.</p> <p>Que etapas você executa? </p> <p>Por enquanto, você deve estar muito familiarizado com algumas ferramentas que podem ajudar a isolar problemas de roteamento. Listadas na figura, entre elas estão: </p> <span class="cmd"><p><b>ping</b></p></span> <span class="cmd"><p><b>traceroute</b></p></span> <span class="cmd"><p><b>show ip route</b></p></span> <p>Embora nós ainda não tenhamos usado traceroute neste curso, você deve estar muito familiarizado com seus recursos de estudos anteriores. Lembre-se de que comandos traceroute encontrarão uma interrupção no caminho da origem até o destino. </p> <p>Na medida em que avançarmos neste curso, você descobrirá mais ferramentas. Por exemplo, <span class="cmd"><b>show ip interface brief</b></span> apresenta um resumo rápido do status da interface. O CDP pode ajudar a obter informações sobre a configuração IP de um dispositivo Cisco conectado diretamente que usa o comando <span class="cmd"><b>show cdp neighbors detail</b></span>.</p></content-text>
</page>
</topic>
<topic type="" id="tl0902070300">
<title><content-text>Resolvendo a Rota Não Encontrada</content-text></title>
<page type="OneColumn" id="tl0902070301">
<content-media type="AnimationPartialScreen" id="cm8455311047"><title><content-text></content-text></title><media ref="tl0902000000/tl0902070000/tl0902070300/tl0902070301/cm8455311047.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902070000/tl0902070300/tl0902070301/cm8455311047text.xml"/></content-media>
<content-text><p><b>Resolvendo a rota não encontrada</b></p> <p>Localizar uma rota não encontrada (ou configurada incorretamente) será relativamente simples se você usar as ferramentas corretas de maneira organizada. </p> <p>Considere este problema: PC1 não pode executar ping em PC3. Um traceroute revela que R2 está respondendo, mas que não há nenhuma resposta de R3. A exibição da tabela de roteamento em R2 revela que a rede 172.16.3.0/24 está configurada incorretamente. A interface de saída está configurada para enviar pacotes a R3. Obviamente, a partir da topologia, podemos ver que R1 tem a rede 172.16.3.0/24. Por isso, R2 deve usar a Serial 0/0/0 como a interface de saída – e não Serial0/0/1. </p> <p>Para resolver a situação, remova a rota incorreta e adicione a rota para rede 172.16.3.0/24 com Serial 0/0/0 especificada como a interface de saída.</p> <span class="cmd"><p>R2(config)#<b>no ip route 172.16.3.0 255.255.255.0 serial0/0/1</b></p></span> <span class="cmd"><p>R2(config)#<b>ip route 172.16.3.0 255.255.255.0 serial 0/0/0</b></p></span></content-text>
</page>
<page type="OneColumn" id="tl0902070302">
<content-media type="ActivityPKA" id="cm7418519817"><title><content-text></content-text></title><media ref="tl0902000000/tl0902070000/tl0902070300/tl0902070302/cm7418519817/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902070000/tl0902070300/tl0902070302/cm7418519817/icontext.xml"/></content-media>
<content-text><p>Use a atividade do Packet Tracer para ver como o loop explicado nesta seção pode ocorrer. No modo de simulação, veja como R2 e R3 executam loop em um pacote para 172.16.3.10 até o campo TTL alcançar zero. Em seguida, corrija a problema e teste a conectividade entre PC1 e PC3.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0902080000">
<title><content-text>Laboratórios de Configuração de Rota Estática</content-text></title>
<topic type="" id="tl0902080100">
<title><content-text>Configuração básica de rota estática</content-text></title>
<page type="OneColumn" id="tl0902080101">
<content-media type="ActivityLab" id="cm6056393233"><title><content-text></content-text></title><media ref="tl0902000000/tl0902080000/tl0902080100/tl0902080101/cm6056393233/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902080000/tl0902080100/tl0902080101/cm6056393233/icontext.xml"/></content-media>
<content-text><p>Nesta atividade de laboratório, você criará uma rede como a usada neste capítulo. Você cabeará a rede e executará as configurações iniciais do roteador necessárias para a conectividade. Depois de concluir a configuração básica, você testará a conectividade entre os dispositivos na rede. Você configurará as rotas estáticas necessárias para permitir a comunicação entre os hosts. </p><p><b>Clique no ícone laboratório para maiores detalhes.</b></p></content-text>
</page>
<page type="OneColumn" id="tl0902080102">
<content-media type="ActivityPKA" id="cm2782798220"><title><content-text></content-text></title><media ref="tl0902000000/tl0902080000/tl0902080100/tl0902080102/cm2782798220/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902080000/tl0902080100/tl0902080102/cm2782798220/icontext.xml"/></content-media>
<content-text><p>Utilize esta Atividade do Packet Tracer para repetir uma simulação de Laboratório 2.8.1. Lembre-se, entretanto, de que o Packet Tracer não substitui um exercício prático em laboratório com equipamentos reais. </p> <p>Um resumo das instruções é fornecido na atividade. Use o PDF do laboratório para obter mais detalhes.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl0902080200">
<title><content-text>Configuração avançada de rota estática</content-text></title>
<page type="OneColumn" id="tl0902080201">
<content-media type="ActivityLab" id="cm9282976089"><title><content-text></content-text></title><media ref="tl0902000000/tl0902080000/tl0902080200/tl0902080201/cm9282976089/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902080000/tl0902080200/tl0902080201/cm9282976089/icontext.xml"/></content-media>
<content-text><p>Nesta atividade de laboratório, você receberá um endereço de rede que deve ser colocado em sub-rede para concluir o endereçamento da rede. O endereçamento para a rede local conectada ao roteador de ISP e o link entre os roteadores HQ e ISP já foi concluído. As rotas estáticas também precisarão ser configuradas para que os hosts em redes que não estejam diretamente conectadas possam se comunicar.</p><p><b>Clique no ícone laboratório para maiores detalhes.</b></p></content-text>
</page>
<page type="OneColumn" id="tl0902080202">
<content-media type="ActivityPKA" id="cm8783985248"><title><content-text></content-text></title><media ref="tl0902000000/tl0902080000/tl0902080200/tl0902080202/cm8783985248/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902080000/tl0902080200/tl0902080202/cm8783985248/icontext.xml"/></content-media>
<content-text><p>Utilize esta Atividade do Packet Tracer para repetir uma simulação de Laboratório 2.8.2. Lembre-se, entretanto, de que o Packet Tracer não substitui um exercício prático em laboratório com equipamentos reais. </p> <p>Um resumo das instruções é fornecido na atividade. Utilize o PDF do laboratório para obter mais detalhes.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl0902080300">
<title><content-text>Identificação e solução de problemas de rotas estáticas</content-text></title>
<page type="OneColumn" id="tl0902080301">
<content-media type="ActivityLab" id="cm8500443686"><title><content-text></content-text></title><media ref="tl0902000000/tl0902080000/tl0902080300/tl0902080301/cm8500443686/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902080000/tl0902080300/tl0902080301/cm8500443686/icontext.xml"/></content-media>
<content-text><p>Neste laboratório, você começará carregando scripts de configuração corrompidos em todos os roteadores. Esses scripts contêm erros que impedirão a comunicação fim-a-fim através da rede. Você precisará identificar e solucionar os problemas de cada roteador para determinar os erros de configuração e então utilizar os comandos apropriados para corrigir as configurações. Quando todos os erros de configuração forem corrigidos, todos os hosts na rede devem poder se comunicar.</p><p><b>Clique no ícone laboratório para maiores detalhes.</b></p></content-text>
</page>
<page type="OneColumn" id="tl0902080302">
<content-media type="ActivityPKA" id="cm1198614412"><title><content-text></content-text></title><media ref="tl0902000000/tl0902080000/tl0902080300/tl0902080302/cm1198614412/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902080000/tl0902080300/tl0902080302/cm1198614412/icontext.xml"/></content-media>
<content-text><p>Utilize esta Atividade do Packet Tracer para repetir uma simulação de Laboratório 2.8.3. Lembre-se, entretanto, de que o Packet Tracer não substitui um exercício prático em laboratório com equipamentos reais. </p> <p>Um resumo das instruções é fornecido na atividade. Use o PDF do laboratório para obter mais detalhes.</p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
</topic>
</section>
<section type="ChapterSummary" id="tl0902090000">
<title><content-text>Resumo do Capítulo</content-text></title>
<topic type="" id="tl0902090100">
<title><content-text>Resumo e Revisão</content-text></title>
<page type="OneColumn" id="tl0902090101">
<content-media type="StaticGraphic" id="cm4869270145"><title><content-text></content-text></title><media ref="tl0902000000/tl0902090000/tl0902090100/tl0902090101/cm4869270145.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902090000/tl0902090100/tl0902090101/cm4869270145text.xml"/></content-media>
<content-text><p><b>Resumo</b></p> <p>Neste capítulo, você aprendeu como as rotas estáticas podem ser usadas para alcançar redes remotas. Redes remotas são redes que só podem ser alcançadas encaminhando-se o pacote para outro roteador. As rotas estáticas são facilmente configuradas. No entanto, em grandes redes, essa operação manual pode ser bastante incômoda. Como nós veremos em capítulos posteriores, as rotas estáticas ainda são usadas – mesmo quando um protocolo de roteamento dinâmico é implementado.</p> <p>As rotas estáticas podem ser configuradas com um endereço IP do próximo salto, que normalmente é o endereço IP do roteador do próximo salto. Quando um endereço IP do próximo salto é usado, o processo da tabela de roteamento deve resolver esse endereço para uma interface de saída. Em links seriais ponto-a-ponto, costuma ser mais eficiente configurar a rota estática com uma interface de saída. Em redes multiacesso, como Ethernet, tanto um endereço IP do próximo salto quanto uma interface de saída pode ser configurado na rota estática.</p> <p>As rotas estáticas têm uma distância administrativa padrão de "1". Essa distância administrativa também se aplica a rotas estáticas configuradas com um endereço do próximo salto, bem como uma interface de saída.</p> <p>Uma rota estática só será inserida na tabela de roteamento se o endereço IP do próximo salto puder ser resolvido por meio de uma interface de saída. Mesmo que a rota estática seja configurada com um endereço IP do próximo salto ou uma interface de saída, se a interface de saída usada para encaminhar esse pacote não estiver na tabela de roteamento, a rota estática não será incluída na tabela de roteamento.</p> <p>Em muitos casos, várias rotas estáticas podem ser configuradas como uma única rota de sumarização. Isso significa que menos entradas na tabela de roteamento resultam em um processo de pesquisa mais rápido na tabela de roteamento. A rota de sumarização definitiva é uma rota padrão, configurada com um endereço de rede 0.0.0.0 e uma máscara de sub-rede 0.0.0.0. Se não houver uma correspondência mais específica na tabela de roteamento, a tabela de roteamento usará a rota padrão para encaminhar o pacote a outro roteador.</p> <p><b>Nota:</b> O processo de pesquisa na tabela de roteamento é examinado mais detalhadamente no Capítulo 8, "A tabela de roteamento: Um exame mais detalhado".</p></content-text>
</page>
<page type="FullScreen" id="tl0902090102">
<content-media type="ChapterSummary" id="cm4413444998"><title><content-text></content-text></title><media ref="tl0902000000/tl0902090000/tl0902090100/tl0902090102/cm4413444998.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902090000/tl0902090100/tl0902090102/cm4413444998text.xml"/></content-media>
<content-text></content-text>
</page>
<page type="OneColumn" id="tl0902090103">
<content-media type="ActivityPKA" id="cm4056788680"><title><content-text></content-text></title><media ref="tl0902000000/tl0902090000/tl0902090100/tl0902090103/cm4056788680/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0902000000/tl0902090000/tl0902090100/tl0902090103/cm4056788680/icontext.xml"/></content-media>
<content-text><p>A Atividade Avançada de Integração das Habilidades deste capítulo integra todo o conhecimento e todas as habilidades que você adquiriu nos dois primeiros capítulos deste curso. Nesta atividade, você criará uma rede do zero. Começando com um espaço de endereçamento e requisitos de rede, você deve implementar um projeto de rede que atenda às especificações. Em seguida, implemente uma configuração de roteamento estático efetiva.</p> <p><content-link target="E2_PTAct_2_9_1_Directions.pdf" type="internalfile">Instruções de integração das habilidades no Packet Tracer (PDF)</content-link></p><p><b>Clique no ícone do Packet Tracer para obter mais detalhes.</b></p></content-text>
</page>
<page type="OneColumn" id="tl0902090104">
<content-media type="InteractiveGraphicHotspots" id="cm2077447823"><title><content-text></content-text></title><media ref="tl0902000000/tl0902090000/tl0902090100/tl0902090104/cm2077447823.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0902000000/tl0902090000/tl0902090100/tl0902090104/cm2077447823text.xml"/></content-media>
<content-text><p><b>Para Saber Mais</b></p> <p> </p> <p><b>Rotas estáticas flutuantes</b></p> <p>Rota estática flutuante é uma rota de backup para uma rota que é uma rota dinâmica ou outra rota estática. A distância administrativa padrão de uma rota estática é "1". Veja se você pode criar uma rota estática usando uma interface de saída diferente ou um endereço IP do próximo salto que só seriam adicionados à tabela de roteamento se houvesse falha na rota estática primária. </p> <p>Dicas: Lembre-se de que, se o roteador tiver duas rotas para a mesma rede de destino com dois valores de distância administrativa diferentes, ele adicionará a rota com a distância administrativa inferior. Uma rota estática será removida da tabela de roteamento se a interface de saída ou o endereço IP do próximo salto não estiver mais disponível.</p> <p><b>Descartar rota</b></p> <p>Uma configuração comum em muitas redes é ter uma rota padrão estática no roteador de borda encaminhando pacotes para o ISP. Em seguida, o roteador ISP tem uma rota estática apontando para a rede do cliente. </p> <p>Por exemplo, o Cliente A tem o endereço de rede 172.16.0.0/16, que está em sub-rede com várias sub-redes /24. O roteador de borda do Cliente A tem uma rota padrão estática encaminhando todos os demais tráfegos para o roteador ISP: </p> <span class="cmd"><p><b>ip route 0.0.0.0 0.0.0.0 serial 0/0/0</b></p></span> <p>O roteador ISP tem uma rota padrão estática para encaminhar tráfego à rede do Cliente A: </p> <span class="cmd"><p><b>ip route 172.16.0.0 255.255.0.0 serial 0/0/1</b></p></span> <p>Pode haver um problema quando os pacotes têm origem na rede do Cliente A de uma sub-rede que não existe. O roteador de borda do Cliente A usará sua rota padrão para encaminhar esses pacotes no ISP. O roteador ISP receberá esses pacotes e os enviará para o roteador de borda do Cliente A porque eles fazem parte da rede 172.16.0.0/16. O roteador de borda os mandará de volta mais uma vez para o ISP. Os pacotes são capturados em um loop até que o TTL do pacote expire.</p> <p>Configure uma rota estática no roteador de borda do Cliente A para descartar esses pacotes, em vez de encaminhá-los pelo roteador ISP.</p> <p><b>Leitura adicional sobre roteamento estático</b></p> <p>Embora as rotas estáticas possam ser facilmente compreendidas e configuradas, há algumas situações em que o processamento do IOS de rotas estáticas pode ser bastante complexo. Isso é especialmente verdadeiro quando há várias rotas estáticas configuradas abrangendo o mesmo intervalo de redes. </p> <p>O livro de Alex Zinin, <i>Cisco IP Routing</i>, aborda com mais detalhes o roteamento estático e o processamento de rota estática do IOS. Esse livro vai além apenas da configuração e observa em detalhes os aspectos do Cisco IOS e de seus processos de roteamento.</p></content-text>
</page>
</topic>
</section>
<section type="ChapterQuiz" id="tl0902100000">
<title><content-text>Teste do capítulo</content-text></title>
<topic type="" id="tl0902100100">
<title><content-text>Teste do capítulo</content-text></title>
<page type="FullScreen" id="tl0902100101">
<content-media type="ChapterQuiz" id="cm8806838992"><title><content-text></content-text></title><media ref="tl0902000000/tl0902100000/tl0902100100/tl0902100101/cm8806838992/" mime="" scale="true" type="directory" width="100%" height="100%" external="tl0902000000/tl0902100000/tl0902100100/tl0902100101/cm8806838992/icontext.xml"/></content-media>
<content-text></content-text>
</page>
</topic>
</section>
</chapter>
