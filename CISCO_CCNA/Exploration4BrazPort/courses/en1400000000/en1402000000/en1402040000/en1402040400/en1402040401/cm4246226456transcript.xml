<transcript lastedited="11.17.08 11:11:18">
<title><content-text><![CDATA[2.4.4  - Encapsulation and Authentication Process]]></content-text></title>
<brief><content-text><![CDATA[The diagram depicts a flowchart that illustrates the P P P encapsulation and authentication process.<br><br>Flowchart: The flowchart starts with an incoming P P P negotiation, and the authentication method is determined as one of three possibilities: local, security server, or no authentication required. If local authentication is used, the local database is checked. If security server authentication is used, the security server database is queried. If the local or security server authentication fails, the P P P session is disconnected. If the local or security server authentication is successful or if no authentication is configured, the P P P session starts.<br><br>CHAP Example Animation: The animation shows an example of the steps involved in the CHAP authentication process between routers R1 and R2.<br><br>Step 1. R1 establishes the link to R2 using LCP, and the two systems agree to use CHAP during the P P P LCP negotiation. <br><br>Step 2. R2 generates an ID and a random number and sends that plus its username as a CHAP challenge packet to R1. <br><br>Step 3. R1 uses the username of the challenger (R2) and cross-references it with its local database to find its associated password. R1 then generates a unique MD5 hash number using R2's username and ID, and a random number and shared secret password. <br><br>Step 4. Router R1 then sends the challenge ID, the hashed value, and its username (R1) to R2.<br><br>Step 5. R2 generates it own hash value using the ID, the shared secret password, and the random number it originally sent to R1. <br><br>Step 6. R2 compares its hash value with the hash value sent by R1. If the values are the same, R2 sends a link-established response to R1.<br>]]></content-text></brief>
<full><content-text><![CDATA[FULL - NOT FOR PRODUCTION]]></content-text></full>
</transcript>
